{"version":2,"kind":"Notebook","sha256":"4cf09aabc48ff70a7fe0cae476fb97836b165157d7b39532dd91d058f4c49d7b","slug":"src.circle","location":"/src/circle.ipynb","dependencies":[],"frontmatter":{"title":"Circle Group","content_includes_title":true,"kernelspec":{"name":"SageMath-9.8","display_name":"SageMath 9.8","language":"sage"},"github":"https://github.com/executablebooks/jupyter-book","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/executablebooks/jupyter-book/blob/main/src/circle.ipynb","exports":[{"format":"ipynb","filename":"circle.ipynb","url":"/circle-e39892361ec68a92af43743b59b36a20.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Circle Group","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t9Olt5YKak"}],"identifier":"circle-group","label":"Circle Group","html_id":"circle-group","implicit":true,"key":"BExTjCi2GA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before we start building circle FFT, let’s first build the circle group, which will be used as the domain of circle fft.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NWCXcczrzq"}],"key":"gs7omdAKq0"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We choose a basic field GF(31), which has a order of 31. And then we extend it to a 2-degree extension field GF(","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gwMehVrFPB"},{"type":"span","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"31","key":"rG9fNn7YKU"},{"type":"superscript","children":[{"type":"text","value":"2","key":"ITCARW9AcV"}],"key":"rrf7DasFeD"}],"key":"e7z0cwWtD5"},{"type":"text","value":"), to get a multiplicative subgroup of order 32.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vK33nFCKk1"}],"key":"zqdfHY0yvG"}],"key":"zMPaydnxl7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"F31 = GF(31)\nR31.<X> = F31[]\nR31","key":"Jdt3DQis9k"},{"type":"output","id":"VfUf4EFVsimegdI-IX_7n","data":[{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/plain":{"content":"Univariate Polynomial Ring in X over Finite Field of size 31","content_type":"text/plain"}}}],"key":"AXIHpAQaKs"}],"key":"o1vEz3qyQs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we extend F31 to a 2-degree extension field GF(","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OGqgdcjHZi"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"31","key":"QxfEAhUxnl"},{"type":"superscript","children":[{"type":"text","value":"2","key":"E1Ze61viOp"}],"key":"l7sDroW4qz"}],"key":"KH22NncWvo"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hzpjisdcRH"}],"key":"SkBb5jdKNH"}],"key":"iz7LBAhUda"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"C31.<i> = F31.extension(X^2 + 1)\nC31","key":"TECKGValo7"},{"type":"output","id":"QaRY-NyEjoPRY5ug8my64","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"Finite Field in i of size 31^2","content_type":"text/plain"}}}],"key":"ztkNOTOQMf"}],"key":"nkoyNIjKvC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We want to find a group element of order 32, so we take the generator of GF(","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GbeoNV6Nvo"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"31","key":"BvX19PKYL9"},{"type":"superscript","children":[{"type":"text","value":"2","key":"a7wmbuAF9T"}],"key":"xpEUGlbsn0"}],"key":"TxyyD9N0pl"},{"type":"text","value":") and get 30th power of it.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ktNAJ5JFXm"}],"key":"P2SPMFrVDg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Fact","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YpIrm6rpVz"}],"key":"CvhhuaBObn"},{"type":"text","value":": For any prime field ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E6iLEwUErS"},{"type":"inlineMath","value":"\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fCbRMdiNRP"},{"type":"text","value":", where ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iOmMzdNlir"},{"type":"inlineMath","value":"p=2^n - 1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p=2^n - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"nTLucJz10a"},{"type":"text","value":", the 2-degree extension over ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r2OtInCEP4"},{"type":"inlineMath","value":"\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"bNpfMLT38i"},{"type":"text","value":" is\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bSxCHyOVjW"},{"type":"inlineMath","value":"K=\\mathbb{F}_{p^2}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><msub><mi mathvariant=\"double-struck\">F</mi><msup><mi>p</mi><mn>2</mn></msup></msub></mrow><annotation encoding=\"application/x-tex\">K=\\mathbb{F}_{p^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0026em;vertical-align:-0.3137em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5224em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7463em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3137em;\"><span></span></span></span></span></span></span></span></span></span>","key":"dfwo3NK8Gv"},{"type":"text","value":", then ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LFtbXAvG7O"},{"type":"inlineMath","value":"K","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"crxXh8Wry5"},{"type":"text","value":" has a multiplicative subgroup with order ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kXeMZwqMPy"},{"type":"inlineMath","value":"2^n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"Xpr6npTBlI"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uVkt0ksQ8S"}],"key":"YwUAiZ3lVW"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Proof:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Ba8bPQNWo9"}],"key":"Q5h1TFgAK0"},{"type":"math","value":"p^2 - 1 = (2^n - 1) * (2^n - 1) - 1 = 2^{2n} - 2^{n+1} = 2^n(2^n - 2)","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>p</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>∗</mo><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>−</mo><mn>1</mn><mo>=</mo><msup><mn>2</mn><mrow><mn>2</mn><mi>n</mi></mrow></msup><mo>−</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p^2 - 1 = (2^n - 1) * (2^n - 1) - 1 = 2^{2n} - 2^{n+1} = 2^n(2^n - 2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"1","key":"pM4cGpHWlN"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"In our case, F31.order() - 1 is ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fUMy9dIPBL"},{"type":"inlineMath","value":"2^n - 2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2^n - 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"wNkKRTIvlG"},{"type":"text","value":".","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"I3sqbklNtt"}],"key":"U54ChqWiGS"}],"key":"sPtqKjyjvN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"\ng = C31.multiplicative_generator()^(F31.order() - 1)\ng","key":"kbRgroUEGM"},{"type":"output","id":"1R_jEW5UdJuveGdKvEKQo","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"11*i + 29","content_type":"text/plain"}}}],"key":"H4CLPZR3b3"}],"key":"xBPHQn51MM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define a function to calculate the order of an element in the circle group.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Co46YpSYSk"}],"key":"OmrR7SeBRu"}],"key":"XuYPZxbWcp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def group_ord(elem):\n    K = elem.parent()\n\n    for i in range(1, K.order()):\n        # An order of an element is defined by how much power we need to raise the element to get the identity element\n        if elem**i == K.one():\n            return i\n    return \"False\"","key":"ix7Ljmfxxq"},{"type":"output","id":"Y7ySoVLodH6CI1E67sC_-","data":[],"key":"tEfC5EHpdt"}],"key":"Ka1zuoZnCs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check that g is of order 32.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OEUoxEL7MI"}],"key":"oY8tnQi4zn"}],"key":"adw4gTAt0U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"group_ord(g)","key":"UyF7juWb9W"},{"type":"output","id":"yD5lxfsVXbgiXKBDm1ct2","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"32","content_type":"text/plain"}}}],"key":"EtpMkGBosL"}],"key":"mncChgrfhB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the group multiplication, which is similar to complex number multiplication.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uSnXiDb7LH"}],"key":"IYDy3O5nUG"}],"key":"zoaXFenfxN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def group_mul(g1, g2):\n    x1, y1 = g1\n    x2, y2 = g2\n    return (x1 * x2 - y1 * y2) + (x1 * y2 + x2 * y1) * i ","key":"QxaJVMFR9Z"},{"type":"output","id":"ivEpfjTo3lZhDlKIx86By","data":[],"key":"LGfIBAfoDD"}],"key":"LVZsPzqYGs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the group inverse, which is also the J mapping in the paper.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"INNwLA7KxW"}],"key":"ofs1GPlHEK"}],"key":"q4TuzfyLK1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def group_inv(g1):\n    x1, y1 = g1\n    return (x1 - y1 * i)","key":"W7LzQxLzQV"},{"type":"output","id":"jylP6dP-7Z92zGc-ttEBk","data":[],"key":"csfrLwsvIt"}],"key":"b0PCcavbqW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define show function to print group.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HU42ed9y0G"}],"key":"Vse8oTPjhP"}],"key":"QlfYkBeSGO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def show(GG): \n    for j in range(0, len(GG)):\n        t = GG[j]\n        t0 = t[0]\n        t1 = t[1]\n        if t1 > F31(15) and t1 <= F31(30):\n            t1_str = \"-\" + str(31-t1)\n        else:\n            t1_str = str(t1)\n        print(\"i={}, log={}, ord={}, ({},{})\".format(j, log_gen(g, t), group_ord(t), t0, t1_str))","key":"DlvoWpLXDE"},{"type":"output","id":"As_pCiiRN8hcKoawwQnWJ","data":[],"key":"eGopz7Meyx"}],"key":"UkVp2vZzMg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define log_gen function to calculate the power of an element in the circle group.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ncwdQp3vBN"}],"key":"rv9xkHX1iu"}],"key":"EKufjaDyIY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def log_gen(gen, t):\n    K = gen.parent()\n    for i in range(1, K.order()):\n        if gen^i == t:\n            return i\n    return \"Fail\"","key":"heORzP4cBB"},{"type":"output","id":"xIL6jyj1trp-32uBAMwp9","data":[],"key":"oXCyLfFEAA"}],"key":"sZq98QHi3T"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Jump over the circle","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nHUcLhuVEE"}],"identifier":"jump-over-the-circle","label":"Jump over the circle","html_id":"jump-over-the-circle","implicit":true,"key":"SUrwaisV74"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we define the generator for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eUG436PbdP"},{"type":"inlineCode","value":"Circle Group","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p4mH32chmC"},{"type":"text","value":" as chosen by Vitalik ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gxX0O59H2P"},{"type":"link","url":"https://vitalik.eth.limo/general/2024/07/23/circlestarks.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​vitalik​.eth​.limo​/general​/2024​/07​/23​/circlestarks​.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eHqwbx4tjP"}],"urlSource":"https://vitalik.eth.limo/general/2024/07/23/circlestarks.html","key":"kk3lR0pQy8"}],"key":"LR8dFjPEKA"}],"key":"AN2XVGWMdV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# optional\ng = 10 + 5*i\ngroup_ord(g)","key":"L9s0JvrwD5"},{"type":"output","id":"_KuWYwF6Q3NHEXTXT7WlO","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"32","content_type":"text/plain"}}}],"key":"WLgO9DrkvU"}],"key":"HK7iGO6EUb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Then we generate G5, which is a normal multiplicative group of order ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x57m03yH9k"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2","key":"hcnP8lSnJv"},{"type":"superscript","children":[{"type":"text","value":"5","key":"iXpgVexDLc"}],"key":"jTfDxPM6R6"}],"key":"m6Q0nU7NWB"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TocfnOlZa6"}],"key":"j7ONM5n7F0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"G5’s elements must be on the circle ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i4EUnxMvOs"},{"type":"inlineMath","value":"x^2 + y^2 = 1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x^2 + y^2 = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"GApDjwMxzH"},{"type":"text","value":", due to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nn2AbnY9Hc"}],"key":"aaTfoYoXKE"},{"type":"math","value":"a^{p + 1} = 1, a = x + y * i","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>a</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>∗</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">a^{p + 1} = 1, a = x + y * i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span></span>","enumerator":"2","key":"jJq3nBpFDo"},{"type":"math","value":"a * a ^ p = (x + y * i) * (x - y * i) = x^2 + y^2 = 1","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>a</mi><mo>∗</mo><msup><mi>a</mi><mi>p</mi></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>∗</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo>∗</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a * a ^ p = (x + y * i) * (x - y * i) = x^2 + y^2 = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7144em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>","enumerator":"3","key":"CL66zFJQIp"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Since ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"t5QWw15RCK"},{"type":"inlineMath","value":"a^p","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mi>p</mi></msup></mrow><annotation encoding=\"application/x-tex\">a^p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span></span></span>","key":"Vk0OPfgtOm"},{"type":"text","value":" is a Frobenius map, ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xywuR19OMc"},{"type":"inlineMath","value":"a^p","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mi>p</mi></msup></mrow><annotation encoding=\"application/x-tex\">a^p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span></span></span>","key":"ykkXMfXxqe"},{"type":"text","value":" equals to the conjugate of ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"w7swDLWEUx"},{"type":"inlineMath","value":"a","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"yJH6fFtYn0"},{"type":"text","value":", which is ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"JQkzZ6R7EI"},{"type":"inlineMath","value":"x - y * i","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>−</mo><mi>y</mi><mo>∗</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">x - y * i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"B7JhCluqTI"},{"type":"text","value":".","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"vG2q8WzfHX"}],"key":"AXlTskKAS3"}],"key":"GalzXFTAW7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"G5 = [g^i for i in range(0, 2^5)]\n# check that G5's elements are on the circle x^2 + y^2 = 1\nfor t in G5:\n    x, y = t\n    assert x^2 + y^2 == 1\nG5","key":"ah3wTTaVXY"},{"type":"output","id":"wHkWBg-sGcxeePnC_Guyd","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"[1,\n 5*i + 10,\n 7*i + 13,\n 11*i + 2,\n 27*i + 27,\n 2*i + 11,\n 13*i + 7,\n 10*i + 5,\n i,\n 10*i + 26,\n 13*i + 24,\n 2*i + 20,\n 27*i + 4,\n 11*i + 29,\n 7*i + 18,\n 5*i + 21,\n 30,\n 26*i + 21,\n 24*i + 18,\n 20*i + 29,\n 4*i + 4,\n 29*i + 20,\n 18*i + 24,\n 21*i + 26,\n 30*i,\n 21*i + 5,\n 18*i + 7,\n 29*i + 11,\n 4*i + 27,\n 20*i + 2,\n 24*i + 13,\n 26*i + 10]","content_type":"text/plain"}}}],"key":"kmYUVLywsd"}],"key":"kRRNAoklpD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print information of G5’s elements.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VjErRJ8G32"}],"key":"klFpYivNAQ"}],"key":"Q3KkkRoWio"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"for j in range(0, 32):\n    t = g^j\n    print(\"i={}, log={}, ord={}, ({},{})\".format(j, log_gen(g, t), group_ord(t), t[0], t[1]))","key":"ryvetimukP"},{"type":"output","id":"dO4T_Kc3EfzgTi2HN5weL","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=32, ord=1, (1,0)\ni=1, log=1, ord=32, (10,5)\ni=2, log=2, ord=16, (13,7)\ni=3, log=3, ord=32, (2,11)\ni=4, log=4, ord=8, (27,27)\ni=5, log=5, ord=32, (11,2)\ni=6, log=6, ord=16, (7,13)\ni=7, log=7, ord=32, (5,10)\ni=8, log=8, ord=4, (0,1)\ni=9, log=9, ord=32, (26,10)\ni=10, log=10, ord=16, (24,13)\ni=11, log=11, ord=32, (20,2)\ni=12, log=12, ord=8, (4,27)\ni=13, log=13, ord=32, (29,11)\ni=14, log=14, ord=16, (18,7)\ni=15, log=15, ord=32, (21,5)\ni=16, log=16, ord=2, (30,0)\ni=17, log=17, ord=32, (21,26)\ni=18, log=18, ord=16, (18,24)\ni=19, log=19, ord=32, (29,20)\ni=20, log=20, ord=8, (4,4)\ni=21, log=21, ord=32, (20,29)\ni=22, log=22, ord=16, (24,18)\ni=23, log=23, ord=32, (26,21)\ni=24, log=24, ord=4, (0,30)\ni=25, log=25, ord=32, (5,21)\ni=26, log=26, ord=16, (7,18)\ni=27, log=27, ord=32, (11,29)\ni=28, log=28, ord=8, (27,4)\ni=29, log=29, ord=32, (2,20)\ni=30, log=30, ord=16, (13,24)\ni=31, log=31, ord=32, (10,26)\n"}],"key":"Re6ZIHkFWN"}],"key":"TuOIZuwYYg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check elements’ operation on G5.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mAvpTgciaI"}],"key":"vTPxb1KSai"}],"key":"rwibIkwC7S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"assert G5[1] * G5[1] == G5[2]\nassert G5[3] * G5[4] == G5[7]\nassert group_mul(G5[1], G5[2]) == G5[3]\nassert group_inv(G5[1]) ==  G5[31]\nassert G5[1] * group_inv(G5[1]) == 1","key":"JnqdAf6wdZ"},{"type":"output","id":"R1HkP6Ds3vxo2cXa1F0OW","data":[],"key":"XtYxgeF51v"}],"key":"KR7Hc2HlIr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate G4 from G5 by squaring each element.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JsDOMV4oDo"}],"key":"Vfw21iHO0e"}],"key":"pU9P55DYl3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"G4 = [t^2 for t in G5[:16]]\nG4","key":"A8d4rrg6S2"},{"type":"output","id":"Sz0KgtqFW9mQZZ6aT5dzS","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"[1,\n 7*i + 13,\n 27*i + 27,\n 13*i + 7,\n i,\n 13*i + 24,\n 27*i + 4,\n 7*i + 18,\n 30,\n 24*i + 18,\n 4*i + 4,\n 18*i + 24,\n 30*i,\n 18*i + 7,\n 4*i + 27,\n 24*i + 13]","content_type":"text/plain"}}}],"key":"U5Yc7hHvbd"}],"key":"zqtpJh5VVy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate G3 from G4 by squaring each element.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iGnY2inVv6"}],"key":"jYF1iHLx4D"}],"key":"uZvxtXz1kV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"G3 = [t^2 for t in G4[:8]]\nG3","key":"XRmrBWCFSL"},{"type":"output","id":"Ztk6wmfoIgNL-Tnw1R32D","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"[1, 27*i + 27, i, 27*i + 4, 30, 4*i + 4, 30*i, 4*i + 27]","content_type":"text/plain"}}}],"key":"HaysssVv1G"}],"key":"nPZZ9wLdK8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Standard Position Coset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UNKCvV5Gfs"}],"identifier":"standard-position-coset","label":"Standard Position Coset","html_id":"standard-position-coset","implicit":true,"key":"C4qQ3zYSgX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BXFDjrRJxo"},{"type":"inlineMath","value":"Q","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"RpawWrjXur"},{"type":"text","value":" be the generator of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fiUSJLzddx"},{"type":"inlineMath","value":"G_{n+1}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">G_{n+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"c40gyPKZ3x"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kfOT8VaZ29"},{"type":"inlineMath","value":"D","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"KzgCKPYk7h"},{"type":"text","value":" is a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QYBq5D6YCs"},{"type":"inlineCode","value":"standard position coset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TgTLCdebcX"},{"type":"text","value":" of size ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m0VVC2pcOk"},{"type":"inlineMath","value":"2^n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"tQqtrZafPj"}],"key":"iPgbk6KmoT"},{"type":"math","value":"D = Q\\cdot G_n","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo>=</mo><mi>Q</mi><mo>⋅</mo><msub><mi>G</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">D = Q\\cdot G_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"czM7nft01M"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"AeU6CFLu4j"},{"type":"inlineMath","value":"ord(Q)=2^{n+1}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">ord(Q)=2^{n+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"AGWFgF5oT0"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uXebFNEMy5"}],"key":"bwRFT9gTSw"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"HqPNzAF5bc"},{"type":"inlineMath","value":"D","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"f6wolyk91V"},{"type":"text","value":" is also a ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nDyZULyQRC"},{"type":"inlineCode","value":"twin-coset","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MkRAZ839AV"},{"type":"text","value":" of size ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Sfi4YaMMJS"},{"type":"inlineMath","value":"2^n","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"CkPq1yTjhp"},{"type":"text","value":" defined with ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WMMKkfEAnJ"},{"type":"inlineMath","value":"G_{n-1}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">G_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Alkbs1t1Hu"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yIXx2hdAw4"}],"key":"KDERMJJbne"},{"type":"math","value":"D = Q\\cdot G_{n-1} \\uplus Q^{-1}\\cdot G_{n-1}","position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo>=</mo><mi>Q</mi><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊎</mo><msup><mi>Q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D = Q\\cdot G_{n-1} \\uplus Q^{-1}\\cdot G_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊎</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"Xvy8p4o473"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The rotation ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"QENSV6CgU1"},{"type":"inlineMath","value":"Q^2","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>Q</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">Q^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"mp0Ix6g5bk"},{"type":"text","value":" is exactly the generator of ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"JMQz8mKMtz"},{"type":"inlineMath","value":"G_n","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">G_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"r8JEyNWetY"},{"type":"text","value":".","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"eayAbqcgr9"}],"key":"XgdnR4ZlHn"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Here we construct a series of cosets, including standard position cosets and twin cosets, where we can randomly find a coset for circle fft.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"hb19TMlOqF"}],"key":"q6UlES3SLc"}],"key":"wldLUOtvtH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Define a coset or G4 from a rotation Q, ord(Q) = 32\n#\n# Let Q = g (generator of G, whose order is 32)\n\nD_standard_coset_4 = [g * t for t in G4]; show(D_standard_coset_4)","key":"DIKr3z96PD"},{"type":"output","id":"YOEvkeVBFM7Vrqfhj0OsV","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=1, ord=32, (10,5)\ni=1, log=3, ord=32, (2,11)\ni=2, log=5, ord=32, (11,2)\ni=3, log=7, ord=32, (5,10)\ni=4, log=9, ord=32, (26,10)\ni=5, log=11, ord=32, (20,2)\ni=6, log=13, ord=32, (29,11)\ni=7, log=15, ord=32, (21,5)\ni=8, log=17, ord=32, (21,-5)\ni=9, log=19, ord=32, (29,-11)\ni=10, log=21, ord=32, (20,-2)\ni=11, log=23, ord=32, (26,-10)\ni=12, log=25, ord=32, (5,-10)\ni=13, log=27, ord=32, (11,-2)\ni=14, log=29, ord=32, (2,-11)\ni=15, log=31, ord=32, (10,-5)\n"}],"key":"vcfHaxBKSP"}],"key":"Q5i1EgW0uJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# D_twin_coset_4 is equal to D_standard_coset_4 in the set-theoretic sense, with different order\n\nD_twin_coset_4 = [g * t for t in G3] + [group_inv(g) * t for t in G3]; show(D_standard_coset_4)\n\n# `log` specifies the order of an element in the circle","key":"xKAGiOUd8A"},{"type":"output","id":"Z2_RVmgVT8QP26fCLw3Ba","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=1, ord=32, (10,5)\ni=1, log=3, ord=32, (2,11)\ni=2, log=5, ord=32, (11,2)\ni=3, log=7, ord=32, (5,10)\ni=4, log=9, ord=32, (26,10)\ni=5, log=11, ord=32, (20,2)\ni=6, log=13, ord=32, (29,11)\ni=7, log=15, ord=32, (21,5)\ni=8, log=17, ord=32, (21,-5)\ni=9, log=19, ord=32, (29,-11)\ni=10, log=21, ord=32, (20,-2)\ni=11, log=23, ord=32, (26,-10)\ni=12, log=25, ord=32, (5,-10)\ni=13, log=27, ord=32, (11,-2)\ni=14, log=29, ord=32, (2,-11)\ni=15, log=31, ord=32, (10,-5)\n"}],"key":"poBctlc0kl"}],"key":"nvoiPljRTL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# This is also a twin-coset of size 16\n\nD_twin_coset_4_1 = [G5[3] * t for t in G3] + [group_inv(G5[3]) * t for t in G3]; show(D_twin_coset_4_1)","key":"sILLk7xVX5"},{"type":"output","id":"k8hyYliorzJkxiW_mi1vZ","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=3, ord=32, (2,11)\ni=1, log=7, ord=32, (5,10)\ni=2, log=11, ord=32, (20,2)\ni=3, log=15, ord=32, (21,5)\ni=4, log=19, ord=32, (29,-11)\ni=5, log=23, ord=32, (26,-10)\ni=6, log=27, ord=32, (11,-2)\ni=7, log=31, ord=32, (10,-5)\ni=8, log=29, ord=32, (2,-11)\ni=9, log=1, ord=32, (10,5)\ni=10, log=5, ord=32, (11,2)\ni=11, log=9, ord=32, (26,10)\ni=12, log=13, ord=32, (29,11)\ni=13, log=17, ord=32, (21,-5)\ni=14, log=21, ord=32, (20,-2)\ni=15, log=25, ord=32, (5,-10)\n"}],"key":"zF4sk7gYrM"}],"key":"A5Eb2QlZCk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Again\n\nD_twin_coset_4_2 = [G5[5] * t for t in G3] + [group_inv(G5[5]) * t for t in G3]; show(D_twin_coset_4_2)","key":"WwY9HQdLPi"},{"type":"output","id":"CM71AekwLVE14iZY5b21F","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=5, ord=32, (11,2)\ni=1, log=9, ord=32, (26,10)\ni=2, log=13, ord=32, (29,11)\ni=3, log=17, ord=32, (21,-5)\ni=4, log=21, ord=32, (20,-2)\ni=5, log=25, ord=32, (5,-10)\ni=6, log=29, ord=32, (2,-11)\ni=7, log=1, ord=32, (10,5)\ni=8, log=27, ord=32, (11,-2)\ni=9, log=31, ord=32, (10,-5)\ni=10, log=3, ord=32, (2,11)\ni=11, log=7, ord=32, (5,10)\ni=12, log=11, ord=32, (20,2)\ni=13, log=15, ord=32, (21,5)\ni=14, log=19, ord=32, (29,-11)\ni=15, log=23, ord=32, (26,-10)\n"}],"key":"a11FJb03nQ"}],"key":"AIw79RkGcF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Fact:\n#   g^2 is the generator of G4\n#   g * G4 is the standard position coset\n\nG4 == [(g^2)^i for i in range(0, 16)]","key":"UYXsFw4E8W"},{"type":"output","id":"08M_BBEZKYiC7dZnAhfxn","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"True","content_type":"text/plain"}}}],"key":"dmViFimXHa"}],"key":"JkIfH2zEZb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Define a coset or G3 from a rotation Q, ord(Q) = 16\n#\n# Let Q = g^2 (g is the generator of G5, whose order is 32)\n\nD_standard_coset_3 = [g^2 * t for t in G3]; show(D_standard_coset_3)","key":"euCY2HZrxE"},{"type":"output","id":"k9oDinyJLoTwfl0u2hFjn","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=2, ord=16, (13,7)\ni=1, log=6, ord=16, (7,13)\ni=2, log=10, ord=16, (24,13)\ni=3, log=14, ord=16, (18,7)\ni=4, log=18, ord=16, (18,-7)\ni=5, log=22, ord=16, (24,-13)\ni=6, log=26, ord=16, (7,-13)\ni=7, log=30, ord=16, (13,-7)\n"}],"key":"MyjsfIrMjS"}],"key":"EPYSJ7UqZw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Squaring map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ibfdv4I9bg"}],"identifier":"squaring-map","label":"Squaring map","html_id":"squaring-map","implicit":true,"key":"cYXvQTvDEN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Lemma","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CoOLTG0sFW"}],"key":"tgBvtBjcCw"},{"type":"text","value":": For any twin-coset ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FVeHKEqNO8"},{"type":"inlineMath","value":"D","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"X5Gmike1FI"},{"type":"text","value":" of size ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dH3hkNcR45"},{"type":"inlineMath","value":"N=2^n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">N=2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"gz7Z4KhvJX"},{"type":"text","value":", the image of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m0LINxQAhw"},{"type":"inlineMath","value":"\\pi(D)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\pi(D)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span></span></span></span>","key":"VFP2u8ZZZg"},{"type":"text","value":" must be a twin-coset of size ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Fz5JDxAj54"},{"type":"inlineMath","value":"2^{n-1}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">2^{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ZsCulyOjiT"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tqzVnJtppm"}],"key":"R7qj4SyuEO"},{"type":"math","value":"D = Q\\cdot G_{n-1} \\uplus Q^{-1}\\cdot G_{n-1}","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo>=</mo><mi>Q</mi><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊎</mo><msup><mi>Q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D = Q\\cdot G_{n-1} \\uplus Q^{-1}\\cdot G_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊎</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"iiyMoLYuI0"},{"type":"math","value":"\\pi(D) = \\pi(Q)\\cdot G_{n-2} \\uplus \\pi(Q)^{-1}\\cdot G_{n-2}","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>π</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>⊎</mo><mi>π</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\pi(D) = \\pi(Q)\\cdot G_{n-2} \\uplus \\pi(Q)^{-1}\\cdot G_{n-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊎</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"7","key":"DcjQhTxPpX"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Fact","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"oaGv2Gdnwb"}],"key":"NP9XF2RfOY"},{"type":"text","value":": If ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LpvQq1J0Zo"},{"type":"inlineMath","value":"D","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"UD8QYs5YdW"},{"type":"text","value":" is a standard position coset, so is ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tfuCAHts2k"},{"type":"inlineMath","value":"\\pi(D)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\pi(D)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span></span></span></span>","key":"tv3lfaoI88"},{"type":"text","value":".","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"hfBEcRdTV0"}],"key":"P0sf7xcQYv"}],"key":"nPTIRXwlya"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def sq(D):\n    rs = []\n    for t in D:\n        if t^2 not in rs:\n            # x' == 2 * x^2 - 1\n            rs += [t^2]\n    return rs","key":"VJSSf69iMC"},{"type":"output","id":"PD30qu_-Zhmx7IhtcKdwk","data":[],"key":"LpJ5NY6HAx"}],"key":"UrhAdXaNZ8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# This is exactly the same coset we generated from G4 before\n\nD_standard_coset_3 = sq(D_standard_coset_4); show(D_standard_coset_3)","key":"K2ldXZiEST"},{"type":"output","id":"n6NNA2wzTFE3AGDVcVNNQ","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=2, ord=16, (13,7)\ni=1, log=6, ord=16, (7,13)\ni=2, log=10, ord=16, (24,13)\ni=3, log=14, ord=16, (18,7)\ni=4, log=18, ord=16, (18,-7)\ni=5, log=22, ord=16, (24,-13)\ni=6, log=26, ord=16, (7,-13)\ni=7, log=30, ord=16, (13,-7)\n"}],"key":"yYuq3CH7d3"}],"key":"ISJreyB5bZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Circle FFT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YXySwzHmSo"}],"identifier":"circle-fft","label":"Circle FFT","html_id":"circle-fft","implicit":true,"key":"DdVcr7sT9q"}],"key":"BDibQFcx8m"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To apply circle fft, let’s generate a random polynomial’s evaluation based on D_twin_coset_4_1 (or any other twin coset you prefer).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ejI4Nrfaco"}],"key":"t8EY759nvL"}],"key":"IjElEqmSg8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f = {}\nfrom random import randint\n\nfor t in D_twin_coset_4_1:\n    f[t] = C31(randint(0, 100))\n\nf","key":"j5kc9nzo5E"},{"type":"output","id":"5d5iTFvCoIkDEVAPfqGzN","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"{11*i + 2: 29,\n 10*i + 5: 30,\n 2*i + 20: 10,\n 5*i + 21: 5,\n 20*i + 29: 8,\n 21*i + 26: 21,\n 29*i + 11: 16,\n 26*i + 10: 18,\n 20*i + 2: 30,\n 5*i + 10: 2,\n 2*i + 11: 23,\n 10*i + 26: 5,\n 11*i + 29: 22,\n 26*i + 21: 9,\n 29*i + 20: 28,\n 21*i + 5: 16}","content_type":"text/plain"}}}],"key":"sIfTBthyZI"}],"key":"SsdT0A73cr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gWunUcyCER"},{"type":"inlineCode","value":"pi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wRoEYh4qYw"},{"type":"text","value":" mapping applying to point’s x coordinate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"raseTcQtrA"}],"key":"cwkPsi9edq"}],"key":"F0WyltcKhN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def pi(t):\n    # x^2 - y^2 == 2 * x^2 - 1 (x^2 + y^2 = 1)\n    return C31(2 * t^2 - 1)","key":"N5aIOkeZU9"},{"type":"output","id":"zmNyS-sVmxDSZKIdTW9NS","data":[],"key":"spbOVHnbDl"}],"key":"a86PW6rq6t"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the first step of ifft, we try to eliminate y coordinate to simplifier our computations in later steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xC99nSROQd"}],"key":"DFVWJk4f9A"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We extract y from the polynomial by dividing polynomial in to 2 parts, f0 and f1, which correspond to the equation f[t] == f0[x] + y * f1[x].","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tcKEV1uzA7"}],"key":"cdaNCOIl1w"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"t is a group element, x and y are the x and y coordinate of t respectively.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"malWXa2hGD"}],"key":"zBDaUKEb7i"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"So that f0 and f1 are only functions of x coordinate.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LqgNtq2IV8"}],"key":"quTv7zf2j5"}],"key":"jxYixKWK2x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def ifft_first_step(f):\n    f0 = {}\n    f1 = {}\n    for t in f:\n        x, y = t\n\n        f0[x] = (f[t] + f[group_inv(t)]) / C31(2)\n        f1[x] = (f[t] - f[group_inv(t)]) / (C31(2) * y)\n\n        # Check that f is divided into 2 parts correctly\n        assert f[t] == f0[x] + y * f1[x]\n\n        # print(\"{}: {} = {} + {} * {}\".format(t, f[t], f0[x], f1[x], y))\n\n    return f0, f1","key":"hLHThmmxNo"},{"type":"output","id":"xqetxReaLVb9-zlGZxjXQ","data":[],"key":"SaRpcmQ29R"}],"key":"NTFuKJcPXe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In normal steps, we deal with the polynomial exactly the same as the classical polynomial ifft, deeming the polynomial as a univariate polynomial, except that x is applied by the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RqrA6Q3FHj"},{"type":"inlineCode","value":"pi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EcvIkMaQ4r"},{"type":"text","value":" mapping.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WeA0cfEZgw"}],"key":"VZsQveoF4w"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Basically, we divide the polynomial into 2 parts, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vp4BkWObSC"},{"type":"inlineMath","value":"f_0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JWvA5ZN4Dv"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b8ei3IjL2b"},{"type":"inlineMath","value":"f_1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"U0WciG7fNT"},{"type":"text","value":", which correspond to the equation:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VASAqnY79i"}],"key":"DiDIWsG9Z5"},{"type":"math","value":"f[x] = f_0[x] + x * f_1[x]","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>x</mi><mo>∗</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[x] = f_0[x] + x * f_1[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span></span>","enumerator":"8","key":"c1nvSADGPL"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Thus","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"K9IBrBZAwa"}],"key":"Uy7v5gYp0a"},{"type":"math","value":"f_0[x] = \\frac{f[x] + f[-x]}{2}","position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>f</mi><mo stretchy=\"false\">[</mo><mo>−</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><mn>2</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">f_0[x] = \\frac{f[x] + f[-x]}{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"9","key":"RjEdN4CFSY"},{"type":"math","value":"f_1[x] = \\frac{f[x] - f[-x]}{2x}","position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>−</mo><mi>f</mi><mo stretchy=\"false\">[</mo><mo>−</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><mrow><mn>2</mn><mi>x</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">f_1[x] = \\frac{f[x] - f[-x]}{2x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"10","key":"nYg67ZErUn"}],"key":"Jebn42NtgQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def ifft_normal_step(f):\n\n    if len(f) == 1:\n        res = []\n        for x in f:\n            res.append(f[x])\n        return res\n\n    f0 = {}\n    f1 = {}\n\n    for x in f:\n        assert x != 0, \"f should be on coset\"\n        f0[pi(x)] = (f[x] + f[-x]) / C31(2)\n        f1[pi(x)] = (f[x] - f[-x]) / (C31(2) * x)\n\n        # Check that f is divided into 2 parts correctly\n        assert f[x] == f0[pi(x)] + x * f1[pi(x)]\n\n    return ifft_normal_step(f0) + ifft_normal_step(f1)","key":"r0t55LcrB9"},{"type":"output","id":"0Gf8OdyUxI_sUF7wiPBBs","data":[],"key":"dtzMzW2IYl"}],"key":"JqHTsPLfxi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have ifft_first_step and ifft_normal_step, we can define the ifft function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lFQESIDYgB"}],"key":"J6alPJYgCI"}],"key":"e5l7YJriAS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def ifft(f):\n    f0, f1 = ifft_first_step(f)\n    f0 = ifft_normal_step(f0)\n    f1 = ifft_normal_step(f1)\n\n    return f0 + f1","key":"msMmx2K6wO"},{"type":"output","id":"la8VXJv8whO7mcPKj3WKA","data":[],"key":"VWRdVcuPv8"}],"key":"LDxvyWsiZs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Apply ifft to our random polynomial and see what we get.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CgaNf82jDv"}],"key":"ruYJWHDQAW"}],"key":"w93xJsICsb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"coeffs = ifft(f)\ncoeffs","key":"nOLiWpF2Xb"},{"type":"output","id":"m4fVcys2J4hN0WBv2oKnk","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"[17, 30, 17, 3, 4, 15, 16, 20, 1, 6, 24, 2, 12, 20, 9, 30]","content_type":"text/plain"}}}],"key":"AgEIp4p7KA"}],"key":"DkpqFA56VL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we try to define the fft function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dpeGGQYjje"}],"key":"TIiNjvJvuo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before that, we define ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a6fcyd0ArZ"},{"type":"inlineCode","value":"pie_group","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZMSS17OE8k"},{"type":"text","value":" function to generate next domain of a domain, which is equivalent to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sRmCeX2Q0e"},{"type":"inlineCode","value":"sq","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cU9lLagDwj"},{"type":"text","value":" function in the x dimension (you can check that by focusing on the x coordinate in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YRDQsbwE4f"},{"type":"inlineCode","value":"sq","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wElAQMHhTx"},{"type":"text","value":" operation).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VNpTNpjLD1"}],"key":"ZfNgVNrVjH"}],"key":"puidMKnpf9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def pie_group(D):\n    D_new = []\n    for x in D:\n        x_new = pi(x)\n        if x_new not in D_new:\n            D_new.append(x_new)\n\n    # Check that the new domain is exactly half size of the old domain\n    assert len(D_new) * 2 == len(D), \"len(D_new) * 2 != len(D), {} * 2 != {}, D_new={}, D={}\".format(len(D_new), len(D), D_new, D)\n    \n    return D_new","key":"zjD4YLET2m"},{"type":"output","id":"hu4eFRGMyxzrakO9ZwlZV","data":[],"key":"CdX9s7lxG1"}],"key":"zUukeHLl0M"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the first step of fft, which contains the same logic as ifft_first_step.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qnWpcNVxNJ"}],"key":"lHCfGAem1I"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The basis of coefficients is like:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zknvd2joQo"}],"key":"hVO4M5wx92"},{"type":"math","value":"1, v_1(x), v_2(x), v_1(x)v_2(x), y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\quad (N = 8) \\tag{1}","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mo stretchy=\"false\">(</mo><mi>N</mi><mo>=</mo><mn>8</mn><mo stretchy=\"false\">)</mo></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">1, v_1(x), v_2(x), v_1(x)v_2(x), y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\quad (N = 8) \\tag{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">8</span><span class=\"mclose\">)</span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">1</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"11","key":"f81t0vObJL"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"where","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"phVyMV5ed4"}],"key":"sBXY9hcAQ0"},{"type":"math","value":"v_1(x) = x, v_2(x) = 2x^2-1, v_3(x) = 2(2x^2-1)^2-1, ...","position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mo stretchy=\"false\">(</mo><mn>2</mn><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">v_1(x) = x, v_2(x) = 2x^2-1, v_3(x) = 2(2x^2-1)^2-1, ...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span></span></span></span></span>","enumerator":"12","key":"MVkPA5AIHc"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"So to divide the polynomial into 2 parts, we just need to divide the coefficients into 2 parts, it’s basis are also divided into 2 parts as follows:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BI0AHJvgug"}],"key":"VC6PIoIRLD"},{"type":"math","value":"1, v_1(x), v_2(x), v_1(x)v_2(x) \\tag{2}","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">1, v_1(x), v_2(x), v_1(x)v_2(x) \\tag{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">2</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"13","key":"hnFuYf2vtr"},{"type":"math","value":"y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\tag{3}","position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\tag{3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">3</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"14","key":"cB85XJ88AT"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Notice that basis (2) is bit reversed order compared to normal basis, and basis (3) is like basis (2) but multiplied by y.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"PtCMmaoboQ"}],"key":"Kkgt2967uZ"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"To eliminate y in normal steps’ computation, we just consider basis of the second part of coefficients (which is actually basis (3)) as same as basis (2), and supply the y at the end of fft.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"YlC9bo8V7J"}],"key":"bRNJtpsI96"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"First, we define the first step of fft.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"tqKY8byUfA"}],"key":"qkQzxQK0ts"}],"key":"xaB1SPBBqj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def fft_first_step(f, D):\n    # Check that the polynomial and the domain have the same length\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n\n    # divide the polynomial into 2 parts\n    len_f = len(f)\n    f0 = f[:len_f//2]\n    f1 = f[len_f//2:]\n\n    # halve the domain by simply removing the y coordinate\n    D_new = []\n    for t in D:\n        x, _ = t\n        if x not in D_new:\n            D_new.append(x)\n\n    # Check that the new domain is exactly half size of the old domain\n    assert len(D_new) * 2 == len(D), \"len(D_new) * 2 != len(D), {} * 2 != {}, D_new={}, D={}\".format(len(D_new), len(D), D_new, D)\n\n    return f0, f1, D_new","key":"hb4Tg3qzTE"},{"type":"output","id":"oJTetm1khPrvXY502qSJ3","data":[],"key":"twXHobhWrC"}],"key":"L0jGRARxgm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In normal steps, we deal with the polynomial exactly the same as the classical polynomial fft, deeming the polynomial as a univariate polynomial, except that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FLz0JKzmno"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"WgRNFYrqih"},{"type":"text","value":" is applied by the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r2zCysOufl"},{"type":"inlineCode","value":"pi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kwTdxo1P34"},{"type":"text","value":" mapping.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ruAraqrAh0"}],"key":"lk17tID6Pu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Divide the polynomial into 2 parts, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b0cNFmX2CS"},{"type":"inlineMath","value":"f_0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PYU2SQDa98"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TMMfLDYSRr"},{"type":"inlineMath","value":"f_1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sx3DCV5scD"},{"type":"text","value":", which correspond to the equation:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HpsnDr3vJH"}],"key":"F3UTusFkeV"},{"type":"math","value":"f[x] = f_0[x] + x * f_1[x]","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>x</mi><mo>∗</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[x] = f_0[x] + x * f_1[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span></span>","enumerator":"15","key":"pPxxy1UQ7R"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Merge ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wsMCMMtnCS"},{"type":"inlineMath","value":"f_0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IPDtcECp8o"},{"type":"text","value":" and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"NiJf2WJiEO"},{"type":"inlineMath","value":"f_1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FJCkBU6eu8"},{"type":"text","value":" using ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KbR9mofiCp"},{"type":"inlineMath","value":"x","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"voOaDv6ICA"},{"type":"text","value":" from the domain, which corresponds to the equation above too.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QQKWhshPz2"}],"key":"HIk9zxyAHF"}],"key":"HnwAcgfpCf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def fft_normal_step(f, D):\n\n    if len(f) == 1:\n        return {D[0]: f[0]}\n    \n    next_domain = pie_group(D)\n\n    # Check that the new domain is exactly half size of the old domain\n    assert len(next_domain) * 2 == len(D), \"len(next_domain) * 2 != len(D), {} * 2 != {}, next_domain={}, D={}\".format(len(next_domain), len(D), next_domain, D)\n    # Check that the polynomial and the domain have the same length\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n\n    f0 = fft_normal_step(f[:len(f)//2], next_domain)\n    f1 = fft_normal_step(f[len(f)//2:], next_domain)\n\n    f_new = {}\n    for x in D:\n        f_new[x] = f0[pi(x)] + f1[pi(x)] * x\n\n    # Check that f is divided into 2 parts correctly\n    for x in D:\n        if x != 0:\n            assert f0[pi(x)] == (f_new[x] + f_new[-x]) / C31(2), \"f0[pi(x)] = {}\".format(f0[pi(x)])\n            assert f1[pi(x)] == (f_new[x] - f_new[-x]) / (C31(2) * x), \"f1[pi(x)] = {}\".format(f1[pi(x)])\n        else:\n            assert f0[pi(x)] == f_new[x], \"f0[pi(x)] = {}\".format(f0[pi(x)])\n\n    # Check that the polynomial and the domain have the same length\n    assert len(f) == len(f_new), \"len(f) != len(f_new), {} != {}, f={}, f_new={}, D={}\".format(len(f), len(f_new), f, f_new, D)\n\n    # Check that ifft and fft are correct inverse operations\n    assert ifft_normal_step(f_new) == f, \"ifft(f_new) != f, {} != {}\".format(ifft_normal_step(f_new), f)\n        \n    return f_new","key":"hKHCzpLga6"},{"type":"output","id":"nLwzDSvkXyLKHvNVU2Qi-","data":[],"key":"HfuYeu1YIl"}],"key":"gPBiukf7pg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We have fft_first_step and fft_normal_step, we can define the fft function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IP03qhtXJg"}],"key":"z2rAU5fCeO"}],"key":"mwAVc6szqx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def fft(f, D):\n\n    # Check that the polynomial and the domain have the same length\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n\n    D_copy = D[:]\n    f0, f1, D = fft_first_step(f, D)\n\n    # Check that the polynomial and the domain have the same length\n    assert len(f0) == len(D), \"len(f0) != len(D), {} != {}, f0={}, D={}\".format(len(f0), len(D), f0, D)\n    assert len(f1) == len(D), \"len(f1) != len(D), {} != {}, f1={}, D={}\".format(len(f1), len(D), f1, D)\n\n    f0 = fft_normal_step(f0, D)\n    f1 = fft_normal_step(f1, D)\n\n    f = {}\n    # supply y to the polynomial\n    for t in D_copy:\n        x, y = t\n        f[t] = f0[x] + f1[x] * y\n\n    return f\n","key":"EwyK51yH4F"},{"type":"output","id":"iHTMOAu3LoSqx0oxKfaE7","data":[],"key":"DNDKpLiLgN"}],"key":"ZgkXTYGiEp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check that ifft and fft are correct inverse operations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gcg6UXSGQu"}],"key":"aesvtl8D5k"}],"key":"S0sRt9XB3c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f_prime = fft(coeffs, D_twin_coset_4_1)\n\nfor t, s in zip(f, f_prime):\n    assert t == s\n\nfor t in f:\n    print(\"f[{}]={}, f_prime[{}]={}\".format(t, f[t], t, f_prime[t]))\n    assert f[t] == f_prime[t], \"f[{}] != f_prime[{}], {} != {}\".format(t, t, f[t], f_prime[t])","key":"XBk2A5gONR"},{"type":"output","id":"r6Slf8cfXga_85WF-52qv","data":[{"name":"stdout","output_type":"stream","text":"f[11*i + 2]=29, f_prime[11*i + 2]=29\nf[10*i + 5]=30, f_prime[10*i + 5]=30\nf[2*i + 20]=10, f_prime[2*i + 20]=10\nf[5*i + 21]=5, f_prime[5*i + 21]=5\nf[20*i + 29]=8, f_prime[20*i + 29]=8\nf[21*i + 26]=21, f_prime[21*i + 26]=21\nf[29*i + 11]=16, f_prime[29*i + 11]=16\nf[26*i + 10]=18, f_prime[26*i + 10]=18\nf[20*i + 2]=30, f_prime[20*i + 2]=30\nf[5*i + 10]=2, f_prime[5*i + 10]=2\nf[2*i + 11]=23, f_prime[2*i + 11]=23\nf[10*i + 26]=5, f_prime[10*i + 26]=5\nf[11*i + 29]=22, f_prime[11*i + 29]=22\nf[26*i + 21]=9, f_prime[26*i + 21]=9\nf[29*i + 20]=28, f_prime[29*i + 20]=28\nf[21*i + 5]=16, f_prime[21*i + 5]=16\n"}],"key":"R9o78EVVFL"}],"key":"eXksu4jqPC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Circle FRI","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PI3dednidl"}],"identifier":"circle-fri","label":"Circle FRI","html_id":"circle-fri","implicit":true,"key":"kK9ZYUGpyA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Basis:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PdH8rZ6zER"}],"key":"dNCXMaUH22"},{"type":"math","value":"1, v_1(x), v_2(x), v_1(x)v_2(x), y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\quad (N = 8)","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mo stretchy=\"false\">(</mo><mi>N</mi><mo>=</mo><mn>8</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">1, v_1(x), v_2(x), v_1(x)v_2(x), y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\quad (N = 8)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">8</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"16","key":"fi12IyxjQ6"}],"key":"zmUKwmyHu7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Inputs:\n#   f is the polynomial to be folded\n#   D is the domain of f\n#   r is the random number for random linear combination\n# Outputs:\n#   The first return value is the folded polynomial\n#   The second return value is the new domain\ndef fold(f, D, r, debug=False):\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n\n    # divide\n    N = len(f)\n    # left is the first half of f, of x from 1 to g^(N/2)\n    left = f[:N//2]\n    # right is the second half of f, of x from g^(N-1) to g^(N/2), which corresponds to minus x in left\n    right = f[:N//2-1:-1]\n    assert len(left) == len(right), \"len(left) != len(right), {} != {}, left={}, right={}\".format(len(left), len(right), left, right)\n\n    for i, x in enumerate(D[:N//2]):\n        # f == f0 + x * f1\n        f0 = (left[i] + right[i]) / C31(2)\n        f1 = (left[i] - right[i]) / (C31(2) * x)\n        # f[:N//2] stores the folded polynomial\n        if debug: print(f\"f[{i}] = {f[i]} = ({left[i]} + {right[i]})/2 + {r} * ({left[i]} - {right[i]})/(2 * {x})\")\n        f[i] = f0 + r * f1\n        # if debug: print(f\"{f[i]} = ({left[i]} + {right[i]})/2 + {r} * ({left[i]} - {right[i]})/(2 * {x})\")\n        # reuse f[N//2:] to store new domain\n        f[N//2 + i] = 2 * x^2 - 1\n\n    # return the folded polynomial and the new domain\n    return f[:N//2], f[N//2:]","key":"Gc20ONHuk8"},{"type":"output","id":"7dsH0tc22UaUPLsZo4TDT","data":[],"key":"hTmmcNDWRm"}],"key":"gNfi6kv87i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"from utils import log_2\nfrom merlin.merlin_transcript import MerlinTranscript\nfrom merkle import MerkleTree\n\ndef fri(f, D, degree, query_num, transcript, debug=False):\n\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n    assert isinstance(transcript, MerlinTranscript)\n\n    if debug: print(f\"f={f}, D={D}\")\n\n    # first tree\n    first_tree = MerkleTree(f)\n    first_oracle = f\n\n    # first random number\n    transcript.append_message(b'first_tree', bytes(first_tree.root, 'ascii'))\n    r = int.from_bytes(transcript.challenge_bytes(b'r', int(4)), 'big')\n\n    # first step (J mapping)\n    # for f in natural order, we just divide f into 2 parts from the middle\n    N = len(f)\n    assert N % 2 == 0, \"N must be even, N={}\".format(N)\n\n    left = f[:N//2]\n    right = f[:N//2-1:-1]\n    assert len(left) == len(right), \"len(left) != len(right), {} != {}, left={}, right={}\".format(len(left), len(right), left, right)\n    f = [None for _ in range(N//2)]\n    for i, (_, y) in enumerate(D[:N//2]):\n        f0 = (left[i] + right[i]) / C31(2)\n        f1 = (left[i] - right[i]) / (C31(2) * y)\n        f[i] = f0 + r * f1\n        if debug: print(f\"f[{i}] = {f[i]} = ({left[i]} + {right[i]})/2 + {r} * ({left[i]} - {right[i]})/(2 * {y})\")\n\n    print(f\"f={f}\")\n\n    D = [x for x, _ in D[:N//2]]\n\n    # fold\n    trees = [MerkleTree(f)]\n    oracles = [f[:]]\n    # log_2(degree) - 1 because we have already done the first step\n    for i in range(log_2(degree) - 1):\n        # random number\n        transcript.append_message(b'tree', bytes(trees[-1].root, 'ascii'))\n\n        r = int.from_bytes(transcript.challenge_bytes(b'r', int(4)), 'big')\n        f, D = fold(f, D, r, debug)\n\n        if debug: print(f\"f={f}, D={D}\")\n\n        # merkle tree\n        trees.append(MerkleTree(f))\n        oracles.append(f[:])\n\n    # query paths\n    max_size = N\n    get_q = lambda transcript: int.from_bytes(transcript.challenge_bytes(b'query', int(4)), 'big') % max_size\n    queries = [get_q(transcript) for _ in range(query_num)]\n\n    query_paths = []\n    for q in queries:\n        max_size = N\n        cur_path = []\n        indices = []\n        x0 = q\n        x1 = max_size - q - 1\n        if x1 < x0:\n            x0, x1 = x1, x0\n\n        if debug: print(f\"max_size={max_size}\")\n        if debug: print(f\"q={q}\")\n        if debug: print(f\"x0={x0}, x1={x1}\")\n        \n        cur_path.append((first_oracle[x0], first_oracle[x1]))\n        indices.append(x0)\n        q = x0\n        max_size >>= 1\n\n        for oracle in oracles:\n            x0 = q\n            x1 = max_size - q - 1\n            if x1 < x0:\n                x0, x1 = x1, x0\n\n            if debug: print(f\"q={q}\")\n            if debug: print(f\"x0={x0}, x1={x1}\")\n            \n            cur_path.append((oracle[x0], oracle[x1]))\n            indices.append(x0)\n            q = x0\n            max_size >>= 1\n\n        query_paths.append((cur_path, indices))\n\n    # merkle paths\n    merkle_paths = []\n    for _, indices in query_paths:\n        cur_query_paths = []\n        for i, idx in enumerate(indices):\n            if i == 0:\n                if debug: print(f\"i = {i}, idx = {idx}, first_oracle[idx] = {first_oracle[idx]}\")\n                cur_query_paths.append(first_tree.get_authentication_path(idx))\n            else:\n                cur_tree = trees[i - 1]\n                if debug: print(f\"i = {i}, idx = {idx}, oracles[i-1][idx] = {oracles[i-1][idx]}\")\n                cur_query_paths.append(cur_tree.get_authentication_path(idx))\n        merkle_paths.append(cur_query_paths)\n\n    return {\n        'query_paths': query_paths,\n        'merkle_paths': merkle_paths,\n        'first_tree': first_tree.root,\n        'intermediate_trees': [tree.root for tree in trees],\n        'degree_bound': degree,\n        'final_value': f[0],\n    }","key":"MB0Tp6YDag"},{"type":"output","id":"5MdAm1o8cHmHqWZKm6zTF","data":[],"key":"j5oyGQH318"}],"key":"NOUcnzHr7z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"from merkle import verify_decommitment\n\ndef defri(fri_proof, degree_bound, T, query_num, transcript, debug=False):\n\n    assert degree_bound >= fri_proof['degree_bound']\n    degree_bound = fri_proof['degree_bound']\n\n    assert isinstance(transcript, MerlinTranscript)\n\n    first_tree = fri_proof['first_tree']\n    intermediate_trees = fri_proof['intermediate_trees']\n\n    transcript.append_message(b'first_tree', bytes(first_tree, 'ascii'))\n    r = int.from_bytes(transcript.challenge_bytes(b'r', int(4)), 'big')\n\n    fold_challenges = [r]\n    for i in range(log_2(int(degree_bound)) - 1):\n        transcript.append_message(b'tree', bytes(intermediate_trees[i], 'ascii'))\n        r = int.from_bytes(transcript.challenge_bytes(b'r', int(4)), 'big')\n        fold_challenges.append(r)\n\n    get_q = lambda transcript: int.from_bytes(transcript.challenge_bytes(b'query', int(4)), 'big') % degree_bound\n    queries = [get_q(transcript) for _ in range(query_num)]\n\n    for q, (cur_path, _), mps in zip(queries, fri_proof['query_paths'], fri_proof['merkle_paths']):\n        num_vars = degree_bound\n        for i, mp in enumerate(mps):\n\n            assert num_vars > 0, \"num_vars must be positive, num_vars={}\".format(num_vars)\n\n            x0 = q\n            x1 = num_vars - q - 1\n            if x1 < x0:\n                x0, x1 = x1, x0\n            \n            if debug: print(f\"num_vars={num_vars}\")\n            if debug: print(f\"q={q}\")\n            if debug: print(f\"x0={x0}, x1={x1}\")\n\n            code_left, code_right = F31(cur_path[i][0]), F31(cur_path[i][1])\n\n            table = T[i]\n            if debug: print(f\"i = {i}, table={table}\")\n            if i != len(mps) - 1:\n                alpha = fold_challenges[i]\n                f_code_folded = cur_path[i + 1][0 if x0 < num_vars / 4 else 1]\n                assert f_code_folded == (code_left + code_right)/2 + alpha * (code_left - code_right)/(2*table[x0]), f\"{f_code_folded} != ({code_left} + {code_right})/2 + {alpha} * ({code_left} - {code_right})/(2*{table[x0]})\"\n            else:\n                assert fri_proof['final_value'] == code_left, f\"{fri_proof['final_value']} != {code_left}\"\n\n            if i == 0:\n                assert verify_decommitment(x0, code_left, mp, fri_proof['first_tree']), f\"verify_decommitment(x0={x0}, code_left={code_left}, mp={mp}, fri_proof['first_tree']={fri_proof['first_tree']})\"\n            else:\n                assert verify_decommitment(x0, code_left, mp, fri_proof['intermediate_trees'][i - 1]), f\"verify_decommitment(x0={x0}, code_left={code_left}, mp={mp}, fri_proof['intermediate_trees'][i - 1]={fri_proof['intermediate_trees'][i - 1]})\"\n\n            num_vars >>= 1\n            q = x0","key":"TCvyoahhZd"},{"type":"output","id":"B71Rv27K0q3G8h1aW0iuf","data":[],"key":"V8txpp5uhe"}],"key":"yzEEGxHnT4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f = [randint(0, 30) for _ in range(len(D_standard_coset_4))]\nquery_num = 4\nfri_proof = fri(f, D_standard_coset_4, len(D_standard_coset_4), query_num, MerlinTranscript(b'FRI'), debug=True)\nprint(\"---------------- fri ----------------\")\nT = []\ndomain = D_standard_coset_4[:]\nfor i in range(log_2(len(domain)) + 1):\n    if i != 0:\n        T.append([x for x, _ in domain])\n        domain = sq(domain)[:len(domain)//2]\n    else:\n        T.append([y for _, y in domain])\n        domain = domain[:len(domain)//2]\n\ndefri(fri_proof, len(D_standard_coset_4), T, query_num, MerlinTranscript(b'FRI'), debug=True)","key":"JYFyyj3isX"},{"type":"output","id":"h7HwcN-BzvEwnJSgi5WTN","data":[{"name":"stdout","output_type":"stream","text":"f=[24, 1, 6, 10, 3, 8, 29, 27, 25, 23, 3, 3, 13, 10, 24, 8], D=[5*i + 10, 11*i + 2, 2*i + 11, 10*i + 5, 10*i + 26, 2*i + 20, 11*i + 29, 5*i + 21, 26*i + 21, 20*i + 29, 29*i + 20, 21*i + 26, 21*i + 5, 29*i + 11, 20*i + 2, 26*i + 10]\nf[0] = 1 = (24 + 8)/2 + 2944556307 * (24 - 8)/(2 * 5)\nf[1] = 26 = (1 + 24)/2 + 2944556307 * (1 - 24)/(2 * 11)\nf[2] = 29 = (6 + 10)/2 + 2944556307 * (6 - 10)/(2 * 2)\nf[3] = 10 = (10 + 13)/2 + 2944556307 * (10 - 13)/(2 * 10)\nf[4] = 3 = (3 + 3)/2 + 2944556307 * (3 - 3)/(2 * 10)\nf[5] = 18 = (8 + 3)/2 + 2944556307 * (8 - 3)/(2 * 2)\nf[6] = 9 = (29 + 23)/2 + 2944556307 * (29 - 23)/(2 * 11)\nf[7] = 28 = (27 + 25)/2 + 2944556307 * (27 - 25)/(2 * 5)\nf=[1, 26, 29, 10, 3, 18, 9, 28]\nf[0] = 1 = (1 + 28)/2 + 144160416 * (1 - 28)/(2 * 10)\nf[1] = 26 = (26 + 9)/2 + 144160416 * (26 - 9)/(2 * 2)\nf[2] = 29 = (29 + 18)/2 + 144160416 * (29 - 18)/(2 * 11)\nf[3] = 10 = (10 + 3)/2 + 144160416 * (10 - 3)/(2 * 5)\nf=[30, 2, 8, 22], D=[13, 7, 24, 18]\nf[0] = 30 = (30 + 22)/2 + 3212835317 * (30 - 22)/(2 * 13)\nf[1] = 2 = (2 + 8)/2 + 3212835317 * (2 - 8)/(2 * 7)\nf=[23, 28], D=[27, 4]\nf[0] = 23 = (23 + 28)/2 + 133754179 * (23 - 28)/(2 * 27)\nf=[1], D=[0]\nmax_size=16\nq=2\nx0=2, x1=13\nq=2\nx0=2, x1=5\nq=2\nx0=1, x1=2\nq=1\nx0=0, x1=1\nq=0\nx0=0, x1=0\nmax_size=16\nq=0\nx0=0, x1=15\nq=0\nx0=0, x1=7\nq=0\nx0=0, x1=3\nq=0\nx0=0, x1=1\nq=0\nx0=0, x1=0\nmax_size=16\nq=7\nx0=7, x1=8\nq=7\nx0=0, x1=7\nq=0\nx0=0, x1=3\nq=0\nx0=0, x1=1\nq=0\nx0=0, x1=0\nmax_size=16\nq=10\nx0=5, x1=10\nq=5\nx0=2, x1=5\nq=2\nx0=1, x1=2\nq=1\nx0=0, x1=1\nq=0\nx0=0, x1=0\ni = 0, idx = 2, first_oracle[idx] = 6\ni = 1, idx = 2, oracles[i-1][idx] = 29\ni = 2, idx = 1, oracles[i-1][idx] = 2\ni = 3, idx = 0, oracles[i-1][idx] = 23\ni = 4, idx = 0, oracles[i-1][idx] = 1\ni = 0, idx = 0, first_oracle[idx] = 24\ni = 1, idx = 0, oracles[i-1][idx] = 1\ni = 2, idx = 0, oracles[i-1][idx] = 30\ni = 3, idx = 0, oracles[i-1][idx] = 23\ni = 4, idx = 0, oracles[i-1][idx] = 1\ni = 0, idx = 7, first_oracle[idx] = 27\ni = 1, idx = 0, oracles[i-1][idx] = 1\ni = 2, idx = 0, oracles[i-1][idx] = 30\ni = 3, idx = 0, oracles[i-1][idx] = 23\ni = 4, idx = 0, oracles[i-1][idx] = 1\ni = 0, idx = 5, first_oracle[idx] = 8\ni = 1, idx = 2, oracles[i-1][idx] = 29\ni = 2, idx = 1, oracles[i-1][idx] = 2\ni = 3, idx = 0, oracles[i-1][idx] = 23\ni = 4, idx = 0, oracles[i-1][idx] = 1\n---------------- fri ----------------\nnum_vars=16\nq=2\nx0=2, x1=13\ni = 0, table=[5, 11, 2, 10, 10, 2, 11, 5, 26, 20, 29, 21, 21, 29, 20, 26]\nnum_vars=8\nq=2\nx0=2, x1=5\ni = 1, table=[10, 2, 11, 5, 26, 20, 29, 21]\nnum_vars=4\nq=2\nx0=1, x1=2\ni = 2, table=[13, 7, 24, 18]\nnum_vars=2\nq=1\nx0=0, x1=1\ni = 3, table=[27, 4]\nnum_vars=1\nq=0\nx0=0, x1=0\ni = 4, table=[0]\nnum_vars=16\nq=0\nx0=0, x1=15\ni = 0, table=[5, 11, 2, 10, 10, 2, 11, 5, 26, 20, 29, 21, 21, 29, 20, 26]\nnum_vars=8\nq=0\nx0=0, x1=7\ni = 1, table=[10, 2, 11, 5, 26, 20, 29, 21]\nnum_vars=4\nq=0\nx0=0, x1=3\ni = 2, table=[13, 7, 24, 18]\nnum_vars=2\nq=0\nx0=0, x1=1\ni = 3, table=[27, 4]\nnum_vars=1\nq=0\nx0=0, x1=0\ni = 4, table=[0]\nnum_vars=16\nq=7\nx0=7, x1=8\ni = 0, table=[5, 11, 2, 10, 10, 2, 11, 5, 26, 20, 29, 21, 21, 29, 20, 26]\nnum_vars=8\nq=7\nx0=0, x1=7\ni = 1, table=[10, 2, 11, 5, 26, 20, 29, 21]\nnum_vars=4\nq=0\nx0=0, x1=3\ni = 2, table=[13, 7, 24, 18]\nnum_vars=2\nq=0\nx0=0, x1=1\ni = 3, table=[27, 4]\nnum_vars=1\nq=0\nx0=0, x1=0\ni = 4, table=[0]\nnum_vars=16\nq=10\nx0=5, x1=10\ni = 0, table=[5, 11, 2, 10, 10, 2, 11, 5, 26, 20, 29, 21, 21, 29, 20, 26]\nnum_vars=8\nq=5\nx0=2, x1=5\ni = 1, table=[10, 2, 11, 5, 26, 20, 29, 21]\nnum_vars=4\nq=2\nx0=1, x1=2\ni = 2, table=[13, 7, 24, 18]\nnum_vars=2\nq=1\nx0=0, x1=1\ni = 3, table=[27, 4]\nnum_vars=1\nq=0\nx0=0, x1=0\ni = 4, table=[0]\n"}],"key":"toSKKUWaXi"}],"key":"id6u8U6bPv"}],"key":"ZrqwlltxsI"},"references":{"cite":{"order":[],"data":{}}}}