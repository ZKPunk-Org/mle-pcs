{"version":2,"kind":"Notebook","sha256":"4cf09aabc48ff70a7fe0cae476fb97836b165157d7b39532dd91d058f4c49d7b","slug":"src.circle","location":"/src/circle.ipynb","dependencies":[],"frontmatter":{"title":"Circle Group","content_includes_title":true,"kernelspec":{"name":"SageMath-9.8","display_name":"SageMath 9.8","language":"sage"},"github":"https://github.com/executablebooks/jupyter-book","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/executablebooks/jupyter-book/blob/main/src/circle.ipynb","exports":[{"format":"ipynb","filename":"circle.ipynb","url":"/circle-e39892361ec68a92af43743b59b36a20.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Circle Group","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tD8axU6g40"}],"identifier":"circle-group","label":"Circle Group","html_id":"circle-group","implicit":true,"key":"SXoMn9RqgJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before we start building circle FFT, let’s first build the circle group, which will be used as the domain of circle fft.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JFmZkVgfRK"}],"key":"OgevZXDHKg"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We choose a basic field GF(31), which has a order of 31. And then we extend it to a 2-degree extension field GF(","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MyCqZXanmJ"},{"type":"span","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"31","key":"m9QWXmCOV1"},{"type":"superscript","children":[{"type":"text","value":"2","key":"y3kZ4DxTC9"}],"key":"BLao9Uycga"}],"key":"lERWjzueE4"},{"type":"text","value":"), to get a multiplicative subgroup of order 32.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"i45BGwwkd0"}],"key":"p7oML2Y3Jr"}],"key":"cZqpBG0g6U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"F31 = GF(31)\nR31.<X> = F31[]\nR31","key":"xi1cbHt6bY"},{"type":"output","id":"RInUDvg1m2_TJSqMKGGp4","data":[{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/plain":{"content":"Univariate Polynomial Ring in X over Finite Field of size 31","content_type":"text/plain"}}}],"key":"GUP0jfux91"}],"key":"LfRmr2deSY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we extend F31 to a 2-degree extension field GF(","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HmZgYMAXNV"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"31","key":"L4zef5d1pa"},{"type":"superscript","children":[{"type":"text","value":"2","key":"Wu6QCtxKbP"}],"key":"WOftgyjNs3"}],"key":"Oat3AK1pH5"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zFFijQoLQz"}],"key":"emVbtIkfpD"}],"key":"XhNmxEHu9U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"C31.<i> = F31.extension(X^2 + 1)\nC31","key":"PJ9lAcd1de"},{"type":"output","id":"enJ0lQwC3Hj7TuxR4REIQ","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"Finite Field in i of size 31^2","content_type":"text/plain"}}}],"key":"PqXxOpgGx4"}],"key":"xk0GlNhob6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We want to find a group element of order 32, so we take the generator of GF(","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HSGk8Ukyot"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"31","key":"sx9Yi2Ucln"},{"type":"superscript","children":[{"type":"text","value":"2","key":"ONVRrWiWTr"}],"key":"OCS0zSiQeO"}],"key":"A2q4kdOf3O"},{"type":"text","value":") and get 30th power of it.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nEUUoFWTYV"}],"key":"Rrpcr1jakw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Fact","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YQLP9Bzj2c"}],"key":"iPPu21hKhg"},{"type":"text","value":": For any prime field ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xNZncrJxlf"},{"type":"inlineMath","value":"\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mHeJGvKGMI"},{"type":"text","value":", where ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nzfxhevAKj"},{"type":"inlineMath","value":"p=2^n - 1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p=2^n - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"D44D7Liqhy"},{"type":"text","value":", the 2-degree extension over ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YaMW52ZQ7L"},{"type":"inlineMath","value":"\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"u5tnfWaEAp"},{"type":"text","value":" is\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T6xF4yNQQv"},{"type":"inlineMath","value":"K=\\mathbb{F}_{p^2}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><msub><mi mathvariant=\"double-struck\">F</mi><msup><mi>p</mi><mn>2</mn></msup></msub></mrow><annotation encoding=\"application/x-tex\">K=\\mathbb{F}_{p^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0026em;vertical-align:-0.3137em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5224em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7463em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3137em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wLwlhGmTjW"},{"type":"text","value":", then ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ze908igZOI"},{"type":"inlineMath","value":"K","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"oefJyJ6rGl"},{"type":"text","value":" has a multiplicative subgroup with order ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Vy7TtTLuLJ"},{"type":"inlineMath","value":"2^n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"WIJvBUCzAu"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Te3lvhU5rn"}],"key":"jQCVkHGOkg"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Proof:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wo9XyKD8el"}],"key":"TE3aSLcJPj"},{"type":"math","value":"p^2 - 1 = (2^n - 1) * (2^n - 1) - 1 = 2^{2n} - 2^{n+1} = 2^n(2^n - 2)","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>p</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>∗</mo><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>−</mo><mn>1</mn><mo>=</mo><msup><mn>2</mn><mrow><mn>2</mn><mi>n</mi></mrow></msup><mo>−</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p^2 - 1 = (2^n - 1) * (2^n - 1) - 1 = 2^{2n} - 2^{n+1} = 2^n(2^n - 2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"1","key":"dMdZus3vCi"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"In our case, F31.order() - 1 is ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"JW8g90c1eh"},{"type":"inlineMath","value":"2^n - 2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2^n - 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"z92eI7dCUT"},{"type":"text","value":".","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"DCAYvcmg6a"}],"key":"JjXzlUcVjI"}],"key":"C9iV1Nx3QH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"\ng = C31.multiplicative_generator()^(F31.order() - 1)\ng","key":"sRq55RCLGg"},{"type":"output","id":"KXNWDnNiqaT1PQdoYw3YG","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"11*i + 29","content_type":"text/plain"}}}],"key":"lBBsVdP2q0"}],"key":"Lb4XasVnbP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define a function to calculate the order of an element in the circle group.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pu3MbQPDnB"}],"key":"N2oFDbofLZ"}],"key":"sIe0bieU0V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def group_ord(elem):\n    K = elem.parent()\n\n    for i in range(1, K.order()):\n        # An order of an element is defined by how much power we need to raise the element to get the identity element\n        if elem**i == K.one():\n            return i\n    return \"False\"","key":"IX3U5JW1oK"},{"type":"output","id":"61PuakNR1DRIFqEmhKrlv","data":[],"key":"MSuNTAJSoI"}],"key":"wI5z67T3oI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check that g is of order 32.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OtcWoaByXi"}],"key":"OMIlEIJx7h"}],"key":"yt7sVnDBR7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"group_ord(g)","key":"WXqqhNjwz0"},{"type":"output","id":"hzo77cigl_jTvwAuWoDgD","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"32","content_type":"text/plain"}}}],"key":"Tl5odsdcEF"}],"key":"LU09bpFwAt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the group multiplication, which is similar to complex number multiplication.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FWK7Yadj9O"}],"key":"pa3wrlVnvj"}],"key":"ir43TmJt4Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def group_mul(g1, g2):\n    x1, y1 = g1\n    x2, y2 = g2\n    return (x1 * x2 - y1 * y2) + (x1 * y2 + x2 * y1) * i ","key":"I7RkJAuigN"},{"type":"output","id":"F3WM4RJOrPy0RcopYZWiB","data":[],"key":"Wpn1A40NGh"}],"key":"TyGdUXrApq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the group inverse, which is also the J mapping in the paper.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"imQhGZyhJe"}],"key":"lGFxVWVxnv"}],"key":"EIY8wuyAYa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def group_inv(g1):\n    x1, y1 = g1\n    return (x1 - y1 * i)","key":"gt2D1T3HGJ"},{"type":"output","id":"yZ_EXcfvj_ZLQ9ezW-be8","data":[],"key":"LRHFEfekiL"}],"key":"hIuX1eLI7v"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define show function to print group.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vAWeN3t454"}],"key":"AceYQ0ExBf"}],"key":"MUKxlkTqda"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def show(GG): \n    for j in range(0, len(GG)):\n        t = GG[j]\n        t0 = t[0]\n        t1 = t[1]\n        if t1 > F31(15) and t1 <= F31(30):\n            t1_str = \"-\" + str(31-t1)\n        else:\n            t1_str = str(t1)\n        print(\"i={}, log={}, ord={}, ({},{})\".format(j, log_gen(g, t), group_ord(t), t0, t1_str))","key":"HJ0MDzTKLA"},{"type":"output","id":"K7WF7lRV-OxYcVsvtEBa5","data":[],"key":"rRuS44a2S5"}],"key":"BMepEYFW2X"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define log_gen function to calculate the power of an element in the circle group.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WUeadhfc5c"}],"key":"ondIjW2kUE"}],"key":"kmAAk86vmD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def log_gen(gen, t):\n    K = gen.parent()\n    for i in range(1, K.order()):\n        if gen^i == t:\n            return i\n    return \"Fail\"","key":"heOVMEefo7"},{"type":"output","id":"tUOEX72PUa5-lI8RKRK84","data":[],"key":"OcXKVBrOua"}],"key":"nxDEXa4L9E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Jump over the circle","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mbRtUz2D2X"}],"identifier":"jump-over-the-circle","label":"Jump over the circle","html_id":"jump-over-the-circle","implicit":true,"key":"F2JPCAhePP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we define the generator for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EZIUfFOOlX"},{"type":"inlineCode","value":"Circle Group","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qoqf0Doi3x"},{"type":"text","value":" as chosen by Vitalik ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HzN2jIy9DL"},{"type":"link","url":"https://vitalik.eth.limo/general/2024/07/23/circlestarks.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​vitalik​.eth​.limo​/general​/2024​/07​/23​/circlestarks​.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uiZEMabwPe"}],"urlSource":"https://vitalik.eth.limo/general/2024/07/23/circlestarks.html","key":"oTNcCiu2ev"}],"key":"npZirG8ruw"}],"key":"hvLUxyXpge"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# optional\ng = 10 + 5*i\ngroup_ord(g)","key":"KxlAe89udw"},{"type":"output","id":"FchPKPoySEETjfrn1h9rF","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"32","content_type":"text/plain"}}}],"key":"tOuy9nAzOy"}],"key":"NMiEMyYKkO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Then we generate G5, which is a normal multiplicative group of order ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b5no7HZUS0"},{"type":"span","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2","key":"GnKjrGdQEW"},{"type":"superscript","children":[{"type":"text","value":"5","key":"zmJYW0h1VN"}],"key":"PTzR97zygT"}],"key":"MtA6bVkP4X"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SmA9p5QY0Q"}],"key":"qRyx8ESLSf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"G5’s elements must be on the circle ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yNL9ul5zmS"},{"type":"inlineMath","value":"x^2 + y^2 = 1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x^2 + y^2 = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"kUgblzf4mp"},{"type":"text","value":", due to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gx7O6EohMm"}],"key":"XR4K0i9FQD"},{"type":"math","value":"a^{p + 1} = 1, a = x + y * i","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>a</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>∗</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">a^{p + 1} = 1, a = x + y * i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span></span>","enumerator":"2","key":"ittUeJ3902"},{"type":"math","value":"a * a ^ p = (x + y * i) * (x - y * i) = x^2 + y^2 = 1","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>a</mi><mo>∗</mo><msup><mi>a</mi><mi>p</mi></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>∗</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo>∗</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a * a ^ p = (x + y * i) * (x - y * i) = x^2 + y^2 = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7144em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>","enumerator":"3","key":"CoRlx77Wto"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Since ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Xc4dTYZZbs"},{"type":"inlineMath","value":"a^p","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mi>p</mi></msup></mrow><annotation encoding=\"application/x-tex\">a^p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span></span></span>","key":"vRtzLR0fSZ"},{"type":"text","value":" is a Frobenius map, ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Llf3eJkola"},{"type":"inlineMath","value":"a^p","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mi>p</mi></msup></mrow><annotation encoding=\"application/x-tex\">a^p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span></span></span>","key":"k42BBtyxz8"},{"type":"text","value":" equals to the conjugate of ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"oKowzGXoXP"},{"type":"inlineMath","value":"a","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"MOJ0eqdS33"},{"type":"text","value":", which is ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ebOO2Y1HdZ"},{"type":"inlineMath","value":"x - y * i","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>−</mo><mi>y</mi><mo>∗</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">x - y * i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"cPs4LI9rwg"},{"type":"text","value":".","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"YbEMTRQpIm"}],"key":"Wp8asXAOcd"}],"key":"flP1CUHJSA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"G5 = [g^i for i in range(0, 2^5)]\n# check that G5's elements are on the circle x^2 + y^2 = 1\nfor t in G5:\n    x, y = t\n    assert x^2 + y^2 == 1\nG5","key":"voiNLzaJFH"},{"type":"output","id":"y79XPcJyhS1V_QPPZvuN2","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"[1,\n 5*i + 10,\n 7*i + 13,\n 11*i + 2,\n 27*i + 27,\n 2*i + 11,\n 13*i + 7,\n 10*i + 5,\n i,\n 10*i + 26,\n 13*i + 24,\n 2*i + 20,\n 27*i + 4,\n 11*i + 29,\n 7*i + 18,\n 5*i + 21,\n 30,\n 26*i + 21,\n 24*i + 18,\n 20*i + 29,\n 4*i + 4,\n 29*i + 20,\n 18*i + 24,\n 21*i + 26,\n 30*i,\n 21*i + 5,\n 18*i + 7,\n 29*i + 11,\n 4*i + 27,\n 20*i + 2,\n 24*i + 13,\n 26*i + 10]","content_type":"text/plain"}}}],"key":"TRsO8q1LGU"}],"key":"ZJ762g93jH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print information of G5’s elements.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xLA35YiODJ"}],"key":"KZNoKpXwTr"}],"key":"LmoVAEWohg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"for j in range(0, 32):\n    t = g^j\n    print(\"i={}, log={}, ord={}, ({},{})\".format(j, log_gen(g, t), group_ord(t), t[0], t[1]))","key":"odHNoUgcn0"},{"type":"output","id":"vgL3KozStLOkYCTUDdYxa","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=32, ord=1, (1,0)\ni=1, log=1, ord=32, (10,5)\ni=2, log=2, ord=16, (13,7)\ni=3, log=3, ord=32, (2,11)\ni=4, log=4, ord=8, (27,27)\ni=5, log=5, ord=32, (11,2)\ni=6, log=6, ord=16, (7,13)\ni=7, log=7, ord=32, (5,10)\ni=8, log=8, ord=4, (0,1)\ni=9, log=9, ord=32, (26,10)\ni=10, log=10, ord=16, (24,13)\ni=11, log=11, ord=32, (20,2)\ni=12, log=12, ord=8, (4,27)\ni=13, log=13, ord=32, (29,11)\ni=14, log=14, ord=16, (18,7)\ni=15, log=15, ord=32, (21,5)\ni=16, log=16, ord=2, (30,0)\ni=17, log=17, ord=32, (21,26)\ni=18, log=18, ord=16, (18,24)\ni=19, log=19, ord=32, (29,20)\ni=20, log=20, ord=8, (4,4)\ni=21, log=21, ord=32, (20,29)\ni=22, log=22, ord=16, (24,18)\ni=23, log=23, ord=32, (26,21)\ni=24, log=24, ord=4, (0,30)\ni=25, log=25, ord=32, (5,21)\ni=26, log=26, ord=16, (7,18)\ni=27, log=27, ord=32, (11,29)\ni=28, log=28, ord=8, (27,4)\ni=29, log=29, ord=32, (2,20)\ni=30, log=30, ord=16, (13,24)\ni=31, log=31, ord=32, (10,26)\n"}],"key":"CNtqGxM63s"}],"key":"F0dVJ3pTeh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check elements’ operation on G5.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wq3JSMpbpG"}],"key":"HGAoPy6nFw"}],"key":"yKGDsw0ddr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"assert G5[1] * G5[1] == G5[2]\nassert G5[3] * G5[4] == G5[7]\nassert group_mul(G5[1], G5[2]) == G5[3]\nassert group_inv(G5[1]) ==  G5[31]\nassert G5[1] * group_inv(G5[1]) == 1","key":"K3nA1Mcrmd"},{"type":"output","id":"SBqa78_47ntPcK77RvhcJ","data":[],"key":"Q92IyJmJZB"}],"key":"h0Q4NByT2J"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate G4 from G5 by squaring each element.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OSH6YWsW7i"}],"key":"dKHKkLs4tf"}],"key":"AVIuPzbTEH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"G4 = [t^2 for t in G5[:16]]\nG4","key":"eFBtFVnZOY"},{"type":"output","id":"JTMpG8a39StdvfmXuG22y","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"[1,\n 7*i + 13,\n 27*i + 27,\n 13*i + 7,\n i,\n 13*i + 24,\n 27*i + 4,\n 7*i + 18,\n 30,\n 24*i + 18,\n 4*i + 4,\n 18*i + 24,\n 30*i,\n 18*i + 7,\n 4*i + 27,\n 24*i + 13]","content_type":"text/plain"}}}],"key":"n502S8fYWP"}],"key":"SM5DumHmJs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate G3 from G4 by squaring each element.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BpDHJjBCjN"}],"key":"WmXslEmSUN"}],"key":"CdETAWZ3Fn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"G3 = [t^2 for t in G4[:8]]\nG3","key":"VILEyoYgCH"},{"type":"output","id":"6-ceHc6JXdGEYNwlZA4v0","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"[1, 27*i + 27, i, 27*i + 4, 30, 4*i + 4, 30*i, 4*i + 27]","content_type":"text/plain"}}}],"key":"woWxJkEpsU"}],"key":"rw0C8S6Wcd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Standard Position Coset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XKDPvdKZO2"}],"identifier":"standard-position-coset","label":"Standard Position Coset","html_id":"standard-position-coset","implicit":true,"key":"QUEtHqnLvN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OhsB3RYFzR"},{"type":"inlineMath","value":"Q","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"Aqy2b6r4TD"},{"type":"text","value":" be the generator of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mz2z618NWF"},{"type":"inlineMath","value":"G_{n+1}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">G_{n+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Y4J3at8ju1"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pHXqrStaJn"},{"type":"inlineMath","value":"D","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"CrE3MZifab"},{"type":"text","value":" is a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hihwOKEDLj"},{"type":"inlineCode","value":"standard position coset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XCCDXu09De"},{"type":"text","value":" of size ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NQF6PKvpbX"},{"type":"inlineMath","value":"2^n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"aVfjZH7Spu"}],"key":"Lh2KwOmmDv"},{"type":"math","value":"D = Q\\cdot G_n","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo>=</mo><mi>Q</mi><mo>⋅</mo><msub><mi>G</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">D = Q\\cdot G_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"xruBaOPkMI"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"WgAeiBTika"},{"type":"inlineMath","value":"ord(Q)=2^{n+1}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">ord(Q)=2^{n+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"jXQA9VQvew"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DTeuUtyOA9"}],"key":"KmmDHOhnE4"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yoxhAsKHry"},{"type":"inlineMath","value":"D","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"DRscE97hac"},{"type":"text","value":" is also a ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"AkqhByIrXg"},{"type":"inlineCode","value":"twin-coset","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jk1NBKLOAZ"},{"type":"text","value":" of size ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"mIJjCMNLvm"},{"type":"inlineMath","value":"2^n","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"uUOeqhFdQT"},{"type":"text","value":" defined with ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dAmtsfFqtu"},{"type":"inlineMath","value":"G_{n-1}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">G_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rNllSBo1y7"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ndURz8YAOe"}],"key":"R5jgwtCUFt"},{"type":"math","value":"D = Q\\cdot G_{n-1} \\uplus Q^{-1}\\cdot G_{n-1}","position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo>=</mo><mi>Q</mi><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊎</mo><msup><mi>Q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D = Q\\cdot G_{n-1} \\uplus Q^{-1}\\cdot G_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊎</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"XBaZbNWH04"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The rotation ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"SfhqBZqlYA"},{"type":"inlineMath","value":"Q^2","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>Q</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">Q^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"i6dtN4z3DS"},{"type":"text","value":" is exactly the generator of ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"NQtnV6NCuO"},{"type":"inlineMath","value":"G_n","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">G_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Ot24FXgwlH"},{"type":"text","value":".","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"MjbsEWQJzd"}],"key":"TzNUiLFJXW"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Here we construct a series of cosets, including standard position cosets and twin cosets, where we can randomly find a coset for circle fft.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"HLZfF7gyg1"}],"key":"DK6QL9S4FI"}],"key":"hFzuRH2djF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Define a coset or G4 from a rotation Q, ord(Q) = 32\n#\n# Let Q = g (generator of G, whose order is 32)\n\nD_standard_coset_4 = [g * t for t in G4]; show(D_standard_coset_4)","key":"qOlOMonouD"},{"type":"output","id":"bFFLRtPz7375TxvLArDxK","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=1, ord=32, (10,5)\ni=1, log=3, ord=32, (2,11)\ni=2, log=5, ord=32, (11,2)\ni=3, log=7, ord=32, (5,10)\ni=4, log=9, ord=32, (26,10)\ni=5, log=11, ord=32, (20,2)\ni=6, log=13, ord=32, (29,11)\ni=7, log=15, ord=32, (21,5)\ni=8, log=17, ord=32, (21,-5)\ni=9, log=19, ord=32, (29,-11)\ni=10, log=21, ord=32, (20,-2)\ni=11, log=23, ord=32, (26,-10)\ni=12, log=25, ord=32, (5,-10)\ni=13, log=27, ord=32, (11,-2)\ni=14, log=29, ord=32, (2,-11)\ni=15, log=31, ord=32, (10,-5)\n"}],"key":"VZaKGrPDaQ"}],"key":"l3CTlpPYGZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# D_twin_coset_4 is equal to D_standard_coset_4 in the set-theoretic sense, with different order\n\nD_twin_coset_4 = [g * t for t in G3] + [group_inv(g) * t for t in G3]; show(D_standard_coset_4)\n\n# `log` specifies the order of an element in the circle","key":"LA43ibTp5p"},{"type":"output","id":"5sYteDRke5tZn05AUuMNU","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=1, ord=32, (10,5)\ni=1, log=3, ord=32, (2,11)\ni=2, log=5, ord=32, (11,2)\ni=3, log=7, ord=32, (5,10)\ni=4, log=9, ord=32, (26,10)\ni=5, log=11, ord=32, (20,2)\ni=6, log=13, ord=32, (29,11)\ni=7, log=15, ord=32, (21,5)\ni=8, log=17, ord=32, (21,-5)\ni=9, log=19, ord=32, (29,-11)\ni=10, log=21, ord=32, (20,-2)\ni=11, log=23, ord=32, (26,-10)\ni=12, log=25, ord=32, (5,-10)\ni=13, log=27, ord=32, (11,-2)\ni=14, log=29, ord=32, (2,-11)\ni=15, log=31, ord=32, (10,-5)\n"}],"key":"pQ9lrIxuYS"}],"key":"kV4ll3Zg2P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# This is also a twin-coset of size 16\n\nD_twin_coset_4_1 = [G5[3] * t for t in G3] + [group_inv(G5[3]) * t for t in G3]; show(D_twin_coset_4_1)","key":"Rzq7Z1tWWs"},{"type":"output","id":"B9Bwb5ZhmkDV1L3TK8_lX","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=3, ord=32, (2,11)\ni=1, log=7, ord=32, (5,10)\ni=2, log=11, ord=32, (20,2)\ni=3, log=15, ord=32, (21,5)\ni=4, log=19, ord=32, (29,-11)\ni=5, log=23, ord=32, (26,-10)\ni=6, log=27, ord=32, (11,-2)\ni=7, log=31, ord=32, (10,-5)\ni=8, log=29, ord=32, (2,-11)\ni=9, log=1, ord=32, (10,5)\ni=10, log=5, ord=32, (11,2)\ni=11, log=9, ord=32, (26,10)\ni=12, log=13, ord=32, (29,11)\ni=13, log=17, ord=32, (21,-5)\ni=14, log=21, ord=32, (20,-2)\ni=15, log=25, ord=32, (5,-10)\n"}],"key":"j2SM2EU7tC"}],"key":"YejDldNl0C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Again\n\nD_twin_coset_4_2 = [G5[5] * t for t in G3] + [group_inv(G5[5]) * t for t in G3]; show(D_twin_coset_4_2)","key":"l0vp1IgSXS"},{"type":"output","id":"oh8CpANla-SFl0QRJ_hDy","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=5, ord=32, (11,2)\ni=1, log=9, ord=32, (26,10)\ni=2, log=13, ord=32, (29,11)\ni=3, log=17, ord=32, (21,-5)\ni=4, log=21, ord=32, (20,-2)\ni=5, log=25, ord=32, (5,-10)\ni=6, log=29, ord=32, (2,-11)\ni=7, log=1, ord=32, (10,5)\ni=8, log=27, ord=32, (11,-2)\ni=9, log=31, ord=32, (10,-5)\ni=10, log=3, ord=32, (2,11)\ni=11, log=7, ord=32, (5,10)\ni=12, log=11, ord=32, (20,2)\ni=13, log=15, ord=32, (21,5)\ni=14, log=19, ord=32, (29,-11)\ni=15, log=23, ord=32, (26,-10)\n"}],"key":"PKUw3MBiYU"}],"key":"T8oRAmF4wt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Fact:\n#   g^2 is the generator of G4\n#   g * G4 is the standard position coset\n\nG4 == [(g^2)^i for i in range(0, 16)]","key":"rfifuODiQI"},{"type":"output","id":"LSKJ7_H64p26g44Di1abD","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"True","content_type":"text/plain"}}}],"key":"ovUEkjSXC6"}],"key":"OWcszQWJ6i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Define a coset or G3 from a rotation Q, ord(Q) = 16\n#\n# Let Q = g^2 (g is the generator of G5, whose order is 32)\n\nD_standard_coset_3 = [g^2 * t for t in G3]; show(D_standard_coset_3)","key":"XkRQtSgKvj"},{"type":"output","id":"V9z68_ZLZcQ_qrmONAAcW","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=2, ord=16, (13,7)\ni=1, log=6, ord=16, (7,13)\ni=2, log=10, ord=16, (24,13)\ni=3, log=14, ord=16, (18,7)\ni=4, log=18, ord=16, (18,-7)\ni=5, log=22, ord=16, (24,-13)\ni=6, log=26, ord=16, (7,-13)\ni=7, log=30, ord=16, (13,-7)\n"}],"key":"k1RSwyD4ej"}],"key":"Wnx6PQhLHs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Squaring map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r2XS6Al4Qn"}],"identifier":"squaring-map","label":"Squaring map","html_id":"squaring-map","implicit":true,"key":"a1XKdOwrDx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Lemma","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q14JaqcalB"}],"key":"Va7mP5toDC"},{"type":"text","value":": For any twin-coset ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iTFMgImTfW"},{"type":"inlineMath","value":"D","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"dq5zmwB4lj"},{"type":"text","value":" of size ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gn7QfSJUSS"},{"type":"inlineMath","value":"N=2^n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">N=2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>","key":"pnGWfOG4MV"},{"type":"text","value":", the image of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o8qEWGn5sw"},{"type":"inlineMath","value":"\\pi(D)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\pi(D)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span></span></span></span>","key":"kvu8G9E1Rl"},{"type":"text","value":" must be a twin-coset of size ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xcrrTaSZLx"},{"type":"inlineMath","value":"2^{n-1}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">2^{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Ie676Znx12"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J9tERruJlc"}],"key":"KQ6qKFf9hF"},{"type":"math","value":"D = Q\\cdot G_{n-1} \\uplus Q^{-1}\\cdot G_{n-1}","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo>=</mo><mi>Q</mi><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊎</mo><msup><mi>Q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D = Q\\cdot G_{n-1} \\uplus Q^{-1}\\cdot G_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊎</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0585em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"VwAzHruSc8"},{"type":"math","value":"\\pi(D) = \\pi(Q)\\cdot G_{n-2} \\uplus \\pi(Q)^{-1}\\cdot G_{n-2}","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>π</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>⊎</mo><mi>π</mi><mo stretchy=\"false\">(</mo><mi>Q</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msub><mi>G</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\pi(D) = \\pi(Q)\\cdot G_{n-2} \\uplus \\pi(Q)^{-1}\\cdot G_{n-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊎</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"7","key":"DY6gI9exoJ"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Fact","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZFfriyrNxa"}],"key":"MV93T0TqKK"},{"type":"text","value":": If ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"FE8k00PVC5"},{"type":"inlineMath","value":"D","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"aegyiLhdrT"},{"type":"text","value":" is a standard position coset, so is ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"DPSv6hZyY9"},{"type":"inlineMath","value":"\\pi(D)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\pi(D)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span></span></span></span>","key":"rQpYuLfLhY"},{"type":"text","value":".","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"H5TLTOGHho"}],"key":"oHDifSQTDw"}],"key":"XsxamAovqd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def sq(D):\n    rs = []\n    for t in D:\n        if t^2 not in rs:\n            # x' == 2 * x^2 - 1\n            rs += [t^2]\n    return rs","key":"uKx03nTzrW"},{"type":"output","id":"CXoGqflPXgYohrYDx3Qsv","data":[],"key":"X7AMiKthGF"}],"key":"NzWWIt89Fj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# This is exactly the same coset we generated from G4 before\n\nD_standard_coset_3 = sq(D_standard_coset_4); show(D_standard_coset_3)","key":"KCF4wvUshj"},{"type":"output","id":"OilzsXvy0XWU7DA5FkZNT","data":[{"name":"stdout","output_type":"stream","text":"i=0, log=2, ord=16, (13,7)\ni=1, log=6, ord=16, (7,13)\ni=2, log=10, ord=16, (24,13)\ni=3, log=14, ord=16, (18,7)\ni=4, log=18, ord=16, (18,-7)\ni=5, log=22, ord=16, (24,-13)\ni=6, log=26, ord=16, (7,-13)\ni=7, log=30, ord=16, (13,-7)\n"}],"key":"meZ5G3lbmm"}],"key":"TUJw4MgGOh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Circle FFT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LvweATldPo"}],"identifier":"circle-fft","label":"Circle FFT","html_id":"circle-fft","implicit":true,"key":"QM8TH2U6YF"}],"key":"lNOgLrnfLS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To apply circle fft, let’s generate a random polynomial’s evaluation based on D_twin_coset_4_1 (or any other twin coset you prefer).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aLWkTpBxGg"}],"key":"dSeWPvbI3e"}],"key":"IR1bnrm9o8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f = {}\nfrom random import randint\n\nfor t in D_twin_coset_4_1:\n    f[t] = C31(randint(0, 100))\n\nf","key":"DRlL7boY2K"},{"type":"output","id":"EBpSI9mcO2d4m7QAYuvvX","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"{11*i + 2: 29,\n 10*i + 5: 30,\n 2*i + 20: 10,\n 5*i + 21: 5,\n 20*i + 29: 8,\n 21*i + 26: 21,\n 29*i + 11: 16,\n 26*i + 10: 18,\n 20*i + 2: 30,\n 5*i + 10: 2,\n 2*i + 11: 23,\n 10*i + 26: 5,\n 11*i + 29: 22,\n 26*i + 21: 9,\n 29*i + 20: 28,\n 21*i + 5: 16}","content_type":"text/plain"}}}],"key":"qgRFFtqQMJ"}],"key":"Y3aGwDUsy9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z9LfeH0BmV"},{"type":"inlineCode","value":"pi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IKipOA7UmS"},{"type":"text","value":" mapping applying to point’s x coordinate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"USIBBl82xg"}],"key":"Q54qPqDMQD"}],"key":"WZxnRuHBsR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def pi(t):\n    # x^2 - y^2 == 2 * x^2 - 1 (x^2 + y^2 = 1)\n    return C31(2 * t^2 - 1)","key":"djWrtQrg5Y"},{"type":"output","id":"57ZZzGN-kriuis9szpxmL","data":[],"key":"A7lvsjY4Pz"}],"key":"yX8V0wsJbZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the first step of ifft, we try to eliminate y coordinate to simplifier our computations in later steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SJeTXfTvfo"}],"key":"HnGEfciVW5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We extract y from the polynomial by dividing polynomial in to 2 parts, f0 and f1, which correspond to the equation f[t] == f0[x] + y * f1[x].","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b6CZZHRcZ3"}],"key":"q2RW6sDrDR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"t is a group element, x and y are the x and y coordinate of t respectively.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WvMbbZ8VkA"}],"key":"G8ABrpiWor"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"So that f0 and f1 are only functions of x coordinate.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dOOPS9W7OO"}],"key":"jS7Ex2lbvL"}],"key":"ETV6sGJMKo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def ifft_first_step(f):\n    f0 = {}\n    f1 = {}\n    for t in f:\n        x, y = t\n\n        f0[x] = (f[t] + f[group_inv(t)]) / C31(2)\n        f1[x] = (f[t] - f[group_inv(t)]) / (C31(2) * y)\n\n        # Check that f is divided into 2 parts correctly\n        assert f[t] == f0[x] + y * f1[x]\n\n        # print(\"{}: {} = {} + {} * {}\".format(t, f[t], f0[x], f1[x], y))\n\n    return f0, f1","key":"ymUEiEep7O"},{"type":"output","id":"96QuUql5jJtmqGbEcmKx0","data":[],"key":"E9PsnGOUjT"}],"key":"OYBXIFtre0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In normal steps, we deal with the polynomial exactly the same as the classical polynomial ifft, deeming the polynomial as a univariate polynomial, except that x is applied by the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZAPZoD3kxM"},{"type":"inlineCode","value":"pi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Iuu1SfmBHa"},{"type":"text","value":" mapping.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ziUqmfi7a4"}],"key":"PBXQHcbD2g"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Basically, we divide the polynomial into 2 parts, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NlY4wAUaEA"},{"type":"inlineMath","value":"f_0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"X2RZauRqEH"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZYjCCmCstP"},{"type":"inlineMath","value":"f_1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tI4v8kXqBV"},{"type":"text","value":", which correspond to the equation:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HORX4Wk7ee"}],"key":"IPWDsx6f9h"},{"type":"math","value":"f[x] = f_0[x] + x * f_1[x]","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>x</mi><mo>∗</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[x] = f_0[x] + x * f_1[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span></span>","enumerator":"8","key":"EBsKUUaaQr"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Thus","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kbSuI8gre9"}],"key":"DWaqUT9yIP"},{"type":"math","value":"f_0[x] = \\frac{f[x] + f[-x]}{2}","position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>f</mi><mo stretchy=\"false\">[</mo><mo>−</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><mn>2</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">f_0[x] = \\frac{f[x] + f[-x]}{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"9","key":"KCe3c9s9QB"},{"type":"math","value":"f_1[x] = \\frac{f[x] - f[-x]}{2x}","position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>−</mo><mi>f</mi><mo stretchy=\"false\">[</mo><mo>−</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><mrow><mn>2</mn><mi>x</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">f_1[x] = \\frac{f[x] - f[-x]}{2x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"10","key":"vdpuKwEWhP"}],"key":"BHgOBkQ4hO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def ifft_normal_step(f):\n\n    if len(f) == 1:\n        res = []\n        for x in f:\n            res.append(f[x])\n        return res\n\n    f0 = {}\n    f1 = {}\n\n    for x in f:\n        assert x != 0, \"f should be on coset\"\n        f0[pi(x)] = (f[x] + f[-x]) / C31(2)\n        f1[pi(x)] = (f[x] - f[-x]) / (C31(2) * x)\n\n        # Check that f is divided into 2 parts correctly\n        assert f[x] == f0[pi(x)] + x * f1[pi(x)]\n\n    return ifft_normal_step(f0) + ifft_normal_step(f1)","key":"uUusIAac3c"},{"type":"output","id":"d3H-qjU5yIQxq7VxunxgR","data":[],"key":"afyNUbir1l"}],"key":"yonHJVusog"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have ifft_first_step and ifft_normal_step, we can define the ifft function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ois1dubJNG"}],"key":"A3DuBzXK3O"}],"key":"v3FRBiV4mo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def ifft(f):\n    f0, f1 = ifft_first_step(f)\n    f0 = ifft_normal_step(f0)\n    f1 = ifft_normal_step(f1)\n\n    return f0 + f1","key":"waIuapwN6T"},{"type":"output","id":"02sOYarS2Vq3spEZQ5GGV","data":[],"key":"ZpPjcZeRUm"}],"key":"ryestrdOMT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Apply ifft to our random polynomial and see what we get.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uJCn2Qo8dO"}],"key":"NEsSTzMm4P"}],"key":"THuU2soWg9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"coeffs = ifft(f)\ncoeffs","key":"oRO3ExgEo4"},{"type":"output","id":"BCrwimhbvOs7kRakgdola","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"[17, 30, 17, 3, 4, 15, 16, 20, 1, 6, 24, 2, 12, 20, 9, 30]","content_type":"text/plain"}}}],"key":"Dahtb9lWyy"}],"key":"YKY3rIkWgM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we try to define the fft function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HaULgkvV01"}],"key":"WWSr4cP8P3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before that, we define ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wPnJPW7t6o"},{"type":"inlineCode","value":"pie_group","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ln0Ip8KpBv"},{"type":"text","value":" function to generate next domain of a domain, which is equivalent to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RlxZsVoOCp"},{"type":"inlineCode","value":"sq","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"onQEfOdTzo"},{"type":"text","value":" function in the x dimension (you can check that by focusing on the x coordinate in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kiGhAogUqC"},{"type":"inlineCode","value":"sq","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xwttiTdIeY"},{"type":"text","value":" operation).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lVftOnXcmu"}],"key":"V4T2zJXdyu"}],"key":"hQyoceI3tX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def pie_group(D):\n    D_new = []\n    for x in D:\n        x_new = pi(x)\n        if x_new not in D_new:\n            D_new.append(x_new)\n\n    # Check that the new domain is exactly half size of the old domain\n    assert len(D_new) * 2 == len(D), \"len(D_new) * 2 != len(D), {} * 2 != {}, D_new={}, D={}\".format(len(D_new), len(D), D_new, D)\n    \n    return D_new","key":"Nif25zDJYy"},{"type":"output","id":"jIzwWIQZuqTAJTSB5uTLB","data":[],"key":"h7yFZKBet6"}],"key":"qpEgd4HlMh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the first step of fft, which contains the same logic as ifft_first_step.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fAzTma9VdF"}],"key":"hWHLjKeK6d"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The basis of coefficients is like:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YMLAV7Z3hj"}],"key":"NgR6DkrCJF"},{"type":"math","value":"1, v_1(x), v_2(x), v_1(x)v_2(x), y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\quad (N = 8) \\tag{1}","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mo stretchy=\"false\">(</mo><mi>N</mi><mo>=</mo><mn>8</mn><mo stretchy=\"false\">)</mo></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">1, v_1(x), v_2(x), v_1(x)v_2(x), y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\quad (N = 8) \\tag{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">8</span><span class=\"mclose\">)</span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">1</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"11","key":"EBPYgFgPnv"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"where","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"pA5mW7vKyR"}],"key":"Kfge5eTfn0"},{"type":"math","value":"v_1(x) = x, v_2(x) = 2x^2-1, v_3(x) = 2(2x^2-1)^2-1, ...","position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mo stretchy=\"false\">(</mo><mn>2</mn><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">v_1(x) = x, v_2(x) = 2x^2-1, v_3(x) = 2(2x^2-1)^2-1, ...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span></span></span></span></span>","enumerator":"12","key":"ASscykEjuo"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"So to divide the polynomial into 2 parts, we just need to divide the coefficients into 2 parts, it’s basis are also divided into 2 parts as follows:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Rp5E3A9RJ9"}],"key":"dt2OT4huEk"},{"type":"math","value":"1, v_1(x), v_2(x), v_1(x)v_2(x) \\tag{2}","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">1, v_1(x), v_2(x), v_1(x)v_2(x) \\tag{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">2</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"13","key":"hUY7TyeowC"},{"type":"math","value":"y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\tag{3}","position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable width=\"100%\"><mtr><mtd width=\"50%\"></mtd><mtd><mrow><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mtd><mtd width=\"50%\"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\tag{3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span><span class=\"tag\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord\"><span class=\"mord\">3</span></span><span class=\"mord\">)</span></span></span></span></span></span>","enumerator":"14","key":"q7iD78Z9wX"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Notice that basis (2) is bit reversed order compared to normal basis, and basis (3) is like basis (2) but multiplied by y.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"P7RLG5AvKe"}],"key":"EG0RQH0gaz"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"To eliminate y in normal steps’ computation, we just consider basis of the second part of coefficients (which is actually basis (3)) as same as basis (2), and supply the y at the end of fft.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"EhkhGx70D9"}],"key":"cAdzyMMN0b"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"First, we define the first step of fft.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"VTMm0wHyOb"}],"key":"abIxgsYtO6"}],"key":"obT0RYcPEH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def fft_first_step(f, D):\n    # Check that the polynomial and the domain have the same length\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n\n    # divide the polynomial into 2 parts\n    len_f = len(f)\n    f0 = f[:len_f//2]\n    f1 = f[len_f//2:]\n\n    # halve the domain by simply removing the y coordinate\n    D_new = []\n    for t in D:\n        x, _ = t\n        if x not in D_new:\n            D_new.append(x)\n\n    # Check that the new domain is exactly half size of the old domain\n    assert len(D_new) * 2 == len(D), \"len(D_new) * 2 != len(D), {} * 2 != {}, D_new={}, D={}\".format(len(D_new), len(D), D_new, D)\n\n    return f0, f1, D_new","key":"O47emmCKdB"},{"type":"output","id":"-6lVaJHjgIQVtOxRAit26","data":[],"key":"qr4Cfil2On"}],"key":"trWUSXzLdy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In normal steps, we deal with the polynomial exactly the same as the classical polynomial fft, deeming the polynomial as a univariate polynomial, except that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uzOtss6Euz"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"vqIazaYNpT"},{"type":"text","value":" is applied by the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fE3paRGU4t"},{"type":"inlineCode","value":"pi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DzOAvaQ1xm"},{"type":"text","value":" mapping.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WiF5SK91rE"}],"key":"b3HhbpDayp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Divide the polynomial into 2 parts, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Bwbiexis65"},{"type":"inlineMath","value":"f_0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JZ5BMG9cNm"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xfSM2Ce6qa"},{"type":"inlineMath","value":"f_1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RwxQv1NlHl"},{"type":"text","value":", which correspond to the equation:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IDWU7dPtEN"}],"key":"R65zDRmarw"},{"type":"math","value":"f[x] = f_0[x] + x * f_1[x]","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>x</mi><mo>∗</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[x] = f_0[x] + x * f_1[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span></span>","enumerator":"15","key":"htpjf1cG38"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Merge ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LppO7NtAdP"},{"type":"inlineMath","value":"f_0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ybjns9t936"},{"type":"text","value":" and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"iep57Rm3Ez"},{"type":"inlineMath","value":"f_1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VQd3t2krOq"},{"type":"text","value":" using ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zKnZLn93UI"},{"type":"inlineMath","value":"x","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"yOIdR9UBuD"},{"type":"text","value":" from the domain, which corresponds to the equation above too.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UkMgq8hJqy"}],"key":"Q79inTtTJB"}],"key":"b1bGVQG77l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def fft_normal_step(f, D):\n\n    if len(f) == 1:\n        return {D[0]: f[0]}\n    \n    next_domain = pie_group(D)\n\n    # Check that the new domain is exactly half size of the old domain\n    assert len(next_domain) * 2 == len(D), \"len(next_domain) * 2 != len(D), {} * 2 != {}, next_domain={}, D={}\".format(len(next_domain), len(D), next_domain, D)\n    # Check that the polynomial and the domain have the same length\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n\n    f0 = fft_normal_step(f[:len(f)//2], next_domain)\n    f1 = fft_normal_step(f[len(f)//2:], next_domain)\n\n    f_new = {}\n    for x in D:\n        f_new[x] = f0[pi(x)] + f1[pi(x)] * x\n\n    # Check that f is divided into 2 parts correctly\n    for x in D:\n        if x != 0:\n            assert f0[pi(x)] == (f_new[x] + f_new[-x]) / C31(2), \"f0[pi(x)] = {}\".format(f0[pi(x)])\n            assert f1[pi(x)] == (f_new[x] - f_new[-x]) / (C31(2) * x), \"f1[pi(x)] = {}\".format(f1[pi(x)])\n        else:\n            assert f0[pi(x)] == f_new[x], \"f0[pi(x)] = {}\".format(f0[pi(x)])\n\n    # Check that the polynomial and the domain have the same length\n    assert len(f) == len(f_new), \"len(f) != len(f_new), {} != {}, f={}, f_new={}, D={}\".format(len(f), len(f_new), f, f_new, D)\n\n    # Check that ifft and fft are correct inverse operations\n    assert ifft_normal_step(f_new) == f, \"ifft(f_new) != f, {} != {}\".format(ifft_normal_step(f_new), f)\n        \n    return f_new","key":"ibgTPHD2Kf"},{"type":"output","id":"1QvD5QiFwfJYcG9_eLxgf","data":[],"key":"SXOG8TLktG"}],"key":"dB0UPYOHqh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We have fft_first_step and fft_normal_step, we can define the fft function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G9u9nw1Ni3"}],"key":"FMXkep124x"}],"key":"KYhizRuWRK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def fft(f, D):\n\n    # Check that the polynomial and the domain have the same length\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n\n    D_copy = D[:]\n    f0, f1, D = fft_first_step(f, D)\n\n    # Check that the polynomial and the domain have the same length\n    assert len(f0) == len(D), \"len(f0) != len(D), {} != {}, f0={}, D={}\".format(len(f0), len(D), f0, D)\n    assert len(f1) == len(D), \"len(f1) != len(D), {} != {}, f1={}, D={}\".format(len(f1), len(D), f1, D)\n\n    f0 = fft_normal_step(f0, D)\n    f1 = fft_normal_step(f1, D)\n\n    f = {}\n    # supply y to the polynomial\n    for t in D_copy:\n        x, y = t\n        f[t] = f0[x] + f1[x] * y\n\n    return f\n","key":"FwwWLRrJ5w"},{"type":"output","id":"3yXcDVjLbATQPrWPrlpda","data":[],"key":"qeeC2hFCR7"}],"key":"YDluyz9FXh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check that ifft and fft are correct inverse operations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XapJgztF39"}],"key":"cpCWPpCyUy"}],"key":"hg7tB7T4FI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f_prime = fft(coeffs, D_twin_coset_4_1)\n\nfor t, s in zip(f, f_prime):\n    assert t == s\n\nfor t in f:\n    print(\"f[{}]={}, f_prime[{}]={}\".format(t, f[t], t, f_prime[t]))\n    assert f[t] == f_prime[t], \"f[{}] != f_prime[{}], {} != {}\".format(t, t, f[t], f_prime[t])","key":"y81MDAVOFW"},{"type":"output","id":"fvKL3ktdI7H9a0LBJ0a1U","data":[{"name":"stdout","output_type":"stream","text":"f[11*i + 2]=29, f_prime[11*i + 2]=29\nf[10*i + 5]=30, f_prime[10*i + 5]=30\nf[2*i + 20]=10, f_prime[2*i + 20]=10\nf[5*i + 21]=5, f_prime[5*i + 21]=5\nf[20*i + 29]=8, f_prime[20*i + 29]=8\nf[21*i + 26]=21, f_prime[21*i + 26]=21\nf[29*i + 11]=16, f_prime[29*i + 11]=16\nf[26*i + 10]=18, f_prime[26*i + 10]=18\nf[20*i + 2]=30, f_prime[20*i + 2]=30\nf[5*i + 10]=2, f_prime[5*i + 10]=2\nf[2*i + 11]=23, f_prime[2*i + 11]=23\nf[10*i + 26]=5, f_prime[10*i + 26]=5\nf[11*i + 29]=22, f_prime[11*i + 29]=22\nf[26*i + 21]=9, f_prime[26*i + 21]=9\nf[29*i + 20]=28, f_prime[29*i + 20]=28\nf[21*i + 5]=16, f_prime[21*i + 5]=16\n"}],"key":"QV9F1jXKau"}],"key":"qVsVRjxTwL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Circle FRI","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rPXRbfhOy1"}],"identifier":"circle-fri","label":"Circle FRI","html_id":"circle-fri","implicit":true,"key":"yCY2ltd6aK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Basis:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rn16A5z459"}],"key":"XRxvNz4WyM"},{"type":"math","value":"1, v_1(x), v_2(x), v_1(x)v_2(x), y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\quad (N = 8)","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><msub><mi>v</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mo stretchy=\"false\">(</mo><mi>N</mi><mo>=</mo><mn>8</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">1, v_1(x), v_2(x), v_1(x)v_2(x), y, yv_1(x), yv_2(x), yv_1(x)v_2(x) \\quad (N = 8)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">8</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"16","key":"FjyWIRfPTU"}],"key":"W2beE3pbfr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Inputs:\n#   f is the polynomial to be folded\n#   D is the domain of f\n#   r is the random number for random linear combination\n# Outputs:\n#   The first return value is the folded polynomial\n#   The second return value is the new domain\ndef fold(f, D, r, debug=False):\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n\n    # divide\n    N = len(f)\n    # left is the first half of f, of x from 1 to g^(N/2)\n    left = f[:N//2]\n    # right is the second half of f, of x from g^(N-1) to g^(N/2), which corresponds to minus x in left\n    right = f[:N//2-1:-1]\n    assert len(left) == len(right), \"len(left) != len(right), {} != {}, left={}, right={}\".format(len(left), len(right), left, right)\n\n    for i, x in enumerate(D[:N//2]):\n        # f == f0 + x * f1\n        f0 = (left[i] + right[i]) / C31(2)\n        f1 = (left[i] - right[i]) / (C31(2) * x)\n        # f[:N//2] stores the folded polynomial\n        if debug: print(f\"f[{i}] = {f[i]} = ({left[i]} + {right[i]})/2 + {r} * ({left[i]} - {right[i]})/(2 * {x})\")\n        f[i] = f0 + r * f1\n        # if debug: print(f\"{f[i]} = ({left[i]} + {right[i]})/2 + {r} * ({left[i]} - {right[i]})/(2 * {x})\")\n        # reuse f[N//2:] to store new domain\n        f[N//2 + i] = 2 * x^2 - 1\n\n    # return the folded polynomial and the new domain\n    return f[:N//2], f[N//2:]","key":"CsMq9FVZWZ"},{"type":"output","id":"5J34rJuWBaGzFOr4KXVy-","data":[],"key":"Z37Fanl5jk"}],"key":"nvrTX06271"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"from utils import log_2\nfrom merlin.merlin_transcript import MerlinTranscript\nfrom merkle import MerkleTree\n\ndef fri(f, D, degree, query_num, transcript, debug=False):\n\n    assert len(f) == len(D), \"len(f) != len(D), {} != {}, f={}, D={}\".format(len(f), len(D), f, D)\n    assert isinstance(transcript, MerlinTranscript)\n\n    if debug: print(f\"f={f}, D={D}\")\n\n    # first tree\n    first_tree = MerkleTree(f)\n    first_oracle = f\n\n    # first random number\n    transcript.append_message(b'first_tree', bytes(first_tree.root, 'ascii'))\n    r = int.from_bytes(transcript.challenge_bytes(b'r', int(4)), 'big')\n\n    # first step (J mapping)\n    # for f in natural order, we just divide f into 2 parts from the middle\n    N = len(f)\n    assert N % 2 == 0, \"N must be even, N={}\".format(N)\n\n    left = f[:N//2]\n    right = f[:N//2-1:-1]\n    assert len(left) == len(right), \"len(left) != len(right), {} != {}, left={}, right={}\".format(len(left), len(right), left, right)\n    f = [None for _ in range(N//2)]\n    for i, (_, y) in enumerate(D[:N//2]):\n        f0 = (left[i] + right[i]) / C31(2)\n        f1 = (left[i] - right[i]) / (C31(2) * y)\n        f[i] = f0 + r * f1\n        if debug: print(f\"f[{i}] = {f[i]} = ({left[i]} + {right[i]})/2 + {r} * ({left[i]} - {right[i]})/(2 * {y})\")\n\n    print(f\"f={f}\")\n\n    D = [x for x, _ in D[:N//2]]\n\n    # fold\n    trees = [MerkleTree(f)]\n    oracles = [f[:]]\n    # log_2(degree) - 1 because we have already done the first step\n    for i in range(log_2(degree) - 1):\n        # random number\n        transcript.append_message(b'tree', bytes(trees[-1].root, 'ascii'))\n\n        r = int.from_bytes(transcript.challenge_bytes(b'r', int(4)), 'big')\n        f, D = fold(f, D, r, debug)\n\n        if debug: print(f\"f={f}, D={D}\")\n\n        # merkle tree\n        trees.append(MerkleTree(f))\n        oracles.append(f[:])\n\n    # query paths\n    max_size = N\n    get_q = lambda transcript: int.from_bytes(transcript.challenge_bytes(b'query', int(4)), 'big') % max_size\n    queries = [get_q(transcript) for _ in range(query_num)]\n\n    query_paths = []\n    for q in queries:\n        max_size = N\n        cur_path = []\n        indices = []\n        x0 = q\n        x1 = max_size - q - 1\n        if x1 < x0:\n            x0, x1 = x1, x0\n\n        if debug: print(f\"max_size={max_size}\")\n        if debug: print(f\"q={q}\")\n        if debug: print(f\"x0={x0}, x1={x1}\")\n        \n        cur_path.append((first_oracle[x0], first_oracle[x1]))\n        indices.append(x0)\n        q = x0\n        max_size >>= 1\n\n        for oracle in oracles:\n            x0 = q\n            x1 = max_size - q - 1\n            if x1 < x0:\n                x0, x1 = x1, x0\n\n            if debug: print(f\"q={q}\")\n            if debug: print(f\"x0={x0}, x1={x1}\")\n            \n            cur_path.append((oracle[x0], oracle[x1]))\n            indices.append(x0)\n            q = x0\n            max_size >>= 1\n\n        query_paths.append((cur_path, indices))\n\n    # merkle paths\n    merkle_paths = []\n    for _, indices in query_paths:\n        cur_query_paths = []\n        for i, idx in enumerate(indices):\n            if i == 0:\n                if debug: print(f\"i = {i}, idx = {idx}, first_oracle[idx] = {first_oracle[idx]}\")\n                cur_query_paths.append(first_tree.get_authentication_path(idx))\n            else:\n                cur_tree = trees[i - 1]\n                if debug: print(f\"i = {i}, idx = {idx}, oracles[i-1][idx] = {oracles[i-1][idx]}\")\n                cur_query_paths.append(cur_tree.get_authentication_path(idx))\n        merkle_paths.append(cur_query_paths)\n\n    return {\n        'query_paths': query_paths,\n        'merkle_paths': merkle_paths,\n        'first_tree': first_tree.root,\n        'intermediate_trees': [tree.root for tree in trees],\n        'degree_bound': degree,\n        'final_value': f[0],\n    }","key":"mOT7zW5p35"},{"type":"output","id":"uCPeFn1pPlvGCtFCsY2oh","data":[],"key":"twmsDgCiQw"}],"key":"KioW1cQE2q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"from merkle import verify_decommitment\n\ndef defri(fri_proof, degree_bound, T, query_num, transcript, debug=False):\n\n    assert degree_bound >= fri_proof['degree_bound']\n    degree_bound = fri_proof['degree_bound']\n\n    assert isinstance(transcript, MerlinTranscript)\n\n    first_tree = fri_proof['first_tree']\n    intermediate_trees = fri_proof['intermediate_trees']\n\n    transcript.append_message(b'first_tree', bytes(first_tree, 'ascii'))\n    r = int.from_bytes(transcript.challenge_bytes(b'r', int(4)), 'big')\n\n    fold_challenges = [r]\n    for i in range(log_2(int(degree_bound)) - 1):\n        transcript.append_message(b'tree', bytes(intermediate_trees[i], 'ascii'))\n        r = int.from_bytes(transcript.challenge_bytes(b'r', int(4)), 'big')\n        fold_challenges.append(r)\n\n    get_q = lambda transcript: int.from_bytes(transcript.challenge_bytes(b'query', int(4)), 'big') % degree_bound\n    queries = [get_q(transcript) for _ in range(query_num)]\n\n    for q, (cur_path, _), mps in zip(queries, fri_proof['query_paths'], fri_proof['merkle_paths']):\n        num_vars = degree_bound\n        for i, mp in enumerate(mps):\n\n            assert num_vars > 0, \"num_vars must be positive, num_vars={}\".format(num_vars)\n\n            x0 = q\n            x1 = num_vars - q - 1\n            if x1 < x0:\n                x0, x1 = x1, x0\n            \n            if debug: print(f\"num_vars={num_vars}\")\n            if debug: print(f\"q={q}\")\n            if debug: print(f\"x0={x0}, x1={x1}\")\n\n            code_left, code_right = F31(cur_path[i][0]), F31(cur_path[i][1])\n\n            table = T[i]\n            if debug: print(f\"i = {i}, table={table}\")\n            if i != len(mps) - 1:\n                alpha = fold_challenges[i]\n                f_code_folded = cur_path[i + 1][0 if x0 < num_vars / 4 else 1]\n                assert f_code_folded == (code_left + code_right)/2 + alpha * (code_left - code_right)/(2*table[x0]), f\"{f_code_folded} != ({code_left} + {code_right})/2 + {alpha} * ({code_left} - {code_right})/(2*{table[x0]})\"\n            else:\n                assert fri_proof['final_value'] == code_left, f\"{fri_proof['final_value']} != {code_left}\"\n\n            if i == 0:\n                assert verify_decommitment(x0, code_left, mp, fri_proof['first_tree']), f\"verify_decommitment(x0={x0}, code_left={code_left}, mp={mp}, fri_proof['first_tree']={fri_proof['first_tree']})\"\n            else:\n                assert verify_decommitment(x0, code_left, mp, fri_proof['intermediate_trees'][i - 1]), f\"verify_decommitment(x0={x0}, code_left={code_left}, mp={mp}, fri_proof['intermediate_trees'][i - 1]={fri_proof['intermediate_trees'][i - 1]})\"\n\n            num_vars >>= 1\n            q = x0","key":"szkKbSmDUZ"},{"type":"output","id":"g9FT4KxSBQ61qso-p8raP","data":[],"key":"c2Fvmqw97q"}],"key":"gIxj435o8j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f = [randint(0, 30) for _ in range(len(D_standard_coset_4))]\nquery_num = 4\nfri_proof = fri(f, D_standard_coset_4, len(D_standard_coset_4), query_num, MerlinTranscript(b'FRI'), debug=True)\nprint(\"---------------- fri ----------------\")\nT = []\ndomain = D_standard_coset_4[:]\nfor i in range(log_2(len(domain)) + 1):\n    if i != 0:\n        T.append([x for x, _ in domain])\n        domain = sq(domain)[:len(domain)//2]\n    else:\n        T.append([y for _, y in domain])\n        domain = domain[:len(domain)//2]\n\ndefri(fri_proof, len(D_standard_coset_4), T, query_num, MerlinTranscript(b'FRI'), debug=True)","key":"ATcNwxhTMq"},{"type":"output","id":"vbtI__9llx71iTn7Hl7ZS","data":[{"name":"stdout","output_type":"stream","text":"f=[24, 1, 6, 10, 3, 8, 29, 27, 25, 23, 3, 3, 13, 10, 24, 8], D=[5*i + 10, 11*i + 2, 2*i + 11, 10*i + 5, 10*i + 26, 2*i + 20, 11*i + 29, 5*i + 21, 26*i + 21, 20*i + 29, 29*i + 20, 21*i + 26, 21*i + 5, 29*i + 11, 20*i + 2, 26*i + 10]\nf[0] = 1 = (24 + 8)/2 + 2944556307 * (24 - 8)/(2 * 5)\nf[1] = 26 = (1 + 24)/2 + 2944556307 * (1 - 24)/(2 * 11)\nf[2] = 29 = (6 + 10)/2 + 2944556307 * (6 - 10)/(2 * 2)\nf[3] = 10 = (10 + 13)/2 + 2944556307 * (10 - 13)/(2 * 10)\nf[4] = 3 = (3 + 3)/2 + 2944556307 * (3 - 3)/(2 * 10)\nf[5] = 18 = (8 + 3)/2 + 2944556307 * (8 - 3)/(2 * 2)\nf[6] = 9 = (29 + 23)/2 + 2944556307 * (29 - 23)/(2 * 11)\nf[7] = 28 = (27 + 25)/2 + 2944556307 * (27 - 25)/(2 * 5)\nf=[1, 26, 29, 10, 3, 18, 9, 28]\nf[0] = 1 = (1 + 28)/2 + 144160416 * (1 - 28)/(2 * 10)\nf[1] = 26 = (26 + 9)/2 + 144160416 * (26 - 9)/(2 * 2)\nf[2] = 29 = (29 + 18)/2 + 144160416 * (29 - 18)/(2 * 11)\nf[3] = 10 = (10 + 3)/2 + 144160416 * (10 - 3)/(2 * 5)\nf=[30, 2, 8, 22], D=[13, 7, 24, 18]\nf[0] = 30 = (30 + 22)/2 + 3212835317 * (30 - 22)/(2 * 13)\nf[1] = 2 = (2 + 8)/2 + 3212835317 * (2 - 8)/(2 * 7)\nf=[23, 28], D=[27, 4]\nf[0] = 23 = (23 + 28)/2 + 133754179 * (23 - 28)/(2 * 27)\nf=[1], D=[0]\nmax_size=16\nq=2\nx0=2, x1=13\nq=2\nx0=2, x1=5\nq=2\nx0=1, x1=2\nq=1\nx0=0, x1=1\nq=0\nx0=0, x1=0\nmax_size=16\nq=0\nx0=0, x1=15\nq=0\nx0=0, x1=7\nq=0\nx0=0, x1=3\nq=0\nx0=0, x1=1\nq=0\nx0=0, x1=0\nmax_size=16\nq=7\nx0=7, x1=8\nq=7\nx0=0, x1=7\nq=0\nx0=0, x1=3\nq=0\nx0=0, x1=1\nq=0\nx0=0, x1=0\nmax_size=16\nq=10\nx0=5, x1=10\nq=5\nx0=2, x1=5\nq=2\nx0=1, x1=2\nq=1\nx0=0, x1=1\nq=0\nx0=0, x1=0\ni = 0, idx = 2, first_oracle[idx] = 6\ni = 1, idx = 2, oracles[i-1][idx] = 29\ni = 2, idx = 1, oracles[i-1][idx] = 2\ni = 3, idx = 0, oracles[i-1][idx] = 23\ni = 4, idx = 0, oracles[i-1][idx] = 1\ni = 0, idx = 0, first_oracle[idx] = 24\ni = 1, idx = 0, oracles[i-1][idx] = 1\ni = 2, idx = 0, oracles[i-1][idx] = 30\ni = 3, idx = 0, oracles[i-1][idx] = 23\ni = 4, idx = 0, oracles[i-1][idx] = 1\ni = 0, idx = 7, first_oracle[idx] = 27\ni = 1, idx = 0, oracles[i-1][idx] = 1\ni = 2, idx = 0, oracles[i-1][idx] = 30\ni = 3, idx = 0, oracles[i-1][idx] = 23\ni = 4, idx = 0, oracles[i-1][idx] = 1\ni = 0, idx = 5, first_oracle[idx] = 8\ni = 1, idx = 2, oracles[i-1][idx] = 29\ni = 2, idx = 1, oracles[i-1][idx] = 2\ni = 3, idx = 0, oracles[i-1][idx] = 23\ni = 4, idx = 0, oracles[i-1][idx] = 1\n---------------- fri ----------------\nnum_vars=16\nq=2\nx0=2, x1=13\ni = 0, table=[5, 11, 2, 10, 10, 2, 11, 5, 26, 20, 29, 21, 21, 29, 20, 26]\nnum_vars=8\nq=2\nx0=2, x1=5\ni = 1, table=[10, 2, 11, 5, 26, 20, 29, 21]\nnum_vars=4\nq=2\nx0=1, x1=2\ni = 2, table=[13, 7, 24, 18]\nnum_vars=2\nq=1\nx0=0, x1=1\ni = 3, table=[27, 4]\nnum_vars=1\nq=0\nx0=0, x1=0\ni = 4, table=[0]\nnum_vars=16\nq=0\nx0=0, x1=15\ni = 0, table=[5, 11, 2, 10, 10, 2, 11, 5, 26, 20, 29, 21, 21, 29, 20, 26]\nnum_vars=8\nq=0\nx0=0, x1=7\ni = 1, table=[10, 2, 11, 5, 26, 20, 29, 21]\nnum_vars=4\nq=0\nx0=0, x1=3\ni = 2, table=[13, 7, 24, 18]\nnum_vars=2\nq=0\nx0=0, x1=1\ni = 3, table=[27, 4]\nnum_vars=1\nq=0\nx0=0, x1=0\ni = 4, table=[0]\nnum_vars=16\nq=7\nx0=7, x1=8\ni = 0, table=[5, 11, 2, 10, 10, 2, 11, 5, 26, 20, 29, 21, 21, 29, 20, 26]\nnum_vars=8\nq=7\nx0=0, x1=7\ni = 1, table=[10, 2, 11, 5, 26, 20, 29, 21]\nnum_vars=4\nq=0\nx0=0, x1=3\ni = 2, table=[13, 7, 24, 18]\nnum_vars=2\nq=0\nx0=0, x1=1\ni = 3, table=[27, 4]\nnum_vars=1\nq=0\nx0=0, x1=0\ni = 4, table=[0]\nnum_vars=16\nq=10\nx0=5, x1=10\ni = 0, table=[5, 11, 2, 10, 10, 2, 11, 5, 26, 20, 29, 21, 21, 29, 20, 26]\nnum_vars=8\nq=5\nx0=2, x1=5\ni = 1, table=[10, 2, 11, 5, 26, 20, 29, 21]\nnum_vars=4\nq=2\nx0=1, x1=2\ni = 2, table=[13, 7, 24, 18]\nnum_vars=2\nq=1\nx0=0, x1=1\ni = 3, table=[27, 4]\nnum_vars=1\nq=0\nx0=0, x1=0\ni = 4, table=[0]\n"}],"key":"TbLWT9z5qo"}],"key":"wH9RVGsq1g"}],"key":"ZimZ4t0HzN"},"references":{"cite":{"order":[],"data":{}}}}