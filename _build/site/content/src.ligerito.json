{"version":2,"kind":"Notebook","sha256":"33905327f2ab9bd5485ca38bb13e89dea7de1a762a42a467588b8c83f467f1e1","slug":"src.ligerito","location":"/src/ligerito.ipynb","dependencies":[],"frontmatter":{"title":"Ligerito protocol","content_includes_title":true,"kernelspec":{"name":"SageMath-10.4","display_name":"SageMath 10.4","language":"sage"},"github":"https://github.com/executablebooks/jupyter-book","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/executablebooks/jupyter-book/blob/main/src/ligerito.ipynb","exports":[{"format":"ipynb","filename":"ligerito.ipynb","url":"/ligerito-4c37de4bdb71bd0a33ff9978217b9ee1.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"F193.<a> = GF(193) # 193 = 64 * 3 + 1\nR193.<X> = F193[]\nR193\nFp=F193\n\nfrom utils import log_2, next_power_of_two, is_power_of_two, bits_le_with_width, inner_product, reverse_bits\n\ndef nth_root_of_unity(n):\n    k = log_2(n)\n    assert k <= 6, \"k is greater than 6\"\n    \n    return Fp(5)**(3*2**(6-k))\n\nFp.nth_root_of_unity = nth_root_of_unity\nFp.TWO_ADICITY = 6\nFp.MULTIPLICATIVE_GENERATOR = Fp.primitive_element()\nFp.ROOT_OF_UNITY = Fp(5)**3\n\ndef neg_one():\n    return Fp(-1)\nFp.neg_one = neg_one\n\nR_2.<X0, X1, X2, X3, X4, X5, X6, X7, X8, X9, Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, A0, A1, A2, B0, B1, B2> = Fp[]; R_2","key":"NmYInN5IV6"},{"type":"output","id":"3a0dWB-FxO31t4fP2KfAV","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"Multivariate Polynomial Ring in X0, X1, X2, X3, X4, X5, X6, X7, X8, X9, Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, A0, A1, A2, B0, B1, B2 over Finite Field of size 193","content_type":"text/plain"}}}],"key":"wnegqskvrR"}],"key":"CGXjy5voDZ"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"from mle2 import MLEPolynomial\nfrom unipoly2 import UniPolynomial, UniPolynomialWithFft\nfrom transcript import MerlinTranscript\nfrom merkle import MerkleTree\n\nMLEPolynomial.set_field_type(Fp)\ntranscript = MerlinTranscript(\"test\")\nUniPolynomial.set_field_type(Fp)\nUniPolynomialWithFft.set_field_type(Fp)\n","key":"WddHCGeApR"},{"type":"output","id":"Wqzx9SOe41dvGF37fTpwo","data":[],"key":"DonDFWg9DG"}],"key":"C0oYLDWIGh"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def rs_encode(f: list[Fp], coset: Fp, blowup_factor: int) -> list[Fp]:\n    n = next_power_of_two(len(f))\n    N = n * blowup_factor\n\n    omega_Nth = Fp.nth_root_of_unity(N)\n    k = log_2(N)\n    vec = f + [Fp.zero()] * (N - len(f))\n    return UniPolynomialWithFft.fft_coset_rbo(vec, coset, k, omega=omega_Nth)\n","key":"QVhdKCp79l"},{"type":"output","id":"OK-lpEygccW4ADeNdx1e7","data":[],"key":"RuEjtYeQpo"}],"key":"Jc0CQCEAIm"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def rs_generator_matrix(g, k, c):\n    assert is_power_of_two(k), \"k: %d is not a power of two\" % k\n    assert is_power_of_two(c), \"c: %d is not a power of two\" % c\n\n    n = k * c\n    w = Fp.nth_root_of_unity(n)\n    G = []\n    for i in range(n):\n        G.append([w**(i*j) for j in range(k)])\n    return G","key":"MmeGX39J87"},{"type":"output","id":"3HrKEnuYBekOOd8OlIFmY","data":[],"key":"mcr0Uu4Cgg"}],"key":"pMCMP01bjD"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"G = rs_generator_matrix(Fp(1), 8, 2)\nG[1]","key":"AcFlyDbstV"},{"type":"output","id":"wOD2gqJr5DJkmnD8UeOoR","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"[1, 64, 43, 50, 112, 27, 184, 3]","content_type":"text/plain"}}}],"key":"ZvYdsMpN0m"}],"key":"fhLs7JgqW2"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def matrix_mul_vec(G, m):\n    assert len(G[0]) == len(m), \"len(G[0]) != len(m)\"\n    return [inner_product(G[i], m, Fp(0)) for i in range(len(G))]\nmatrix_mul_vec(G, [1, 2, 3, 4, 5, 6, 7, 8])","key":"AlFch3Pqa5"},{"type":"output","id":"vjIoiUwmIsfkoTGAmPTdQ","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"[36, 176, 184, 143, 127, 167, 115, 93, 189, 113, 70, 59, 58, 51, 1, 171]","content_type":"text/plain"}}}],"key":"EX7OqHBtvm"}],"key":"QrhuZaCLri"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def matrix_transpose(M):\n    if type(M[0]) == type([]):\n        return [[M[j][i] for j in range(len(M))] for i in range(len(M[0]))]\n    elif type(M) == type([Fp(0)]):\n        return [[M[i]] for i in range(len(M))]\nmatrix_transpose([[1, 2, 3], [4, 5, 6], [7, 8, 9]]), matrix_transpose([1, 2, 3])\n","key":"d15VyyAOzi"},{"type":"output","id":"8Q7aq_iY8RgX4BDxe5sVP","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"([[1, 4, 7], [2, 5, 8], [3, 6, 9]], [[1], [2], [3]])","content_type":"text/plain"}}}],"key":"l0bM4YZ5TQ"}],"key":"qOkFRjoZ3S"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def matrix_mul_matrix(G, M):\n    m = len(G)\n    n = len(G[0])\n    k = len(M[0])\n    assert n == len(M), \"len(G[0]) != len(M[0])\"\n    A = []\n    for i in range(m):\n        A.append([inner_product(G[i], [M[l][j] for l in range(n)], Fp(0)) for j in range(k)])\n    return A\nmatrix_mul_matrix(G, matrix_transpose(G))","key":"oG7LmDdy7C"},{"type":"output","id":"hH1e5f5Ca15PoLVq39TUx","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"[[8, 98, 0, 126, 0, 89, 0, 192, 0, 3, 0, 106, 0, 69, 0, 97],\n [98, 0, 126, 0, 89, 0, 192, 0, 3, 0, 106, 0, 69, 0, 97, 8],\n [0, 126, 0, 89, 0, 192, 0, 3, 0, 106, 0, 69, 0, 97, 8, 98],\n [126, 0, 89, 0, 192, 0, 3, 0, 106, 0, 69, 0, 97, 8, 98, 0],\n [0, 89, 0, 192, 0, 3, 0, 106, 0, 69, 0, 97, 8, 98, 0, 126],\n [89, 0, 192, 0, 3, 0, 106, 0, 69, 0, 97, 8, 98, 0, 126, 0],\n [0, 192, 0, 3, 0, 106, 0, 69, 0, 97, 8, 98, 0, 126, 0, 89],\n [192, 0, 3, 0, 106, 0, 69, 0, 97, 8, 98, 0, 126, 0, 89, 0],\n [0, 3, 0, 106, 0, 69, 0, 97, 8, 98, 0, 126, 0, 89, 0, 192],\n [3, 0, 106, 0, 69, 0, 97, 8, 98, 0, 126, 0, 89, 0, 192, 0],\n [0, 106, 0, 69, 0, 97, 8, 98, 0, 126, 0, 89, 0, 192, 0, 3],\n [106, 0, 69, 0, 97, 8, 98, 0, 126, 0, 89, 0, 192, 0, 3, 0],\n [0, 69, 0, 97, 8, 98, 0, 126, 0, 89, 0, 192, 0, 3, 0, 106],\n [69, 0, 97, 8, 98, 0, 126, 0, 89, 0, 192, 0, 3, 0, 106, 0],\n [0, 97, 8, 98, 0, 126, 0, 89, 0, 192, 0, 3, 0, 106, 0, 69],\n [97, 8, 98, 0, 126, 0, 89, 0, 192, 0, 3, 0, 106, 0, 69, 0]]","content_type":"text/plain"}}}],"key":"Oq4H459Ewr"}],"key":"tVHUYXwaGK"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"# Test matrix_mul_matrix()\nmatrix_mul_matrix([[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12]], [[1, 2, 3], [5, 6, 7], [9, 10, 11]])","key":"MRpSe10XTP"},{"type":"output","id":"5aX35JZsS9js_rx4DxX3j","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"[[38, 44, 50], [83, 98, 113], [128, 152, 176], [173, 13, 46]]","content_type":"text/plain"}}}],"key":"HUqUxNwKV7"}],"key":"RWf58Dw6VS"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"# Test matrix_mul_matrix()\nmatrix_mul_matrix([[X0, X1, X2], [X3, X4, X5]], [[Y0], [Y1], [Y2]])","key":"CjBizNJf4v"},{"type":"output","id":"V5t4cAQU9I_jVmSWX79IT","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"[[X0*Y0 + X1*Y1 + X2*Y2], [X3*Y0 + X4*Y1 + X5*Y2]]","content_type":"text/plain"}}}],"key":"MR8fV5SKRQ"}],"key":"DRXGTJBiTy"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"# Test rs_encode() and matrix_mul()\n\n# rs_encode([1, 2, 3, 4, 5, 6, 7, 8], Fp(1), 8, 2) == matrix_mul(G, [1, 2, 3, 4, 5, 6, 7, 8])","key":"W12zeHzCqK"},{"type":"output","id":"HIr66FZiN7ugQXyduJsgL","data":[],"key":"SKsCq3LUz8"}],"key":"KAwOzxuyTW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ligerito protocol","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gFbnntXxOV"}],"identifier":"ligerito-protocol","label":"Ligerito protocol","html_id":"ligerito-protocol","implicit":true,"key":"NXTHmPTSqa"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"blowup factor is ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ouqxKdxBxp"},{"type":"inlineCode","value":"2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZjomDtauQ3"}],"key":"laoE9lcLMV"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"number of queries is ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AtnYGDx4Gs"},{"type":"inlineCode","value":"2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LcnlAgnHY1"}],"key":"xQbiAHYOvk"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"coset generator is ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NfQjaWkCnB"},{"type":"inlineCode","value":"Fp(1)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ywCwE37z0W"}],"key":"i0571aPamK"}],"key":"drab7Gi1mM"}],"key":"K5bFgvZtYj"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"blowup_factor = 2\nnum_queries = 2\ncoset_gen = Fp(1)\n","key":"lQmzhdrgu6"},{"type":"output","id":"kpFbJoTJVj69jnE-Z6s9J","data":[],"key":"kG5ICydKKp"}],"key":"PIaJzPqvLv"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"# An MLE polynomial example, with length 32\nevals_over_hypercube = [Fp(2), Fp(3), Fp(4), Fp(5), Fp(6), Fp(7), Fp(8), Fp(9), \\\n             Fp(10), Fp(11), Fp(12), Fp(13), Fp(14), Fp(15), Fp(16), Fp(17), \\\n             Fp(2), Fp(3), Fp(4), Fp(5), Fp(6), Fp(7), Fp(8), Fp(9), \\\n             Fp(10), Fp(11), Fp(12), Fp(13), Fp(14), Fp(15), Fp(16), Fp(17), \\\n            ]\n\npoint = [Fp(-1), Fp(2), Fp(1), Fp(2), Fp(2)]\n\nf_mle = MLEPolynomial(evals_over_hypercube, 5)\n\nevaluation = f_mle.evaluate(point)\nevaluation\n","key":"wo6OdMdCDU"},{"type":"output","id":"909USGvwvo3m3kE8JMw1p","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"25","content_type":"text/plain"}}}],"key":"OZAVdOxi3n"}],"key":"LaR9jBpeRM"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"transcript = MerlinTranscript(\"test\")","key":"OccsSjQenq"},{"type":"output","id":"On6uSwZic1-mFUVB0ul5L","data":[],"key":"xC4s4RlLKQ"}],"key":"vKXqqL2fxl"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"# Commit to the MLE polynomial\n\nclass Commitment:\n\n    def __init__(self, tree: MerkleTree):\n        self.tree = tree\n        self.cm = tree.root\n        self.root = tree.root\n\n    def __repr__(self):\n        return f\"Commitment(len={len(self.tree.data)}, root={self.cm})\"\n    \ndef commit(f_mle: MLEPolynomial) -> Commitment:\n    evals = f_mle.evals\n    k = f_mle.num_var\n    k2 = k // 2\n    k1 = k - k2\n    n1 = 2**k1\n    n2 = 2**k2\n    c_mat = []\n    for i in range(n1):\n        c_row = [evals[i*n2+j] for j in range(n2)]\n        c_row_code = rs_encode(c_row, coset_gen, blowup_factor)\n        c_mat.append(c_row_code)\n\n    c_mat_T = matrix_transpose(c_mat)\n    print(f\"c_mat_T={c_mat_T}\")\n    cm_vec = [MerkleTree(c_mat_T[i]) for i in range(len(c_mat_T))]\n    # print(f\"cm_vec={[cm_vec[i].root for i in range(len(cm_vec))]})\")\n    return Commitment(MerkleTree([cm.root for cm in cm_vec]))\n\nf_cm = commit(f_mle)\nf_cm\n","key":"s7jNNHopZT"},{"type":"output","id":"_q8SLZvt1qJReGiK8Q833","data":[{"name":"stdout","output_type":"stream","text":"c_mat_T=[[14, 30, 46, 62, 14, 30, 46, 62], [191, 191, 191, 191, 191, 191, 191, 191], [160, 160, 160, 160, 160, 160, 160, 160], [29, 29, 29, 29, 29, 29, 29, 29], [148, 157, 166, 175, 148, 157, 166, 175], [173, 103, 33, 156, 173, 103, 33, 156], [128, 13, 91, 169, 128, 13, 91, 169], [138, 137, 136, 135, 138, 137, 136, 135]]\n"},{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"Commitment(len=8, root=24aa527a7c934be3c684c9eae6fa42a46037df5fa41be695016622f16ed441ed)","content_type":"text/plain"}}}],"key":"L0TdEQDtmE"}],"key":"WpVMFpf57N"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prove the evaluation argument","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zdeQfWMahn"}],"identifier":"prove-the-evaluation-argument","label":"Prove the evaluation argument","html_id":"prove-the-evaluation-argument","implicit":true,"key":"dLyHglg9eK"}],"key":"d5yPAMRI9A"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"[Fp(-3)*Fp(65), Fp(64)*Fp(65)]\n","key":"tJdV8fGqIj"},{"type":"output","id":"BwdNhU3qrQtP9m_sO56O7","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"[191, 107]","content_type":"text/plain"}}}],"key":"jCZdZ4VaZd"}],"key":"GlT0UAyFP7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Misc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LmFZo3Gc5R"}],"identifier":"misc","label":"Misc","html_id":"misc","implicit":true,"key":"N9O2Cg2i93"}],"key":"Ytj6vqFDuT"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"blowup_factor = 2\n\ndef prove_eval(mle: MLEPolynomial, point: list[Fp], transcript: MerlinTranscript):\n    assert mle.num_var == len(point), \"mle.num_var != len(point)\"\n\n    evals = mle.evals\n    k = mle.num_var\n    k1_prime = 2\n    k1 = k - k1_prime\n\n    G = rs_generator_matrix(Fp(1), 2**k1, blowup_factor)\n    X = []\n    for i in range(2**k1):\n        X.append([evals[i+j*2**k1] for j in range(2**k1_prime)])\n\n    r_vec = [Fp.random_element() for _ in range(k1_prime)]\n\n    eq_r = MLEPolynomial.eqs_over_hypercube(r_vec)\n\n    X_code = matrix_mul_matrix(G, X)\n    \n    y = matrix_mul_vec(X, eq_r)\n\n    return X, X_code, y, r_vec\n\ndef verify_eval(X_code, y, point: list[Fp], r_vec: list[Fp],transcript: MerlinTranscript):\n\n    k = len(point)\n    k1_prime = 2\n    k1 = k - k1_prime\n\n    G = rs_generator_matrix(Fp(1), 2**k1, blowup_factor)\n\n    eq_r = MLEPolynomial.eqs_over_hypercube(r_vec)\n\n    lhs = matrix_mul_vec(X_code, eq_r)\n    rhs = matrix_mul_vec(G, y)\n    return lhs, rhs\n","key":"hkTLD4TzNW"},{"type":"output","id":"o56eNc7MKZWZhN5l8CbWd","data":[],"key":"r1DjEvHcWM"}],"key":"JGWOu1H5mH"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def matrix_geometric(M):\n    return len(M), len(M[0])","key":"juaein2SUy"},{"type":"output","id":"QfFpILsUPZB_lidfaHl4b","data":[],"key":"OGFOcvFX0v"}],"key":"VfQTX6enon"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"X, X_code, y, r_vec = prove_eval(MLEPolynomial([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], 4), [1, 2, 3, 4], transcript)","key":"b14dy4pM9S"},{"type":"output","id":"mXiD-vb1HZYV9pU4LN6fO","data":[],"key":"TI13oERZsC"}],"key":"y2YfEWmxpD"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"r_vec, matrix_geometric(X_code), matrix_geometric(X), y","key":"VzeVLvgCZA"},{"type":"output","id":"FeypNKYzESP3Xg9OH2qyg","data":[{"output_type":"execute_result","execution_count":144,"metadata":{},"data":{"text/plain":{"content":"([157, 150], (8, 4), (4, 4), [92, 93, 94, 95])","content_type":"text/plain"}}}],"key":"UQ9ib896rg"}],"key":"ppHHGHTEZ0"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"verify_eval(X_code, y, [1, 2, 3, 4], r_vec,transcript)","key":"TbqLQLx1EA"},{"type":"output","id":"tojjog1PonuUAR6m_88Mo","data":[{"output_type":"execute_result","execution_count":145,"metadata":{},"data":{"text/plain":{"content":"([181, 61, 160, 146, 191, 142, 29, 19], [181, 61, 160, 146, 191, 142, 29, 19])","content_type":"text/plain"}}}],"key":"w6EsylT7NO"}],"key":"DDDIkGquHv"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"X, X_code, y, r_vec  = prove_eval(MLEPolynomial([X1, X2, X3, X4, X5, X6, X7, X8], 3), [1, 2, 3], transcript)","key":"Nk7wIGWQko"},{"type":"output","id":"ddtuQ3acBNXaAyuhUQC0l","data":[],"key":"DBVxOrypKs"}],"key":"wRrDSwm3iL"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"X, X_code, y, r_vec","key":"QQEw0gw2Wb"},{"type":"output","id":"J9dalItFbkMldlivjF4AS","data":[{"output_type":"execute_result","execution_count":147,"metadata":{},"data":{"text/plain":{"content":"([[X1, X3, X5, X7], [X2, X4, X6, X8]],\n [[X1 + X2, X3 + X4, X5 + X6, X7 + X8],\n  [X1 - 81*X2, X3 - 81*X4, X5 - 81*X6, X7 - 81*X8],\n  [X1 - X2, X3 - X4, X5 - X6, X7 - X8],\n  [X1 + 81*X2, X3 + 81*X4, X5 + 81*X6, X7 + 81*X8]],\n [40*X1 + 90*X3 - 10*X5 + 74*X7, 40*X2 + 90*X4 - 10*X6 + 74*X8],\n [164, 64])","content_type":"text/plain"}}}],"key":"AU1AxTEkmX"}],"key":"KTN1UnnM8Q"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"verify_eval(X_code, y, [1, 2, 3], r_vec, transcript)","key":"WXOk7Xpz0m"},{"type":"output","id":"p97Do90P5gxpgww1KA4So","data":[{"output_type":"execute_result","execution_count":148,"metadata":{},"data":{"text/plain":{"content":"([40*X1 + 40*X2 + 90*X3 + 90*X4 - 10*X5 - 10*X6 + 74*X7 + 74*X8,\n  40*X1 + 41*X2 + 90*X3 + 44*X4 - 10*X5 + 38*X6 + 74*X7 - 11*X8,\n  40*X1 - 40*X2 + 90*X3 - 90*X4 - 10*X5 + 10*X6 + 74*X7 - 74*X8,\n  40*X1 - 41*X2 + 90*X3 - 44*X4 - 10*X5 - 38*X6 + 74*X7 + 11*X8],\n [40*X1 + 40*X2 + 90*X3 + 90*X4 - 10*X5 - 10*X6 + 74*X7 + 74*X8,\n  40*X1 + 41*X2 + 90*X3 + 44*X4 - 10*X5 + 38*X6 + 74*X7 - 11*X8,\n  40*X1 - 40*X2 + 90*X3 - 90*X4 - 10*X5 + 10*X6 + 74*X7 - 74*X8,\n  40*X1 - 41*X2 + 90*X3 - 44*X4 - 10*X5 - 38*X6 + 74*X7 + 11*X8])","content_type":"text/plain"}}}],"key":"GzA7O8hWo3"}],"key":"nNoMRRcerV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Section 5: Matrix-vector product with partial sumcheck","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TauT8WC4Z8"}],"identifier":"section-5-matrix-vector-product-with-partial-sumcheck","label":"Section 5: Matrix-vector product with partial sumcheck","html_id":"section-5-matrix-vector-product-with-partial-sumcheck","implicit":true,"key":"mHh2aMiGOK"}],"key":"lUZpipCeTR"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"blowup_factor = 2\ndebug = 2\ndef prove_eval(mle: MLEPolynomial, point: list[Fp], transcript: MerlinTranscript):\n    assert mle.num_var == len(point), \"mle.num_var != len(point)\"\n\n    v = mle.evaluate(point)\n    print(f\"P> v = {v}\")\n    evals = mle.evals\n    k = mle.num_var\n    k1_prime = 2\n    k1 = k - k1_prime\n\n    G = rs_generator_matrix(Fp(1), 2**k1, blowup_factor)\n    X = []\n    for i in range(2**k1):\n        X.append([evals[i+j*2**k1] for j in range(2**k1_prime)])\n    if debug > 0:\n        print(f\"P> X = {X}\")\n\n    f = mle.evals\n    eq = MLEPolynomial.eqs_over_hypercube(point)\n    sumcheck_h_vec = []\n    sum_checked = v\n    r_vec = []\n    for i in range(k1_prime):\n        if debug > 0:\n            print(f\"P> sumcheck round {i}\")\n        half = len(f) // 2\n        f_low = f[:half]\n        f_high = f[half:]\n        eq_low = eq[:half]\n        eq_high = eq[half:]\n\n        h_eval_at_0 = sum([f_low[j] * eq_low[j] for j in range(half)], Fp(0))\n        h_eval_at_1 = sum([f_high[j] * eq_high[j] for j in range(half)], Fp(0))\n        h_eval_at_2 = sum([ (2 * f_high[j] - f_low[j]) * (2 * eq_high[j] - eq_low[j]) for j in range(half)], Fp(0))\n\n        h = [h_eval_at_0, h_eval_at_1, h_eval_at_2]\n        sumcheck_h_vec.append(h)\n\n        transcript.absorb(b\"h(X)\", h)\n\n        if debug > 0:\n            print(f\"P> h = {h}\")\n        \n        assert h_eval_at_0 + h_eval_at_1 == sum_checked, \\\n            f\"h_eval_at_0 + h_eval_at_1 = {h_eval_at_0 + h_eval_at_1}, sum_checked = {sum_checked}\"\n\n        r = Fp.random_element()\n\n        r_vec.append(r)\n\n        # fold f\n\n        f_folded = [(Fp(1) - r) * f_low[i] + r * f_high[i] for i in range(half)]\n        eq_folded = [(Fp(1) - r) * eq_low[i] + r * eq_high[i] for i in range(half)]\n\n        f = f_folded\n        eq = eq_folded\n\n        sum_checked = UniPolynomial.evaluate_from_evals(h, \n                r, [Fp(0), Fp(1), Fp(2)])\n\n    X_code = matrix_mul_matrix(G, X)\n\n    X_code_T = matrix_transpose(X_code)\n    \n    cm_vec = [MerkleTree(X_code_T[i]) for i in range(len(X_code_T))]\n\n    print(cm_vec)\n\n    eq_r = MLEPolynomial.eqs_over_hypercube(r_vec[::-1])\n\n    y = matrix_mul_vec(X, eq_r)\n    assert y == f_folded, f\"y != f_folded, y = {y}, f_folded = {f_folded}\"\n    \n\n    if debug > 1: \n        print(f\"P> check folded code\")\n        X_code_folded = matrix_mul_vec(X_code, eq_r)\n        print(X_code_folded)\n        assert X_code_folded == matrix_mul_vec(G, f_folded), f\"X_code_folded != X_code\"\n        print(f\"P> check folded code passed\")\n\n    return X, X_code, y, r_vec\n\ndef verify_eval(X_code, y, point: list[Fp], r_vec: list[Fp], transcript: MerlinTranscript):\n\n    k = len(point)\n    k1_prime = 2\n    k1 = k - k1_prime\n\n    G = rs_generator_matrix(Fp(1), 2**k1, blowup_factor)\n\n    eq_r = MLEPolynomial.eqs_over_hypercube(r_vec)\n\n    lhs = matrix_mul_vec(X_code, eq_r)\n    rhs = matrix_mul_vec(G, y)\n    return lhs, rhs\n\n","key":"XuJ3dfBIby"},{"type":"output","id":"l8ngxToSn0C9179YFmjNY","data":[],"key":"MTDsZr6t3D"}],"key":"sGjM7Z8Mvk"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"X, X_code, y, r_vec  = prove_eval(MLEPolynomial([X1, X2, X3, X4, X5, X6, X7, X8], 3), [1, 2, 3], transcript)","key":"OGbyn8LTE6"},{"type":"output","id":"7hasaZTz8aqIi8hggPVQM","data":[{"name":"stdout","output_type":"stream","text":"P> v = 2*X2 - 4*X4 - 3*X6 + 6*X8\nP> X = [[X1, X3, X5, X7], [X2, X4, X6, X8]]\nP> sumcheck round 0\nP> h = [2*X2 - 4*X4, -3*X6 + 6*X8, 8*X2 - 16*X4 - 16*X6 + 32*X8]\nP> sumcheck round 1\nP> h = [2*X2, -4*X4, 10*X2 - 20*X4]\n[<merkle.MerkleTree object at 0x161c27440>, <merkle.MerkleTree object at 0x161c27f80>, <merkle.MerkleTree object at 0x161c27620>, <merkle.MerkleTree object at 0x161c26480>]\nP> check folded code\n[56*X1 + 56*X2 - 55*X3 - 55*X4, 56*X1 + 96*X2 - 55*X3 + 16*X4, 56*X1 - 56*X2 - 55*X3 + 55*X4, 56*X1 - 96*X2 - 55*X3 - 16*X4]\nP> check folded code passed\n"}],"key":"RtOHI0yAVC"}],"key":"DaWrPe0403"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def reverse_bits(n: int, bit_length: int) -> int:\n    \"\"\"\n    Reverse the bits of an integer.\n\n    Args:\n        n (int): The input integer.\n        bit_length (int): The number of bits to consider.\n\n    Returns:\n        int: The integer with its bits reversed.\n    \"\"\"\n    result = 0\n    for i in range(bit_length):\n        result = (result << 1) | (n & 1)\n        n >>= 1\n    return result","key":"ZAh33u7uK2"},{"type":"output","id":"Mx5T0IofN8GBoUEv5rBpT","data":[],"key":"TP0GIvfw4b"}],"key":"PvszLPwgRG"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"reverse_bits(4, 3)","key":"iSTwHMXjUa"},{"type":"output","id":"-3O-ezVdrsta7RmzavKUR","data":[{"output_type":"execute_result","execution_count":177,"metadata":{},"data":{"text/plain":{"content":"1","content_type":"text/plain"}}}],"key":"WL6Wfissqd"}],"key":"KkKZksHYeI"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def tensor_vector(index: int, k1: int, blowup_factor: int):\n    N = 2**k1 * blowup_factor\n    omega_Nth = Fp.nth_root_of_unity(N)\n    index_rev = reverse_bits(index, log_2(N))\n    omega = omega_Nth**index_rev\n    print(f\"omega = {omega}\")\n    vec = [omega**(2**i) for i in range(k1)]\n    print(f\"vec = {vec}\")\n    return vec\n\ndef rs_generator_matrix_at_row(index:int, f_len: int, coset:Fp, blowup_factor:int) -> list[Fp]:\n    n = next_power_of_two(f_len)\n    N = n * blowup_factor\n    omega_Nth = Fp.nth_root_of_unity(N)\n    index_rev = reverse_bits(index, log_2(N))\n    omega = omega_Nth**index_rev\n    return [coset* omega**i for i in range(n)]","key":"kpJghNAbUy"},{"type":"output","id":"briB5VkSwHA4tgAtXd1XC","data":[],"key":"KdtkRkotAR"}],"key":"x8AotcC5oB"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"tensor_vector(1, 3, 2)","key":"Bs2YTSSQyI"},{"type":"output","id":"ZJ8A1J71dE2bMiD9PDy-o","data":[{"name":"stdout","output_type":"stream","text":"omega = 192\nvec = [192, 1, 1]\n"},{"output_type":"execute_result","execution_count":125,"metadata":{},"data":{"text/plain":{"content":"[192, 1, 1]","content_type":"text/plain"}}}],"key":"M2rfVfPwBX"}],"key":"XsNy7tygZI"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"omega_Nth = Fp.nth_root_of_unity(16)\nindex_rev = reverse_bits(1, 4)\nomega = omega_Nth**index_rev\nindex_rev, omega","key":"nmn3w0F4NT"},{"type":"output","id":"8Y6qljD-WlJS4FzTs6_Nx","data":[{"output_type":"execute_result","execution_count":126,"metadata":{},"data":{"text/plain":{"content":"(8, 192)","content_type":"text/plain"}}}],"key":"Y1kQ1Z1U0j"}],"key":"k4X3bm4USF"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"omega, omega**2, omega**4","key":"wABQNToObp"},{"type":"output","id":"QoSqnIEt-fRa0ibOAOZ70","data":[{"output_type":"execute_result","execution_count":127,"metadata":{},"data":{"text/plain":{"content":"(192, 1, 1)","content_type":"text/plain"}}}],"key":"OruAk5QaB8"}],"key":"tlK9fCr6SZ"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"[63 * Fp(93), -2 * Fp(93)]","key":"uKrLREij9m"},{"type":"output","id":"jWFUdgXLQ5AsVfF-ebAgJ","data":[{"output_type":"execute_result","execution_count":128,"metadata":{},"data":{"text/plain":{"content":"[69, 7]","content_type":"text/plain"}}}],"key":"lRUXNrndtk"}],"key":"oGJExxdeBk"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"eq0 = [Fp(-83), Fp(28)]\nrs_w = [Fp(1), Fp(-81)]\nbeta = Fp(93)\neq = [eq0[j] + beta * rs_w[j] for j in range(len(eq0))]\neq\n","key":"d64EiS4n5N"},{"type":"output","id":"9C2LDlO1o1HQkiJTS9qu4","data":[{"output_type":"execute_result","execution_count":129,"metadata":{},"data":{"text/plain":{"content":"[10, 22]","content_type":"text/plain"}}}],"key":"i4Quo8u3Sb"}],"key":"k6jzk2XNu1"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"point = [Fp(3), Fp(2), Fp(2)]\nk_last = 1\nr_vec_all = [Fp(76), Fp(70)]\n\nscalar = MLEPolynomial.evaluate_eq_polynomial(point[k_last:], r_vec_all)\neq_0 = MLEPolynomial.eqs_over_hypercube(point[:k_last])\neq_0 = [eq_0[j] * scalar for j in range(2**k_last)]\neq_0","key":"Hd6b6TfJgu"},{"type":"output","id":"NckGl3-rFuFNb5FDJVY-F","data":[{"output_type":"execute_result","execution_count":155,"metadata":{},"data":{"text/plain":{"content":"[70, 88]","content_type":"text/plain"}}}],"key":"dtv5ljIZcd"}],"key":"syoVhxSpf7"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"q=7\nk1_prime = 1\nk1 = 2","key":"UePWsQhdjM"},{"type":"output","id":"ES0upqO-gpiije_K1rjWh","data":[],"key":"h2k1TIWZVY"}],"key":"p8MOi48xrz"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"rs_generator_matrix_at_row(q, 2**k1, Fp(1), 4)","key":"qV0WtEmRRV"},{"type":"output","id":"-Oye651X_y2alITwNtYOt","data":[{"output_type":"execute_result","execution_count":132,"metadata":{},"data":{"text/plain":{"content":"[1, 9, 81, 150]","content_type":"text/plain"}}}],"key":"v2Ot0adWpy"}],"key":"K9vEeSTpnq"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"r_vec = r_vec_all[:k1-k_last]\nr_vec\n","key":"RPrWRWh7Fe"},{"type":"output","id":"SnSkzP-oMuPjGnBaNHk4C","data":[{"output_type":"execute_result","execution_count":133,"metadata":{},"data":{"text/plain":{"content":"[76]","content_type":"text/plain"}}}],"key":"W5HubsAn2Z"}],"key":"Ky9ZZ76skg"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def tensor_vector_with_monomial_basis(vec: list[Fp]) -> list[Fp]:\n    if len(vec) == 0:\n        return [Fp(1)]\n    v = vec[-1]\n    vec_expanded = tensor_vector_with_monomial_basis(vec[:-1])\n    vec_right = [vec_expanded[i] * v for i in range(len(vec_expanded))]\n    return vec_expanded + vec_right\ntensor_vector_with_monomial_basis([X0, X1, X2])","key":"XZOP3JfyKF"},{"type":"output","id":"iqTrX98ekTzMsmcHHcpt1","data":[{"output_type":"execute_result","execution_count":147,"metadata":{},"data":{"text/plain":{"content":"[1, X0, X1, X0*X1, X2, X0*X2, X1*X2, X0*X1*X2]","content_type":"text/plain"}}}],"key":"AvN52J3w1V"}],"key":"YSehZHO2rW"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"def tensor_vector_with_multilinear_basis(vec: list[Fp]) -> list[Fp]:\n    if len(vec) == 0:\n        return [Fp(1)]\n    v = vec[-1]\n    vec_expanded = tensor_vector_with_multilinear_basis(vec[:-1])\n    vec_left = [vec_expanded[i] * (Fp(1)-v) for i in range(len(vec_expanded))]\n    vec_right = [vec_expanded[i] * v for i in range(len(vec_expanded))]\n    return vec_left + vec_right\ntensor_vector_with_multilinear_basis([X0, X1, X2])","key":"TJGYoYx9lv"},{"type":"output","id":"F_rOqwvD1grf9vckqoQPF","data":[{"output_type":"execute_result","execution_count":148,"metadata":{},"data":{"text/plain":{"content":"[-X0*X1*X2 + X0*X1 + X0*X2 + X1*X2 - X0 - X1 - X2 + 1,\n X0*X1*X2 - X0*X1 - X0*X2 + X0,\n X0*X1*X2 - X0*X1 - X1*X2 + X1,\n -X0*X1*X2 + X0*X1,\n X0*X1*X2 - X0*X2 - X1*X2 + X2,\n -X0*X1*X2 + X0*X2,\n -X0*X1*X2 + X1*X2,\n X0*X1*X2]","content_type":"text/plain"}}}],"key":"JP0xQtTdCz"}],"key":"tp6ubXGI1c"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"MLEPolynomial.eqs_over_hypercube([X0, X1, X2])","key":"N7RVvoO2nD"},{"type":"output","id":"rcoUcIKCmgSgZ2kIePOwG","data":[{"output_type":"execute_result","execution_count":149,"metadata":{},"data":{"text/plain":{"content":"[-X0*X1*X2 + X0*X1 + X0*X2 + X1*X2 - X0 - X1 - X2 + 1,\n X0*X1*X2 - X0*X1 - X0*X2 + X0,\n X0*X1*X2 - X0*X1 - X1*X2 + X1,\n -X0*X1*X2 + X0*X1,\n X0*X1*X2 - X0*X2 - X1*X2 + X2,\n -X0*X1*X2 + X0*X2,\n -X0*X1*X2 + X1*X2,\n X0*X1*X2]","content_type":"text/plain"}}}],"key":"tBMAwyc4AV"}],"key":"VECwESwXB1"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"# iteration 0\n\nfrom functools import reduce\nfrom operator import mul\n\nbeta=Fp(86)\nq=7\nk1_prime = 1\nk1 = 2\nr_vec = r_vec_all[:k1-k_last]\n\nw_rev = tensor_vector(q, k1, 2)\nprint(f\"w_rev = {w_rev}\")\nw_ex = tensor_vector_with_monomial_basis(w_rev[k_last:])\nprint(f\"w_ex = {w_ex}\")\nr_ex = tensor_vector_with_multilinear_basis(r_vec)\nprint(f\"r_ex = {r_ex}\")\nscalar = inner_product(r_ex, w_ex, Fp(0))\nscalar_2 = reduce(mul, [inner_product([Fp(1)-r_vec[j], r_vec[j]], [1, w_rev[k_last:][j]], Fp(0)) for j in range(len(r_vec))], Fp(1))\nprint(f\"scalar = {scalar}, scalar_2 = {scalar_2}\")\nassert scalar == scalar_2, f\"scalar != scalar_2, {scalar} != {scalar_2}\"\n\nnew_eq = tensor_vector_with_monomial_basis(w_rev[:k_last])\nnew_eq = [new_eq[j] * scalar for j in range(2**k_last)]\neq_2 = [eq_0[j] + beta * new_eq[j] for j in range(2**k_last)]\neq_2, new_eq, scalar\n","key":"wZXiO6XPng"},{"type":"output","id":"XYjbCX5XCTgGaY6n16q2i","data":[{"name":"stdout","output_type":"stream","text":"omega = 9\nvec = [9, 81]\nw_rev = [9, 81]\nw_ex = [1, 81]\nr_ex = [118, 76]\nscalar = 98, scalar_2 = 98\n"},{"output_type":"execute_result","execution_count":161,"metadata":{},"data":{"text/plain":{"content":"([6, 91], [98, 110], 98)","content_type":"text/plain"}}}],"key":"SxfaWOZPW6"}],"key":"XNk7B9aZKH"},{"type":"block","kind":"notebook-code","data":{"vscode":{"languageId":"python"}},"children":[{"type":"code","lang":"sage","executable":true,"value":"# iteration 1\n\nq=0\nk1_prime = 1\nk1 = 1\nr_vec = r_vec_all[:k1-k_last]\nbeta = Fp(12)\n\nw_rev = tensor_vector(q, k1, 2)\nprint(f\"w_rev = {w_rev}\")\nw_ex = tensor_vector_with_monomial_basis(w_rev[k_last:])\nprint(f\"w_ex = {w_ex}\")\nr_ex = tensor_vector_with_multilinear_basis(r_vec)\nprint(f\"r_ex = {r_ex}\")\nscalar = inner_product(r_ex, w_ex, Fp(0))\nscalar_2 = reduce(mul, [inner_product([Fp(1)-r_vec[j], r_vec[j]], [1, w_rev[k_last:][j]], Fp(0)) for j in range(len(r_vec))], Fp(1))\nprint(f\"scalar = {scalar}, scalar_2 = {scalar_2}\")\nassert scalar == scalar_2, f\"scalar != scalar_2, {scalar} != {scalar_2}\"\n\nnew_eq = tensor_vector_with_monomial_basis(w_rev[:k_last])\nnew_eq = [new_eq[j] * scalar for j in range(2**k_last)]\neq_3 = [eq_2[j] + beta * new_eq[j] for j in range(2**k_last)]\neq_3, new_eq, scalar","key":"c6a8aly1Np"},{"type":"output","id":"2ninLJ1P7TqoSJEi9CVfm","data":[{"name":"stdout","output_type":"stream","text":"omega = 1\nvec = [1]\nw_rev = [1]\nw_ex = [1]\nr_ex = [1]\nscalar = 1, scalar_2 = 1\n"},{"output_type":"execute_result","execution_count":162,"metadata":{},"data":{"text/plain":{"content":"([18, 103], [1, 1], 1)","content_type":"text/plain"}}}],"key":"jlwlWbWUqf"}],"key":"DoG1Yl7u0h"}],"key":"mcHTC3Vlq7"},"references":{"cite":{"order":[],"data":{}}}}