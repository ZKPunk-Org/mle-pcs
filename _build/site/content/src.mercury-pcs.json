{"version":2,"kind":"Notebook","sha256":"cb1caa058ef1b71ea395a43de768889a67619e21309d71ce4d3a6d443a69ca12","slug":"src.mercury-pcs","location":"/src/mercury_pcs.ipynb","dependencies":[],"frontmatter":{"title":"2. Prove evaluation","content_includes_title":true,"kernelspec":{"name":"SageMath-10.4","display_name":"SageMath 10.4","language":"sage"},"github":"https://github.com/executablebooks/jupyter-book","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/executablebooks/jupyter-book/blob/main/src/mercury_pcs.ipynb","exports":[{"format":"ipynb","filename":"mercury_pcs.ipynb","url":"/mercury_pcs-460a17e6d61574a69c40c6409dfb3ecb.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"from curve import Fr as Field, ec_mul, G1Point as G1\nfrom merlin.merlin_transcript import MerlinTranscript\nfrom mle2 import MLEPolynomial\nfrom utils import log_2, log_2_ceiling, is_power_of_two, prime_field_inv, Scalar\nfrom kzg10_non_hiding2 import Commitment, KZG10_PCS\nfrom curve import Fr as Field, G1Point as G1, G2Point as G2, ec_pairing_check\nfrom unipoly2 import UniPolynomial, UniPolynomialWithFft\nfrom typing import TypeVar, Union, Optional\nfrom random import Random, randint","key":"pyqhco0GM3"},{"type":"output","id":"hPKzu_yAiFsJtnSEJ1OCI","data":[],"key":"ENHK0TGny0"}],"key":"LA8gtaqFXa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"BN254_Fr = GF(Field.field_modulus); BN254_Fr","key":"tXUvzneVwZ"},{"type":"output","id":"vrlRCMacb0r9nBZNP14NI","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"Finite Field of size 21888242871839275222246405745257275088548364400416034343698204186575808495617","content_type":"text/plain"}}}],"key":"qxy7DKMjLe"}],"key":"Tu2Zr3Zfm6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"Rp.<X> = BN254_Fr[]\nB_mono = [X^i for i in range(0, 1024)]\ndef poly(cof, B=B_mono):\n    return reduce(lambda acc, e: acc + e, [BN254_Fr(int(a)) * b for a, b in zip(cof, B)])\n    \ndef powers(u, k):\n    return [u^i for i in range(0, 2**k)]\n    \ndef eval(f, D):\n    n = len(D)\n    k = log_2_ceiling(n)\n    return [poly(f, powers(D[i], k)) for i in range(0, n)]\nF = Field\n","key":"VzOHtXIT5M"},{"type":"output","id":"sZ0OkWsWqV9SIt6b_dRHm","data":[],"key":"O1yZugz0D8"}],"key":"sieMC6NPpE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"kzg_pcs = KZG10_PCS(G1, G2, Field, 20, debug=True)","key":"CN33ETIW1Y"},{"type":"output","id":"4gIQxOmuV0K8TXTRJaWoc","data":[],"key":"sPL9KrRqNp"}],"key":"k9wmJpWiZv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def commit(f: MLEPolynomial):\n    evals = f.evals\n    f_cm = kzg_pcs.commit(UniPolynomial(evals))\n    return f_cm","key":"tkoYM5aSVb"},{"type":"output","id":"GyHDkU9IH58MJvXnu6rxU","data":[],"key":"A3VHjZDR5s"}],"key":"bqkk1VLG9t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"tr = MerlinTranscript(b\"test-mercury-pcs\")","key":"G5Wl5wltLs"},{"type":"output","id":"oMrZgQOmEKaq84ydZuW20","data":[],"key":"Tou06LaJtT"}],"key":"dFGCEyB8rE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f_mle = MLEPolynomial([F(int(1)), F(int(3)), F(int(2)), F(int(1)),\n                    F(int(2)), F(int(-2)), F(int(1)), F(int(0)),\n                    F(int(-1)), F(int(2)), F(int(3)), F(int(1)),\n                    F(int(3)), F(int(1)), F(int(-2)), F(int(3))], 4)\nf_cm = commit(f_mle)\nus = [F(int(2)), F(int(-1)), F(int(1)), F(int(-2))]\nv = f_mle.evaluate(us)\nv\n","key":"YmG6jXSafF"},{"type":"output","id":"q0QzS7d_CuzrEMmKNvCly","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"-13","content_type":"text/plain"}}}],"key":"FUVBIjVtet"}],"key":"jaj2sCai7n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"k = f_mle.num_var\nus_l = us[:k//2]\nus_r = us[k//2:]\nvec_eq_l = MLEPolynomial.eqs_over_hypercube(us_l)\nvec_eq_r = MLEPolynomial.eqs_over_hypercube(us_r)\nn_l = len(vec_eq_l) # column\nn_r = len(vec_eq_r) # row\nvec_eq_l, vec_eq_r\n","key":"fpQE7V3jMg"},{"type":"output","id":"NVR-qbYGeDUNdN0Zkxp_Q","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"([-2, 4, 1, -2], [0, 3, 0, -2])","content_type":"text/plain"}}}],"key":"izlawS2B2H"}],"key":"LYPfZooQtD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"alpha = F(int(3))\nalpha_exp_4 = F(int(3^4))","key":"oyzuYF3qso"},{"type":"output","id":"CHOf3CW851Ud83Aq1BZPK","data":[],"key":"WNAUu7Msqu"}],"key":"cJuVFV5Exs"},{"type":"block","kind":"notebook-content","children":[{"type":"math","value":"\\tilde{f}(X_0, X_1, X_2, X_3) = \n\\begin{bmatrix}\n1 & X_2 & X_3 & X_2X_3 \\\\\n\\end{bmatrix}\n\\begin{bmatrix}\nc_0 & c_1 & c_2 & c_3 \\\\\nc_4 & c_5 & c_6 & c_7 \\\\\nc_8 & c_9 & c_{10} & c_{11} \\\\\nc_{12} & c_{13} & c_{14} & c_{15}\n\\end{bmatrix}\n\\begin{bmatrix}\n1 \\\\\nX_0 \\\\\nX_1 \\\\\nX_0X_1 \\\\\n\\end{bmatrix}","position":{"start":{"line":1,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>f</mi><mo>~</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>X</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>X</mi><mn>3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>X</mi><mn>2</mn></msub><msub><mi>X</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>3</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>4</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>5</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>6</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>7</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>8</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>9</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>10</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>11</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>13</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>14</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>15</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>X</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>X</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>X</mi><mn>0</mn></msub><msub><mi>X</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\tilde{f}(X_0, X_1, X_2, X_3) = \n\\begin{bmatrix}\n1 &amp; X_2 &amp; X_3 &amp; X_2X_3 \\\\\n\\end{bmatrix}\n\\begin{bmatrix}\nc_0 &amp; c_1 &amp; c_2 &amp; c_3 \\\\\nc_4 &amp; c_5 &amp; c_6 &amp; c_7 \\\\\nc_8 &amp; c_9 &amp; c_{10} &amp; c_{11} \\\\\nc_{12} &amp; c_{13} &amp; c_{14} &amp; c_{15}\n\\end{bmatrix}\n\\begin{bmatrix}\n1 \\\\\nX_0 \\\\\nX_1 \\\\\nX_0X_1 \\\\\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1813em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span><span style=\"top:-3.6134em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0833em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">13</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">10</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">14</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">7</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">15</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"V9q01Jqacn"}],"key":"SGAbPXEAmx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f_mle.evals","key":"QaqPQ5lRIi"},{"type":"output","id":"3k3MjaDomFXXrzcl_tps-","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"[1, 3, 2, 1, 2, -2, 1, 0, -1, 2, 3, 1, 3, 1, -2, 3]","content_type":"text/plain"}}}],"key":"s841XmoxjH"}],"key":"SICyTDeB6c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"[f_mle.evals[i:i+4] for i in range(0, len(f_mle.evals), 4)]\n","key":"D1SJJGVV9m"},{"type":"output","id":"WrqKLRgFwoCU0jKHVSMFo","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"[[1, 3, 2, 1], [2, -2, 1, 0], [-1, 2, 3, 1], [3, 1, -2, 3]]","content_type":"text/plain"}}}],"key":"pICroKc2t1"}],"key":"b8uyBYp003"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"h_evals = []\nfor j in range(n_l):\n    h_evals.append([f_mle.evals[j+i*n_l] for i in range(n_r)] )\nh_evals\n","key":"sw0LcbUIa8"},{"type":"output","id":"USaluaytwdDMvW701R_Mr","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"[[1, 2, -1, 3], [3, -2, 2, 1], [2, 1, 3, -2], [1, 0, 1, 3]]","content_type":"text/plain"}}}],"key":"Gf9dLqFCau"}],"key":"tZPp8Nd2yi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_mle = MLEPolynomial(h_evals[0], 2)\nf1_mle = MLEPolynomial(h_evals[1], 2)\nf2_mle = MLEPolynomial(h_evals[2], 2)\nf3_mle = MLEPolynomial(h_evals[3], 2)\nf0_mle.evals, f1_mle.evals, f2_mle.evals, f3_mle.evals\n","key":"i01EiJG0br"},{"type":"output","id":"LbUEWB5AQlytcNwfs9Lcs","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"([1, 2, -1, 3], [3, -2, 2, 1], [2, 1, 3, -2], [1, 0, 1, 3])","content_type":"text/plain"}}}],"key":"LL8Wh4f01Z"}],"key":"r0SPkle5wi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_poly = poly(f0_mle.evals)\nf1_poly = poly(f1_mle.evals)\nf2_poly = poly(f2_mle.evals)\nf3_poly = poly(f3_mle.evals)\n","key":"CAL6vMZQbA"},{"type":"output","id":"-_eRHYZiHWP4Uq7v8hljf","data":[],"key":"x77tqBv2xP"}],"key":"NgwWoxknhv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_uni = UniPolynomial(f0_mle.evals)\nf1_uni = UniPolynomial(f1_mle.evals)\nf2_uni = UniPolynomial(f2_mle.evals)\nf3_uni = UniPolynomial(f3_mle.evals)\nf_uni = UniPolynomial(f_mle.evals)\nf_uni, f_uni.evaluate(F(int(3)))","key":"PP0uzXfeui"},{"type":"output","id":"Jy_ynpqFMCwJS2aIUNxWj","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"(1 + 3x + 2x^2 + x^3 + 2x^4 + -2x^5 + x^6 + -1x^8 + 2x^9 + 3x^10 + x^11 + 3x^12 + x^13 + -2x^14 + 3x^15,\n 37056988)","content_type":"text/plain"}}}],"key":"DILQodR8Yn"}],"key":"MP6sKG3Q8h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_uni.evaluate(F(int(3^4))) + F(int(3)) * f1_uni.evaluate(F(int(3^4))) + F(int(3^2)) * f2_uni.evaluate(F(int(3^4))) + F(int(3^3)) * f3_uni.evaluate(F(int(3^4)))","key":"eo8o7YuzIE"},{"type":"output","id":"8ZtdtMlM3RP8_v9ZZd3rl","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"37056988","content_type":"text/plain"}}}],"key":"uvf5IqA6zp"}],"key":"mmTFc8sCi9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f_poly = (f0_poly(X^4) + X*f1_poly(X^4) + X^2*f2_poly(X^4) + X^3*f3_poly(X^4))\nf_poly, f_poly(BN254_Fr(int(3)))\n","key":"eL1vHQkPKd"},{"type":"output","id":"E5hFKlcRh2BVxCv9yimPf","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"(3*X^15 + 21888242871839275222246405745257275088548364400416034343698204186575808495615*X^14 + X^13 + 3*X^12 + X^11 + 3*X^10 + 2*X^9 + 21888242871839275222246405745257275088548364400416034343698204186575808495616*X^8 + X^6 + 21888242871839275222246405745257275088548364400416034343698204186575808495615*X^5 + 2*X^4 + X^3 + 2*X^2 + 3*X + 1,\n 37056988)","content_type":"text/plain"}}}],"key":"FOLOSkJWmV"}],"key":"q4vKnlkdQO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q_poly = f_poly // (X^4-3)\nr_poly = f_poly % (X^4-3)\nq_poly, r_poly\n","key":"g1m0VJFdje"},{"type":"output","id":"52Yk-GQVPhG3ZoUcb3Pyb","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"(3*X^11 + 21888242871839275222246405745257275088548364400416034343698204186575808495615*X^10 + X^9 + 3*X^8 + 10*X^7 + 21888242871839275222246405745257275088548364400416034343698204186575808495614*X^6 + 5*X^5 + 8*X^4 + 30*X^3 + 21888242871839275222246405745257275088548364400416034343698204186575808495609*X^2 + 13*X + 26,\n 91*X^3 + 21888242871839275222246405745257275088548364400416034343698204186575808495595*X^2 + 42*X + 79)","content_type":"text/plain"}}}],"key":"TNZxy7o2X2"}],"key":"mRjoWuda6z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q_poly(BN254_Fr(int(alpha))), r_poly(BN254_Fr(int(alpha)))","key":"hWKnVnnKpE"},{"type":"output","id":"-MFPUD20Bl3rhOaOxgqMd","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"(475058, 2464)","content_type":"text/plain"}}}],"key":"lLUYOLeNeb"}],"key":"HTucz1AFUc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Check if f[0..3] are correct\nx_uni = UniPolynomial([F(int(0)), F(int(1))])\n\nf_alt_eval_at_alpha = f0_uni.evaluate(alpha_exp_4) \\\n    + (f1_uni.evaluate(alpha_exp_4)*alpha) \\\n    + (f2_uni.evaluate(alpha_exp_4)*alpha*alpha) \\\n    + (f3_uni.evaluate(alpha_exp_4) * alpha*alpha*alpha)\nf_alt_eval_at_alpha","key":"dArZPfNpmG"},{"type":"output","id":"0RhYLzHXg1H5DVininNKd","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"37056988","content_type":"text/plain"}}}],"key":"ATmIDtTObh"}],"key":"X3eRDNGt4z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q0_uni, r0 = f0_uni.div_by_linear_divisor(alpha)\nq1_uni, r1 = f1_uni.div_by_linear_divisor(alpha)\nq2_uni, r2 = f2_uni.div_by_linear_divisor(alpha)\nq3_uni, r3 = f3_uni.div_by_linear_divisor(alpha)\nq0_uni, r0, q1_uni, r1, q2_uni, r2, q3_uni, r3\n","key":"dCVa3jbYwj"},{"type":"output","id":"vwhY_WrY-X7K132icIGa5","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"(26 + 8x + 3x^2,\n 79,\n 13 + 5x + x^2,\n 42,\n -8 + -3x + -2x^2,\n -22,\n 30 + 10x + 3x^2,\n 91)","content_type":"text/plain"}}}],"key":"Buin6OkXVO"}],"key":"z5eWTYJFWR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"r0 == f0_uni.evaluate(alpha), r1 == f1_uni.evaluate(alpha), r2 == f2_uni.evaluate(alpha), r3 == f3_uni.evaluate(alpha)\n","key":"pYYt8Xl8qZ"},{"type":"output","id":"NoHzgm5UxNYHOpPYaG92B","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(True, True, True, True)","content_type":"text/plain"}}}],"key":"vcmv5OCGbm"}],"key":"AlIKc8YWTi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Construct q(X)\n#\n#   q(X) = q0(X^4) + X*q1(X^4) + X^2*q2(X^4) + X^3*q3(X^4)\n#   \n#  Or, the coefficients of q(X) are:\n#\n#   [q0[0], q1[0], q2[0], q3[0], \n#    q0[1], q1[1], q2[1], q3[1], \n#    q0[2], q1[2], q2[2], q3[2]]\n#\n#  Please note that deg(q) < 12\n\nq_coeffs = []\nfor i in range(len(q0_uni.coeffs)):\n    q_coeffs.append(q0_uni.coeffs[i])\n    q_coeffs.append(q1_uni.coeffs[i])\n    q_coeffs.append(q2_uni.coeffs[i])\n    q_coeffs.append(q3_uni.coeffs[i])\nq_uni = UniPolynomial(q_coeffs)\nq_uni.evaluate(alpha), q_coeffs","key":"mMRtT1GPiI"},{"type":"output","id":"YdCNXW2-oiHuVhG8HQ2zb","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"(475058, [26, 13, -8, 30, 8, 5, -3, 10, 3, 1, -2, 3])","content_type":"text/plain"}}}],"key":"HJRc8UEgUt"}],"key":"ILX4Rddyxx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def compute_quotient(coeffs, k):\n    num_col = 2**k\n    num_row = len(coeffs) // num_col\n    print(f\"num_col: {num_col}, num_row: {num_row}\")\n\n    q_coeffs = [F.zero()] * (num_col * (num_row-1))\n    for j in range(num_col):\n        fi = coeffs[j::num_row]\n\n        qi, ri = UniPolynomial(fi).div_by_linear_divisor(alpha)\n        for i in range(num_row-1):\n            q_coeffs[j+i*num_row] = qi.coeffs[i]\n    return q_coeffs\n\n","key":"Wqp7wbwrju"},{"type":"output","id":"sJQiRpQ71h0hHYcTTonlv","data":[],"key":"DUapALGLwE"}],"key":"LSei8JcxPS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"compute_quotient(f_uni.coeffs, 2)","key":"azGIN0truM"},{"type":"output","id":"nYG-SFR2Xef0W7qJeoGZq","data":[{"name":"stdout","output_type":"stream","text":"num_col: 4, num_row: 4\n"},{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"[26, 13, -8, 30, 8, 5, -3, 10, 3, 1, -2, 3]","content_type":"text/plain"}}}],"key":"iY5zu9ZuEt"}],"key":"Pn0Oy1iKnI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q_eval_at_alpha = q0_uni.evaluate(alpha_exp_4) \\\n    + (q1_uni.evaluate(alpha_exp_4)*alpha) \\\n    + (q2_uni.evaluate(alpha_exp_4)*alpha*alpha) \\\n    + (q3_uni.evaluate(alpha_exp_4) * alpha*alpha*alpha)\nq_eval_at_alpha","key":"x2SiMbfbCz"},{"type":"output","id":"F3NKctxwEjD4NZf0RJPuY","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"475058","content_type":"text/plain"}}}],"key":"TjNotr20aU"}],"key":"UJeZ29DCCw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def compute_product_poly(a: list[Field], b: list[Field]):\n    assert len(a) == len(b), \"Length of a and b must be the same\"\n    l = len(a)\n    s = [F.zero()] * (l-1)\n    dot_product = F.zero()\n    for i in range(l):\n        for j in range(l):\n            if abs(i-j) == 0:\n                dot_product += a[i] * b[j]\n            else:\n                s[abs(i-j)-1] += a[i] * b[j]\n    return s, dot_product","key":"hdJPwicOP8"},{"type":"output","id":"PCbUpWxEdfFtG7q3wvu2o","data":[],"key":"HlAnyxBeIT"}],"key":"xpozWHLzv8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def inner_product(a, b, z):\n    return sum([a[i] * b[i] for i in range(len(a))], z)","key":"ukMnSEFDzH"},{"type":"output","id":"rLAnLISAjRzb7lvjpUq2e","data":[],"key":"cMduw0tJtz"}],"key":"AEiCykgjUf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"a = [F(int(1)), F(int(2)), F(int(3)), F(int(4))]\nb = [F(int(4)), F(int(2)), F(int(3)), F(int(1))]\na_uni = UniPolynomial(a)\nb_uni = UniPolynomial(b)\ns, v = compute_product_poly(a, b)\ns_uni = UniPolynomial(s)\ns, v, v == inner_product(a, b, F(int(0)))","key":"wPvgSqJjIB"},{"type":"output","id":"Sf7AThCja_l4hs0Yai79u","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"([37, 25, 17], 21, True)","content_type":"text/plain"}}}],"key":"C1vFwCHxiu"}],"key":"oJ5llwqVCP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Check if s(X) is correct\n#\n#    a(X)b(1/X) + a(1/X)b(X) = 2v + X*s(X) + (1/X)*s(1/X)\n#\nz = F.rand()\nz_inv = int(1)/z\n# a_uni.evaluate(z) * b_uni.evaluate(z_inv), F(int(2)) * v\na_uni.evaluate(z) * b_uni.evaluate(z_inv) + a_uni.evaluate(z_inv) * b_uni.evaluate(z) \\\n    == F(int(2))*v + z*s_uni.evaluate(z) + z_inv*s_uni.evaluate(z_inv)","key":"yAMAveFJRc"},{"type":"output","id":"LWbUAGyZ2zLlJ8XaKxQOX","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"True","content_type":"text/plain"}}}],"key":"lBsJhJSBrO"}],"key":"WHnrEzYjY7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q_coeffs = []\nfor i in range(len(q0_uni.coeffs)):\n    q_coeffs.append(q0_uni.coeffs[i])\n    q_coeffs.append(q1_uni.coeffs[i])\n    q_coeffs.append(q2_uni.coeffs[i])\n    q_coeffs.append(q3_uni.coeffs[i])\nq_coeffs","key":"sUpF34CIlC"},{"type":"output","id":"AyasvmSCFHxxgdBZKjWdU","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"[26, 13, -8, 30, 8, 5, -3, 10, 3, 1, -2, 3]","content_type":"text/plain"}}}],"key":"cuztQLn9wv"}],"key":"OUUFwddf3G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q, r = UniPolynomial.polynomial_division_with_remainder(f_uni.coeffs, \n                        [-alpha, F(int(0)), F(int(0)), F(int(0)), F(int(1))])\nq, r","key":"zxUFW1ylCa"},{"type":"output","id":"ZB0bkhz27jUb-ehdtqQ7R","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"([26, 13, -8, 30, 8, 5, -3, 10, 3, 1, -2, 3], [79, 42, -22, 91])","content_type":"text/plain"}}}],"key":"DVoX5tonPy"}],"key":"VBCYrvzkQx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"r_uni = UniPolynomial(r)","key":"Z6tac0KBzz"},{"type":"output","id":"TOwSLRR_LvGkKXm_Luklo","data":[],"key":"v48LvY4iI9"}],"key":"WV3yXKu898"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"r_uni.evaluate(F(int(3)))","key":"BhF81M8Q2m"},{"type":"output","id":"99yQWtkJzDs6JTbEapFGk","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"2464","content_type":"text/plain"}}}],"key":"SD4MVd8mvn"}],"key":"wgszNA7vav"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_uni + f1_uni, Scalar(F(int(3))) * f0_uni\n","key":"FTy5OUPpft"},{"type":"output","id":"46q8icDzcDpDIKoWqTTus","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"(4 + x^2 + 4x^3, 3 + 6x + -3x^2 + 9x^3)","content_type":"text/plain"}}}],"key":"ZlSS6i2g5B"}],"key":"VPjYSPZeZw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"h = Scalar(vec_eq_l[0]) * f0_uni + Scalar(vec_eq_l[1]) * f1_uni  \\\n    + Scalar(vec_eq_l[2]) * f2_uni + Scalar(vec_eq_l[3]) * f3_uni\nh","key":"bzJKJcu0Qr"},{"type":"output","id":"T1VbI9Zy8uYdgrt0HBnRw","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"10 + -11x + 11x^2 + -10x^3","content_type":"text/plain"}}}],"key":"tDUYhCjN5q"}],"key":"yPLMwhFnM5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_mle, -f0_mle","key":"PHoha6FkQB"},{"type":"output","id":"nyIgXxKKP169uhmcXMW1s","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"(MLEPolynomial([1, 2, -1, 3], 2), MLEPolynomial([-1, -2, 1, -3], 2))","content_type":"text/plain"}}}],"key":"u2aU75QnyQ"}],"key":"Xci482LhMX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_mle - f1_mle, f0_mle, f1_mle","key":"vZtOvyW8ew"},{"type":"output","id":"5hZkwv4uwjXv3upQUF1R6","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"(MLEPolynomial([-2, 4, -3, 2], 2),\n MLEPolynomial([1, 2, -1, 3], 2),\n MLEPolynomial([3, -2, 2, 1], 2))","content_type":"text/plain"}}}],"key":"IiHEpcEhAi"}],"key":"SQS2nejIJA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"v = f_mle.evaluate(us)\nv","key":"lF2rsnw4Wn"},{"type":"output","id":"5BWRv40v4R75HBqBkLTsi","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"-13","content_type":"text/plain"}}}],"key":"kLz0cVTReA"}],"key":"Q1GF9r055g"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Prove evaluation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"biGL984KNM"}],"identifier":"id-2-prove-evaluation","label":"2. Prove evaluation","html_id":"id-2-prove-evaluation","implicit":true,"key":"viiA3ece5z"}],"key":"saEztBKYky"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"debug = 1\ntranscript = MerlinTranscript(b\"test-mercury-pcs\")\ntranscript.absorb(b\"commitment\", f_cm.cm)\ntranscript.absorb(b\"point\", us)\ntranscript.absorb(b\"value\", v)\n","key":"Cb3D33Cn8u"},{"type":"output","id":"0mJREV6CmcuyJMzY320Xe","data":[],"key":"i13YgjsTE8"}],"key":"AChEVxECyW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kGuyvHHULK"}],"identifier":"step-1","label":"Step 1","html_id":"step-1","implicit":true,"key":"QBdq5XxgiF"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"compute ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FbqWAtIl3W"},{"type":"inlineMath","value":"h(X)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"DbHzg6pzS9"}],"key":"uAOmBhBGKS"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"commit ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Sh0GYnpc76"},{"type":"inlineMath","value":"h(X)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"qQVVPFvzEE"}],"key":"JJLvoWiADO"}],"key":"bVVAyn0X6q"}],"key":"z2310lVFnI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"\nk = f_mle.num_var\nus_l = us[:k//2]\nus_r = us[k//2:]\nvec_eq_l = MLEPolynomial.eqs_over_hypercube(us_l)\nvec_eq_r = MLEPolynomial.eqs_over_hypercube(us_r)\nn_l = len(vec_eq_l) # column\nn_r = len(vec_eq_r) # row\nvec_eq_l, vec_eq_r","key":"xZi5elGsGn"},{"type":"output","id":"9tDMChMSuQCeVSmxumUtD","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"([-2, 4, 1, -2], [0, 3, 0, -2])","content_type":"text/plain"}}}],"key":"RRmcImmRm3"}],"key":"xej7ykfVsk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Compute h(X)\nh_coeffs = []\nfor i in range(n_r):\n    h_coeffs.append(sum([f_mle.evals[i*n_l+j] * vec_eq_l[j] for j in range(n_r)], F(int(0))))\nh_uni = UniPolynomial(h_coeffs)\nh_cm = kzg_pcs.commit(h_uni)\ntranscript.absorb(b\"h_cm\", h_cm.cm)\nh_cm","key":"N0scqVCFRz"},{"type":"output","id":"zQuz7Yl326KcdizQXjKPn","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"Commitment((341203988594841721703751627390561602518991312853592249390238506514023511558, 4570164882443154697207366432674390476737733102807743213900207502309583215167))","content_type":"text/plain"}}}],"key":"M5ciWg8ZmX"}],"key":"wfJzNzoX54"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: folded polynomial h(X)\")\n    coeffs = f_mle.evals\n    eqs = MLEPolynomial.eqs_over_hypercube(us)\n    lhs = inner_product(h_coeffs, vec_eq_r, F(int(0))) \n    rhs = inner_product(coeffs, eqs, F(int(0)))\n    assert lhs == rhs, f\"lhs: {lhs}, rhs: {rhs}\"\n    print(f\"P> check: folded polynomial h(X) passed\")\n","key":"b6abKbMT6I"},{"type":"output","id":"ADAb7LCZMsoVSY8iGt25B","data":[{"name":"stdout","output_type":"stream","text":"P> check: folded polynomial h(X)\nP> check: folded polynomial h(X) passed\n"}],"key":"LTXfovFBKS"}],"key":"Bmgm0sSOKD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CAEARDwUBB"}],"identifier":"step-2","label":"Step 2","html_id":"step-2","implicit":true,"key":"oUEybBYwXn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(a). get ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qvTXxGxlY4"},{"type":"inlineMath","value":"\\alpha\\in\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>∈</mo><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\alpha\\in\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Yq1tDOGaNH"},{"type":"text","value":" from the verifier","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TLHk4huJSn"}],"key":"vSvnyiqzoA"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"(b). compute ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pKt1I0EKXV"},{"type":"inlineMath","value":"q(X)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"OCG6SZwRm4"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JyTRmYKQKY"},{"type":"inlineMath","value":"g(X)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"RsVtHowlmC"},{"type":"text","value":", s.t.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fbNyfYbSBy"}],"key":"djDX9ZeDBa"}],"key":"Sf0T59ypdL"},{"type":"math","value":"f(X) = (X^b - \\alpha) * q(X) + g(X)","position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>X</mi><mi>b</mi></msup><mo>−</mo><mi>α</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>q</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(X) = (X^b - \\alpha) * q(X) + g(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"aVmmtkju49"}],"key":"mF8UFh3FC1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Step 2\n\nalpha = transcript.squeeze(Field, b\"alpha\", 4)\nalpha","key":"Dy2kF0xYOz"},{"type":"output","id":"CixD6C2ShhIQ_lvC215Jq","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"66954866","content_type":"text/plain"}}}],"key":"wavjqcRc60"}],"key":"K7nLO8eErC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def div_by_quadratic_binomial(coeffs, alpha, k):\n    num_col = 2**k\n    num_row = len(coeffs) // num_col\n    print(f\"num_col: {num_col}, num_row: {num_row}\")\n\n    q_coeffs = [F.zero()] * (num_col * (num_row-1))\n    r_coeffs = [F.zero()] * num_col\n    for j in range(num_col):\n        fi = coeffs[j::num_row]\n        qi, ri = UniPolynomial(fi).div_by_linear_divisor(alpha)\n        for i in range(num_row-1):\n            q_coeffs[j+i*num_row] = qi.coeffs[i]\n        r_coeffs[j] = ri\n    return q_coeffs, r_coeffs","key":"fOc6QUotWI"},{"type":"output","id":"9XIDpQgjAgZVM8OuaKPjK","data":[],"key":"YnfKN4PRz1"}],"key":"N931vn2Hmb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Compute q(X) and g(X)\n\nq_coeffs, g_coeffs = div_by_quadratic_binomial(f_mle.evals, alpha, 2)\nq_uni = UniPolynomial(q_coeffs)\ng_uni = UniPolynomial(g_coeffs)\nq_cm = kzg_pcs.commit(q_uni)\ng_cm = kzg_pcs.commit(g_uni)\nq_cm, g_cm","key":"yT0xl5BFOv"},{"type":"output","id":"L6rHPzBaXoZud7a3zchI5","data":[{"name":"stdout","output_type":"stream","text":"num_col: 4, num_row: 4\n"},{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/plain":{"content":"(Commitment((6873374277395425445538081471403900421153044372429899318315463318322988015074, 16690292592350444777928793433203390570537489251096203454692664097972278279727)),\n Commitment((12744849022295298739892606625958984031642490183242839912364573373366770170425, 10807392124513062104048213661706791445849571919278941606978474073386634973494)))","content_type":"text/plain"}}}],"key":"mOsxO94MoT"}],"key":"kiNoouKnBQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: quotient polynomial q(X) and remainder polynomial g(X)\")\n    q, r = UniPolynomial.polynomial_division_with_remainder(f_mle.evals, \n                            [-alpha, F(int(0)),  F(int(0)), F(int(0)), F(int(1))])\n    assert q == q_coeffs, f\"q: {q}, q_coeffs: {q_coeffs}\"\n    print(f\"P> check: quotient polynomial q(X) passed\")\n    assert r == g_coeffs, f\"r: {r}, r_coeffs: {g_coeffs}\"\n    print(f\"P> check: remainder polynomial g(X) passed\")","key":"Mz3RbalhuA"},{"type":"output","id":"uKNYnpmemCraSKMNal1Mo","data":[{"name":"stdout","output_type":"stream","text":"P> check: quotient polynomial q(X) and remainder polynomial g(X)\nP> check: quotient polynomial q(X) passed\nP> check: remainder polynomial g(X) passed\n"}],"key":"vdASuP1Kv4"}],"key":"oXw1vc78BX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Commit and send q(X) and g(X)\n\ntranscript.absorb(b\"q_cm\", q_cm.cm)\ntranscript.absorb(b\"g_cm\", g_cm.cm)","key":"HUxMJZxS9l"},{"type":"output","id":"Xke31Mr6UjJ70IXCtVWRi","data":[],"key":"VnmbPR7BIL"}],"key":"HQqif4acZi"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v3Dylo4GLn"}],"identifier":"step-3","label":"Step 3","html_id":"step-3","implicit":true,"key":"ULGBbnVIQ5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(a). Get ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VlQ3lr6rZU"},{"type":"inlineMath","value":"\\gamma\\in\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi><mo>∈</mo><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\gamma\\in\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IiV8sredon"},{"type":"text","value":" from the verifier","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nHhdg1N0pk"}],"key":"OJ5t3MOWk1"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"(b). Compute ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rPrgOdyuy0"},{"type":"inlineMath","value":"s(X)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">s(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"wPoyUDwsq0"},{"type":"text","value":" and send its commitment ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lrvDxiwpiv"},{"type":"inlineMath","value":"C_s","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fgfN8zkN1c"}],"key":"DxxcRTBQ17"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"(c). Compute ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"z5Dr1RzLUy"},{"type":"inlineMath","value":"d(X)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"bNlAq71jX5"},{"type":"text","value":" and send its commitment ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B9GEnLWLsX"},{"type":"inlineMath","value":"C_d","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"v59XPzgAjz"}],"key":"iurPPndv3a"}],"key":"FRNr7AANl2"}],"key":"LtsDA10XQd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"gamma = transcript.squeeze(Field, b\"gamma\", 4)\ngamma, type(gamma)","key":"vL3wk3Pq5H"},{"type":"output","id":"E1oNaUdWjut7ED6sqK990","data":[{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"text/plain":{"content":"(89040678, <class 'curve.Fr'>)","content_type":"text/plain"}}}],"key":"voVLLfTpsj"}],"key":"U9uDTezOvT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def compute_product_poly(a: list[Field], b: list[Field]):\n    assert len(a) == len(b), \"Length of a and b must be the same\"\n    l = len(a)\n    s = [F.zero()] * (l-1)\n    dot_product = F.zero()\n    for i in range(l):\n        for j in range(l):\n            if abs(i-j) == 0:\n                dot_product += a[i] * b[j]\n            else:\n                s[abs(i-j)-1] += a[i] * b[j]\n    return s, dot_product","key":"VGFMlrVVOo"},{"type":"output","id":"9sD40cDVhMM_xbEk-h87_","data":[],"key":"NK6X9yxKL1"}],"key":"PbmYecHxba"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Compute s1(X) and s2(X), and send [s(X)]\n#\n#  where s(X) = s1(X) + gamma * s2(X)\n\ns1_coeffs, v1 = compute_product_poly(g_coeffs, vec_eq_l)\ns2_coeffs, v2 = compute_product_poly(h_coeffs, vec_eq_r)\ns1_uni = UniPolynomial(s1_coeffs)\ns2_uni = UniPolynomial(s2_coeffs)\ns_uni = s1_uni + Scalar(gamma) * s2_uni\ns_cm = kzg_pcs.commit(s_uni)\ns_cm","key":"yYLUN5qvLu"},{"type":"output","id":"mPkLgq8-GGjqnDs054fZp","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"text/plain":{"content":"Commitment((196218153828482921355178233114718791152912307737878072738063461265417166874, 394014398374792061255415805359155323151193649000371028071552966415569233135))","content_type":"text/plain"}}}],"key":"ZcFeYcbPYn"}],"key":"nChqrnHNCX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: s1(X) and s2(X)\")\n    assert v2 == v, f\"v2: {v2}, v: {v}\"\n    assert v1 == h_uni.evaluate(alpha), f\"v1: {v1}, h_uni.evaluate(alpha): {h_uni.evaluate(alpha)}\"\n    z = F.rand()\n    z_inv = int(1)/z\n    g_uni = UniPolynomial(g_coeffs)\n    p1_uni = UniPolynomial(vec_eq_l)\n    h_uni = UniPolynomial(h_coeffs)\n    p2_uni = UniPolynomial(vec_eq_r)\n    s1_uni = UniPolynomial(s1_coeffs)\n    s2_uni = UniPolynomial(s2_coeffs)\n    assert g_uni.evaluate(z) * p1_uni.evaluate(z_inv) + g_uni.evaluate(z_inv) * p1_uni.evaluate(z) \\\n        == F(int(2))*v1 + z*s1_uni.evaluate(z) + z_inv*s1_uni.evaluate(z_inv)\n    print(f\"P> check: s1(X) passed\")\n    assert h_uni.evaluate(z) * p2_uni.evaluate(z_inv) + h_uni.evaluate(z_inv) * p2_uni.evaluate(z) \\\n        == F(int(2))*v2 + z*s2_uni.evaluate(z) + z_inv*s2_uni.evaluate(z_inv)\n    print(f\"P> check: s2(X) passed\")\n\n","key":"btSX6E3oJK"},{"type":"output","id":"9xaIsMNP9P8T7WHEpO66F","data":[{"name":"stdout","output_type":"stream","text":"P> check: s1(X) and s2(X)\nP> check: s1(X) passed\nP> check: s2(X) passed\n"}],"key":"iy21589x9A"}],"key":"tJt5Tfelt3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Compute d(X) where d(X) = X^{l-1} * g(1/X)\n\nd_coeffs = g_coeffs[::-1]\nd_uni = UniPolynomial(d_coeffs)\nd_cm = kzg_pcs.commit(d_uni)\nd_cm","key":"V6iTkI2bgZ"},{"type":"output","id":"SzK7qrtHf2ifhb6CDsX3M","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"Commitment((411548608121372520815472318385633818999017454145389265932878881921792672285, 11683702693697689722457230903516371286641048263922663281742983635724242819079))","content_type":"text/plain"}}}],"key":"qbZJWtEEFI"}],"key":"mpCnC2hcwy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: d(X)\")\n    z = F.rand()\n    z_inv = int(1)/z\n    d_uni = UniPolynomial(d_coeffs)\n    g_uni = UniPolynomial(g_coeffs)\n    lhs = d_uni.evaluate(z)\n    assert lhs == z^(int(n_l)-int(1)) * g_uni.evaluate(z_inv)\n    print(f\"P> check: d(X) passed\")","key":"MptdpYC3mg"},{"type":"output","id":"txeHuHmQXPXO9glJwn6ma","data":[{"name":"stdout","output_type":"stream","text":"P> check: d(X)\nP> check: d(X) passed\n"}],"key":"GCltw0LN4P"}],"key":"ySytZgCR4h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"transcript.absorb(b\"s_cm\", s_cm.cm)\ntranscript.absorb(b\"d_cm\", d_cm.cm)","key":"jKnnVgZbXV"},{"type":"output","id":"RerElpbRrY0m-4McqlxEp","data":[],"key":"g1WpGhenR7"}],"key":"HezdsskwZg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XJSUWraggf"}],"identifier":"step-4","label":"Step 4","html_id":"step-4","implicit":true,"key":"XorWWOt9is"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(a). Get ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yl1DVyjrey"},{"type":"inlineMath","value":"\\zeta\\in\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ζ</mi><mo>∈</mo><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\zeta\\in\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"CnubvNmElk"},{"type":"text","value":" from the verifier","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jStWB0FYd6"}],"key":"CGTmaqzNVn"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"(b). Compute and send ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"S5fP5VafS5"},{"type":"inlineMath","value":"g(\\zeta), g(1/\\zeta), h(\\zeta), h(1/\\zeta), s(\\zeta), s(1/\\zeta)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>s</mi><mo stretchy=\"false\">(</mo><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>s</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>ζ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(\\zeta), g(1/\\zeta), h(\\zeta), h(1/\\zeta), s(\\zeta), s(1/\\zeta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span></span></span></span>","key":"p1bikrr6He"},{"type":"text","value":" and send them to the verifier","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jU6FdW5PBH"}],"key":"e9Noz1127Z"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"(c). Compute the quotient polynomial ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Jzn3wWbWqF"},{"type":"inlineMath","value":"t(X)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">t(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"XaJNVCdkXT"},{"type":"text","value":" and send its commitment ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WkSwYKrAmF"},{"type":"inlineMath","value":"C_t","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gY5YHuxX55"}],"key":"kokcJv7YMm"}],"key":"sVWHJ3rmU7"},{"type":"math","value":"t(X) = \\frac{f(X) - q(X)(z^b - \\alpha) - g(\\zeta)}{X - \\zeta}","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>t</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>q</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mi>b</mi></msup><mo>−</mo><mi>α</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>ζ</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>X</mi><mo>−</mo><mi>ζ</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">t(X) = \\frac{f(X) - q(X)(z^b - \\alpha) - g(\\zeta)}{X - \\zeta}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4065em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","key":"th7Fj1TF4b"}],"key":"eByoed2uL6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"zeta = transcript.squeeze(Field, b\"zeta\", 4)\nzeta_inv = zeta.inv()","key":"H8cKuDds5U"},{"type":"output","id":"eyARkbd9IpXMF5lvfFtxV","data":[],"key":"QlFZHVw2BE"}],"key":"FtVYydXfzZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"g_at_zeta = g_uni.evaluate(zeta)\ng_at_zeta_inv = g_uni.evaluate(zeta_inv)\nh_at_zeta = h_uni.evaluate(zeta)\nh_at_zeta_inv = h_uni.evaluate(zeta_inv)\ns_at_zeta = s_uni.evaluate(zeta)\ns_at_zeta_inv = s_uni.evaluate(zeta_inv)","key":"kAGcRWzcJV"},{"type":"output","id":"AsT2KSq106LOdrlHTQly-","data":[],"key":"Zync6lcBNR"}],"key":"YEHiN8OXiL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"u = f_uni - q_uni * Scalar(zeta^n_l - alpha) - Scalar(g_at_zeta)\nu","key":"QNWgiWimOK"},{"type":"output","id":"-YWJxdr3uVcmDN0ICWiN2","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"-320010484181115610812123662559302472706056545349919408 + -103508575654681906348588614540275275117858512989098647x + 207017140487745510874267438536765553073217321966678577x^2 + -310525719234318449659817744109557372277347152542366849x^3 + -4637836421663923373260987705813334791825921673x^4 + -1545945527763164405815148009344596766480018702x^5 + 3091890893900758967445839696468738025345902976x^6 + -4637836467842657614456546655019179222572817225x^7 + -69268101361793338423808766646120343326x^8 + -23089367120597779474602922215373447773x^9 + 46178734241195558949205844430746895553x^10 + -69268101361793338423808766646120343324x^11 + 3x^12 + x^13 + -2x^14 + 3x^15","content_type":"text/plain"}}}],"key":"Y8lwdYJGk9"}],"key":"JRdCrEqjeu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"t_uni, t_eval = u.div_by_linear_divisor(zeta)\nt_cm = kzg_pcs.commit(t_uni)\nt_cm, t_eval\n","key":"PlwPc0yFre"},{"type":"output","id":"JJ_8cWWmui_R58Q5b9Pot","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"(Commitment((7564077621549655343295293161727763898648355577163371329825382307061906824629, 20961728419572618406325587578344293151556639381818099483799713097095237121275)),\n 0)","content_type":"text/plain"}}}],"key":"y6SoVoz0Nk"}],"key":"zUmev3um4h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: quotient polynomial t(X)\")\n    assert t_eval == Field.zero(), f\"t_eval: {t_eval}\"\n    z = F.rand()\n    t_z = t_uni.evaluate(z)\n    f_z = f_uni.evaluate(z)\n    q_z = q_uni.evaluate(z)\n    assert t_z * (z - zeta) == f_z - q_z * (zeta^n_l - alpha) - g_at_zeta\n    print(f\"P> check: quotient polynomial t(X) passed\")\n","key":"aqMdMhrEUJ"},{"type":"output","id":"zXz4wexvNIpu2dZUktUVZ","data":[{"name":"stdout","output_type":"stream","text":"P> check: quotient polynomial t(X)\nP> check: quotient polynomial t(X) passed\n"}],"key":"BhfVUs8Ypo"}],"key":"UMs1qVNLli"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: C_t\")\n    g_G1 = kzg_pcs.params['g']\n    h_G2 = kzg_pcs.params['h']\n    h_tau_G2 = kzg_pcs.params['tau_h']\n    lhs1 = f_cm.cm + t_cm.cm.ec_mul(zeta) - q_cm.cm.ec_mul(zeta^n_l - alpha) - g_G1.ec_mul(g_at_zeta)\n    lhs2 = h_G2\n    rhs1 = t_cm.cm\n    rhs2 = h_tau_G2\n    print(f\"type(lhs1)= {type(lhs1)}, type(lhs2)= {type(lhs2)}, type(rhs1)= {type(rhs1)}, type(rhs2)= {type(rhs2)}\")\n    checked = ec_pairing_check([lhs1, rhs1], [-lhs2, rhs2])\n    assert checked, \"C_t is not valid\"\n    print(f\"P> check: C_t passed\")\n","key":"cScVRvLbUq"},{"type":"output","id":"36HsiQ8YyhgUauQFhVh6G","data":[{"name":"stdout","output_type":"stream","text":"P> check: C_t\ntype(lhs1)= <class 'curve.G1Point'>, type(lhs2)= <class 'curve.G2Point'>, type(rhs1)= <class 'curve.G1Point'>, type(rhs2)= <class 'curve.G2Point'>\nP> check: C_t passed\n"}],"key":"b6E6vWhVkf"}],"key":"ESGksMrUQs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"transcript.absorb(b\"t_cm\", t_cm.cm)\ntranscript.absorb(b\"g_at_zeta\", g_at_zeta)\ntranscript.absorb(b\"g_at_zeta_inv\", g_at_zeta_inv)\ntranscript.absorb(b\"h_at_zeta\", h_at_zeta)\ntranscript.absorb(b\"h_at_zeta_inv\", h_at_zeta_inv)\ntranscript.absorb(b\"s_at_zeta\", s_at_zeta)\ntranscript.absorb(b\"s_at_zeta_inv\", s_at_zeta_inv)","key":"zxKGj5glVa"},{"type":"output","id":"tqKgnmazxgZtHR9EI2KgC","data":[],"key":"jWaCBDaQvc"}],"key":"hBzrq83cIF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qSQeIvZOpW"}],"identifier":"step-5","label":"Step 5","html_id":"step-5","implicit":true,"key":"tx79tCS4Va"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Aggregate the evaluation proofs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XjnP6O5Zm4"}],"key":"YErgLC4T4O"}],"key":"STYvoOQlv7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Aggregate the evaluation proofs\n\neta = transcript.squeeze(Field, b\"eta\", 4)\n\na_uni = g_uni + Scalar(eta) * h_uni + Scalar(eta*eta) * s_uni\na_at_zeta_inv, a_at_zeta_inv_arg = kzg_pcs.prove_evaluation(a_uni, zeta_inv)\n\na_uni += Scalar(eta*eta*eta) * d_uni\na_at_zeta, a_at_zeta_arg = kzg_pcs.prove_evaluation(a_uni, zeta)\n\nh_uni_at_alpha, h_at_alpha_arg = kzg_pcs.prove_evaluation(h_uni, alpha)\na_at_zeta_arg, a_at_zeta_inv_arg, h_at_alpha_arg\n\n","key":"zFV2Lj25rc"},{"type":"output","id":"lI_GuckCIHR53V747SHd7","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"({'w_cm': Commitment((15522446906494288407282696648261850622287101021721313436696028069912532784720, 603214464022950610669451026422499576356824841616091783390441425826994905145))},\n {'w_cm': Commitment((21807297083416410354924359503853066118819031366858090987581267815333402259120, 3665392969967324964834023121604975099446719084408716190589686241189390173360))},\n {'w_cm': Commitment((19277402036953961621331476720166919837657448960632489771751307109877544454558, 14785722924673158890380759949870394812979469962011416906141661546783155852289))})","content_type":"text/plain"}}}],"key":"LZwJDymljy"}],"key":"kKnGPnjF8V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: h(alpha)\")\n    p1_uni = UniPolynomial(vec_eq_l)\n    p2_uni = UniPolynomial(vec_eq_r)\n    p1_at_zeta = p1_uni.evaluate(zeta)\n    p2_at_zeta = p2_uni.evaluate(zeta)\n    p1_at_zeta_inv = p1_uni.evaluate(zeta_inv)\n    p2_at_zeta_inv = p2_uni.evaluate(zeta_inv)\n    h_alpha = (h_at_zeta * p2_at_zeta_inv) + (h_at_zeta_inv * p2_at_zeta) - v - v\n    h_alpha *= gamma \n    h_alpha += (g_at_zeta * p1_at_zeta_inv) + (g_at_zeta_inv * p1_at_zeta)\n    h_alpha -= zeta * s_at_zeta + zeta_inv * s_at_zeta_inv\n\n    d_at_zeta = zeta^(int(n_l-1)) * g_at_zeta_inv\n    assert d_at_zeta == d_uni.evaluate(zeta), f\"d_at_zeta: {d_at_zeta}, d_uni.evaluate(zeta): {d_uni.evaluate(zeta)}\"\n    assert h_uni_at_alpha * Field(int(2)) == h_alpha, f\"h_uni_at_alpha: {h_uni_at_alpha}, h_alpha: {h_alpha}\"\n    print(f\"P> check: h(alpha) passed\")\n","key":"pMW2WsJKub"},{"type":"output","id":"2h4YiQn4vRmBUbkj-m4dY","data":[{"name":"stdout","output_type":"stream","text":"P> check: h(alpha)\nP> check: h(alpha) passed\n"}],"key":"qhCOv2PlQD"}],"key":"FegDQZU8Mi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: aggregate evaluation proofs\")\n    C_a = g_cm.cm + h_cm.cm.ec_mul(eta) + s_cm.cm.ec_mul(eta*eta) \n    checked1 = kzg_pcs.verify_evaluation(Commitment(C_a), zeta_inv, a_at_zeta_inv, a_at_zeta_inv_arg)\n    C_a += d_cm.cm.ec_mul(eta*eta*eta)\n    checked2 = kzg_pcs.verify_evaluation(Commitment(C_a), zeta, a_at_zeta, a_at_zeta_arg)\n    assert checked1 and checked2, f\"checked1: {checked1}, checked2: {checked2}\"\n    checked3 = kzg_pcs.verify_evaluation(h_cm, alpha, h_uni_at_alpha, h_at_alpha_arg)\n    assert checked3, f\"checked3: {checked3}\"\n    print(f\"P> check: aggregate evaluation proofs passed\")","key":"itEi9rmLUz"},{"type":"output","id":"dPL-xyeQnV_wdcY_1Tb3v","data":[{"name":"stdout","output_type":"stream","text":"P> check: aggregate evaluation proofs\nP> check: aggregate evaluation proofs passed\n"}],"key":"mtHsvkEDve"}],"key":"PigJzF1Ad3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"ff = UniPolynomial([F(int(2)), F(int(6)), F(int(10)), F(int(14))])\nff.evaluate(F(int(3194597718)))\n","key":"KF4cBBcWDw"},{"type":"output","id":"QQ2KiI9tZFnvBxsnkxih2","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"456432506869271084770462484798","content_type":"text/plain"}}}],"key":"qJdjsCqC4d"}],"key":"HKIFk0hz5g"}],"key":"EpXPWSC37m"},"references":{"cite":{"order":[],"data":{}}}}