{"version":2,"kind":"Notebook","sha256":"cb1caa058ef1b71ea395a43de768889a67619e21309d71ce4d3a6d443a69ca12","slug":"src.mercury-pcs","location":"/src/mercury_pcs.ipynb","dependencies":[],"frontmatter":{"title":"2. Prove evaluation","content_includes_title":true,"kernelspec":{"name":"SageMath-10.4","display_name":"SageMath 10.4","language":"sage"},"github":"https://github.com/executablebooks/jupyter-book","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/executablebooks/jupyter-book/blob/main/src/mercury_pcs.ipynb","exports":[{"format":"ipynb","filename":"mercury_pcs.ipynb","url":"/mercury_pcs-460a17e6d61574a69c40c6409dfb3ecb.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"from curve import Fr as Field, ec_mul, G1Point as G1\nfrom merlin.merlin_transcript import MerlinTranscript\nfrom mle2 import MLEPolynomial\nfrom utils import log_2, log_2_ceiling, is_power_of_two, prime_field_inv, Scalar\nfrom kzg10_non_hiding2 import Commitment, KZG10_PCS\nfrom curve import Fr as Field, G1Point as G1, G2Point as G2, ec_pairing_check\nfrom unipoly2 import UniPolynomial, UniPolynomialWithFft\nfrom typing import TypeVar, Union, Optional\nfrom random import Random, randint","key":"xbXM8cxHwA"},{"type":"output","id":"e9mcsWoCSN3CUNjlaeJJk","data":[],"key":"DPTNcDHIQG"}],"key":"K7MYkE6bgE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"BN254_Fr = GF(Field.field_modulus); BN254_Fr","key":"FzP8C563up"},{"type":"output","id":"VChpd1hkAZutuuGJjC__N","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"Finite Field of size 21888242871839275222246405745257275088548364400416034343698204186575808495617","content_type":"text/plain"}}}],"key":"xBmC4GNTJ6"}],"key":"X8W9rX9tEp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"Rp.<X> = BN254_Fr[]\nB_mono = [X^i for i in range(0, 1024)]\ndef poly(cof, B=B_mono):\n    return reduce(lambda acc, e: acc + e, [BN254_Fr(int(a)) * b for a, b in zip(cof, B)])\n    \ndef powers(u, k):\n    return [u^i for i in range(0, 2**k)]\n    \ndef eval(f, D):\n    n = len(D)\n    k = log_2_ceiling(n)\n    return [poly(f, powers(D[i], k)) for i in range(0, n)]\nF = Field\n","key":"wzYznuo809"},{"type":"output","id":"hUUGZ_l3RIS_sBceL-Eki","data":[],"key":"t3mcbNU95y"}],"key":"iv4M89Voah"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"kzg_pcs = KZG10_PCS(G1, G2, Field, 20, debug=True)","key":"QGHwncutDf"},{"type":"output","id":"A6mqytge2D7sE7qH4vJm4","data":[],"key":"ZBaqx6SZjn"}],"key":"nXLN9nAV7Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def commit(f: MLEPolynomial):\n    evals = f.evals\n    f_cm = kzg_pcs.commit(UniPolynomial(evals))\n    return f_cm","key":"hVfU4lhtx8"},{"type":"output","id":"yOAkttze4rWQm5DA0y2YO","data":[],"key":"zqjUbleKQ4"}],"key":"v4mUjldNaE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"tr = MerlinTranscript(b\"test-mercury-pcs\")","key":"TWkQ4Twqm9"},{"type":"output","id":"_N-XtLATy0DeVGdx9kZb6","data":[],"key":"HLj4IqOwSu"}],"key":"e23p0S5Yth"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f_mle = MLEPolynomial([F(int(1)), F(int(3)), F(int(2)), F(int(1)),\n                    F(int(2)), F(int(-2)), F(int(1)), F(int(0)),\n                    F(int(-1)), F(int(2)), F(int(3)), F(int(1)),\n                    F(int(3)), F(int(1)), F(int(-2)), F(int(3))], 4)\nf_cm = commit(f_mle)\nus = [F(int(2)), F(int(-1)), F(int(1)), F(int(-2))]\nv = f_mle.evaluate(us)\nv\n","key":"HMmtAKDy1j"},{"type":"output","id":"ejqnjN3JvpSY_S7DG1OC3","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"-13","content_type":"text/plain"}}}],"key":"OPg9EykHLO"}],"key":"ulTtLx98Un"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"k = f_mle.num_var\nus_l = us[:k//2]\nus_r = us[k//2:]\nvec_eq_l = MLEPolynomial.eqs_over_hypercube(us_l)\nvec_eq_r = MLEPolynomial.eqs_over_hypercube(us_r)\nn_l = len(vec_eq_l) # column\nn_r = len(vec_eq_r) # row\nvec_eq_l, vec_eq_r\n","key":"X6ROvmks3U"},{"type":"output","id":"iC4x_vYbYjDoyPK7Sb9ti","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"([-2, 4, 1, -2], [0, 3, 0, -2])","content_type":"text/plain"}}}],"key":"axKfT7nfHw"}],"key":"t7Q3oxMQ9S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"alpha = F(int(3))\nalpha_exp_4 = F(int(3^4))","key":"v8xohUv17C"},{"type":"output","id":"Gd9qRLIoDOyaVnJFNgbj4","data":[],"key":"LDYJBrrrND"}],"key":"cNlft8Y2ms"},{"type":"block","kind":"notebook-content","children":[{"type":"math","value":"\\tilde{f}(X_0, X_1, X_2, X_3) = \n\\begin{bmatrix}\n1 & X_2 & X_3 & X_2X_3 \\\\\n\\end{bmatrix}\n\\begin{bmatrix}\nc_0 & c_1 & c_2 & c_3 \\\\\nc_4 & c_5 & c_6 & c_7 \\\\\nc_8 & c_9 & c_{10} & c_{11} \\\\\nc_{12} & c_{13} & c_{14} & c_{15}\n\\end{bmatrix}\n\\begin{bmatrix}\n1 \\\\\nX_0 \\\\\nX_1 \\\\\nX_0X_1 \\\\\n\\end{bmatrix}","position":{"start":{"line":1,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>f</mi><mo>~</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>X</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>X</mi><mn>3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>X</mi><mn>2</mn></msub><msub><mi>X</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>3</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>4</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>5</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>6</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>7</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>8</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>9</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>10</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>11</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>13</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>14</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>15</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>X</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>X</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>X</mi><mn>0</mn></msub><msub><mi>X</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\tilde{f}(X_0, X_1, X_2, X_3) = \n\\begin{bmatrix}\n1 &amp; X_2 &amp; X_3 &amp; X_2X_3 \\\\\n\\end{bmatrix}\n\\begin{bmatrix}\nc_0 &amp; c_1 &amp; c_2 &amp; c_3 \\\\\nc_4 &amp; c_5 &amp; c_6 &amp; c_7 \\\\\nc_8 &amp; c_9 &amp; c_{10} &amp; c_{11} \\\\\nc_{12} &amp; c_{13} &amp; c_{14} &amp; c_{15}\n\\end{bmatrix}\n\\begin{bmatrix}\n1 \\\\\nX_0 \\\\\nX_1 \\\\\nX_0X_1 \\\\\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1813em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span><span style=\"top:-3.6134em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0833em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">13</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">10</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">14</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">7</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">15</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"AwW7CNVkHl"}],"key":"x1krq7TLDW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f_mle.evals","key":"IQyvTw3gOv"},{"type":"output","id":"V2PsFOy99rmS0ZNXRS9kL","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"[1, 3, 2, 1, 2, -2, 1, 0, -1, 2, 3, 1, 3, 1, -2, 3]","content_type":"text/plain"}}}],"key":"gVVLPJAG3u"}],"key":"V521Cm5edj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"[f_mle.evals[i:i+4] for i in range(0, len(f_mle.evals), 4)]\n","key":"eV9BeCmRCp"},{"type":"output","id":"DYLotlyqQ36f32KRu4yXg","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"[[1, 3, 2, 1], [2, -2, 1, 0], [-1, 2, 3, 1], [3, 1, -2, 3]]","content_type":"text/plain"}}}],"key":"Tefsn12SZU"}],"key":"cRAPmmNWHf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"h_evals = []\nfor j in range(n_l):\n    h_evals.append([f_mle.evals[j+i*n_l] for i in range(n_r)] )\nh_evals\n","key":"LvA7kPtzmn"},{"type":"output","id":"_7TpeNJQ1LwpYtdg_xuNx","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"[[1, 2, -1, 3], [3, -2, 2, 1], [2, 1, 3, -2], [1, 0, 1, 3]]","content_type":"text/plain"}}}],"key":"gs8ToUn73b"}],"key":"e0gxsDvu98"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_mle = MLEPolynomial(h_evals[0], 2)\nf1_mle = MLEPolynomial(h_evals[1], 2)\nf2_mle = MLEPolynomial(h_evals[2], 2)\nf3_mle = MLEPolynomial(h_evals[3], 2)\nf0_mle.evals, f1_mle.evals, f2_mle.evals, f3_mle.evals\n","key":"FNEdj4jZAt"},{"type":"output","id":"vW01RnByeYZ6WVo208Kwh","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"([1, 2, -1, 3], [3, -2, 2, 1], [2, 1, 3, -2], [1, 0, 1, 3])","content_type":"text/plain"}}}],"key":"RN4k0TcWhs"}],"key":"MoPuS1ex0O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_poly = poly(f0_mle.evals)\nf1_poly = poly(f1_mle.evals)\nf2_poly = poly(f2_mle.evals)\nf3_poly = poly(f3_mle.evals)\n","key":"DvGr8cGVEL"},{"type":"output","id":"dbVNQdsIy1SnL-Y-4B_sh","data":[],"key":"LucBfidaoI"}],"key":"sAlgDvisyP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_uni = UniPolynomial(f0_mle.evals)\nf1_uni = UniPolynomial(f1_mle.evals)\nf2_uni = UniPolynomial(f2_mle.evals)\nf3_uni = UniPolynomial(f3_mle.evals)\nf_uni = UniPolynomial(f_mle.evals)\nf_uni, f_uni.evaluate(F(int(3)))","key":"mn5xWd1OAM"},{"type":"output","id":"wytmyGGIsc6209GcG612e","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"(1 + 3x + 2x^2 + x^3 + 2x^4 + -2x^5 + x^6 + -1x^8 + 2x^9 + 3x^10 + x^11 + 3x^12 + x^13 + -2x^14 + 3x^15,\n 37056988)","content_type":"text/plain"}}}],"key":"G46MWzFGXo"}],"key":"BZG0jmHTF5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_uni.evaluate(F(int(3^4))) + F(int(3)) * f1_uni.evaluate(F(int(3^4))) + F(int(3^2)) * f2_uni.evaluate(F(int(3^4))) + F(int(3^3)) * f3_uni.evaluate(F(int(3^4)))","key":"KOW5LX38y7"},{"type":"output","id":"hlYSXyHcpe4e-1-ukeq8W","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"37056988","content_type":"text/plain"}}}],"key":"zKFBiIZgO5"}],"key":"Yk0vZn7N5I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f_poly = (f0_poly(X^4) + X*f1_poly(X^4) + X^2*f2_poly(X^4) + X^3*f3_poly(X^4))\nf_poly, f_poly(BN254_Fr(int(3)))\n","key":"InxvLfVEKx"},{"type":"output","id":"hADgSz7fpcLz8OZC6-a3_","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"(3*X^15 + 21888242871839275222246405745257275088548364400416034343698204186575808495615*X^14 + X^13 + 3*X^12 + X^11 + 3*X^10 + 2*X^9 + 21888242871839275222246405745257275088548364400416034343698204186575808495616*X^8 + X^6 + 21888242871839275222246405745257275088548364400416034343698204186575808495615*X^5 + 2*X^4 + X^3 + 2*X^2 + 3*X + 1,\n 37056988)","content_type":"text/plain"}}}],"key":"B14AhlE66f"}],"key":"gETsjATW9Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q_poly = f_poly // (X^4-3)\nr_poly = f_poly % (X^4-3)\nq_poly, r_poly\n","key":"CfqTajYl94"},{"type":"output","id":"BxJscZywT61UJxiq-u4T9","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"(3*X^11 + 21888242871839275222246405745257275088548364400416034343698204186575808495615*X^10 + X^9 + 3*X^8 + 10*X^7 + 21888242871839275222246405745257275088548364400416034343698204186575808495614*X^6 + 5*X^5 + 8*X^4 + 30*X^3 + 21888242871839275222246405745257275088548364400416034343698204186575808495609*X^2 + 13*X + 26,\n 91*X^3 + 21888242871839275222246405745257275088548364400416034343698204186575808495595*X^2 + 42*X + 79)","content_type":"text/plain"}}}],"key":"EQIJ5QBv3B"}],"key":"mdwDgv9Qyp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q_poly(BN254_Fr(int(alpha))), r_poly(BN254_Fr(int(alpha)))","key":"ejZRA0BFgm"},{"type":"output","id":"1cH4ESegogOkH1Ebg2Ktj","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"(475058, 2464)","content_type":"text/plain"}}}],"key":"VexNzPX2Aj"}],"key":"cTpAkdB2B3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Check if f[0..3] are correct\nx_uni = UniPolynomial([F(int(0)), F(int(1))])\n\nf_alt_eval_at_alpha = f0_uni.evaluate(alpha_exp_4) \\\n    + (f1_uni.evaluate(alpha_exp_4)*alpha) \\\n    + (f2_uni.evaluate(alpha_exp_4)*alpha*alpha) \\\n    + (f3_uni.evaluate(alpha_exp_4) * alpha*alpha*alpha)\nf_alt_eval_at_alpha","key":"k8129xWBJA"},{"type":"output","id":"E50c8Kjz9p-6MkRsKyZcq","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"37056988","content_type":"text/plain"}}}],"key":"zCFL2YKq2B"}],"key":"vMYTklokdD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q0_uni, r0 = f0_uni.div_by_linear_divisor(alpha)\nq1_uni, r1 = f1_uni.div_by_linear_divisor(alpha)\nq2_uni, r2 = f2_uni.div_by_linear_divisor(alpha)\nq3_uni, r3 = f3_uni.div_by_linear_divisor(alpha)\nq0_uni, r0, q1_uni, r1, q2_uni, r2, q3_uni, r3\n","key":"iLZjBfClgm"},{"type":"output","id":"_4_FdahMpkpXk1EfzOmp3","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"(26 + 8x + 3x^2,\n 79,\n 13 + 5x + x^2,\n 42,\n -8 + -3x + -2x^2,\n -22,\n 30 + 10x + 3x^2,\n 91)","content_type":"text/plain"}}}],"key":"rQ4mFcIeLG"}],"key":"K6XOBb59na"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"r0 == f0_uni.evaluate(alpha), r1 == f1_uni.evaluate(alpha), r2 == f2_uni.evaluate(alpha), r3 == f3_uni.evaluate(alpha)\n","key":"ln9iGsLlCM"},{"type":"output","id":"S5k2hJlh8xcTs02z60jv6","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(True, True, True, True)","content_type":"text/plain"}}}],"key":"PUJs3hm0XS"}],"key":"TyLIbATTiq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Construct q(X)\n#\n#   q(X) = q0(X^4) + X*q1(X^4) + X^2*q2(X^4) + X^3*q3(X^4)\n#   \n#  Or, the coefficients of q(X) are:\n#\n#   [q0[0], q1[0], q2[0], q3[0], \n#    q0[1], q1[1], q2[1], q3[1], \n#    q0[2], q1[2], q2[2], q3[2]]\n#\n#  Please note that deg(q) < 12\n\nq_coeffs = []\nfor i in range(len(q0_uni.coeffs)):\n    q_coeffs.append(q0_uni.coeffs[i])\n    q_coeffs.append(q1_uni.coeffs[i])\n    q_coeffs.append(q2_uni.coeffs[i])\n    q_coeffs.append(q3_uni.coeffs[i])\nq_uni = UniPolynomial(q_coeffs)\nq_uni.evaluate(alpha), q_coeffs","key":"CxQww6DKLT"},{"type":"output","id":"vGUzzSAR_Etgf5N3UKiWA","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"(475058, [26, 13, -8, 30, 8, 5, -3, 10, 3, 1, -2, 3])","content_type":"text/plain"}}}],"key":"zHwmJbAoiE"}],"key":"VwWY2yK6c5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def compute_quotient(coeffs, k):\n    num_col = 2**k\n    num_row = len(coeffs) // num_col\n    print(f\"num_col: {num_col}, num_row: {num_row}\")\n\n    q_coeffs = [F.zero()] * (num_col * (num_row-1))\n    for j in range(num_col):\n        fi = coeffs[j::num_row]\n\n        qi, ri = UniPolynomial(fi).div_by_linear_divisor(alpha)\n        for i in range(num_row-1):\n            q_coeffs[j+i*num_row] = qi.coeffs[i]\n    return q_coeffs\n\n","key":"dSctYOeMQC"},{"type":"output","id":"yL3Ujd8ebeOX5tTWum0fJ","data":[],"key":"Zmo5pJdcbb"}],"key":"eww102NXVV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"compute_quotient(f_uni.coeffs, 2)","key":"m6rljKNcEa"},{"type":"output","id":"DBzoP3lmCSZB5NW8k2Elw","data":[{"name":"stdout","output_type":"stream","text":"num_col: 4, num_row: 4\n"},{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"[26, 13, -8, 30, 8, 5, -3, 10, 3, 1, -2, 3]","content_type":"text/plain"}}}],"key":"IbNNUw8yM2"}],"key":"G6E2TERXCk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q_eval_at_alpha = q0_uni.evaluate(alpha_exp_4) \\\n    + (q1_uni.evaluate(alpha_exp_4)*alpha) \\\n    + (q2_uni.evaluate(alpha_exp_4)*alpha*alpha) \\\n    + (q3_uni.evaluate(alpha_exp_4) * alpha*alpha*alpha)\nq_eval_at_alpha","key":"Tf1E4JRvK9"},{"type":"output","id":"aTBhwwC6IdD1YEKHtegFR","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"475058","content_type":"text/plain"}}}],"key":"Anda3MWPHj"}],"key":"cHTgj8uRL4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def compute_product_poly(a: list[Field], b: list[Field]):\n    assert len(a) == len(b), \"Length of a and b must be the same\"\n    l = len(a)\n    s = [F.zero()] * (l-1)\n    dot_product = F.zero()\n    for i in range(l):\n        for j in range(l):\n            if abs(i-j) == 0:\n                dot_product += a[i] * b[j]\n            else:\n                s[abs(i-j)-1] += a[i] * b[j]\n    return s, dot_product","key":"tH49sEMIKR"},{"type":"output","id":"xZBQt7cC8LSbmVAvIZG20","data":[],"key":"iRhsi4mU8r"}],"key":"OEjJxqTjPG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def inner_product(a, b, z):\n    return sum([a[i] * b[i] for i in range(len(a))], z)","key":"mNnc7015bt"},{"type":"output","id":"IEJOWhN6YfdzHKU-fzJ7Z","data":[],"key":"xg1cCpTxcy"}],"key":"ghZ31cCqk0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"a = [F(int(1)), F(int(2)), F(int(3)), F(int(4))]\nb = [F(int(4)), F(int(2)), F(int(3)), F(int(1))]\na_uni = UniPolynomial(a)\nb_uni = UniPolynomial(b)\ns, v = compute_product_poly(a, b)\ns_uni = UniPolynomial(s)\ns, v, v == inner_product(a, b, F(int(0)))","key":"lIBoMEH9H1"},{"type":"output","id":"zTMj2zDGa0lbv6fA1wpMa","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"([37, 25, 17], 21, True)","content_type":"text/plain"}}}],"key":"KxWOWb41jn"}],"key":"EcJNpXsCvb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Check if s(X) is correct\n#\n#    a(X)b(1/X) + a(1/X)b(X) = 2v + X*s(X) + (1/X)*s(1/X)\n#\nz = F.rand()\nz_inv = int(1)/z\n# a_uni.evaluate(z) * b_uni.evaluate(z_inv), F(int(2)) * v\na_uni.evaluate(z) * b_uni.evaluate(z_inv) + a_uni.evaluate(z_inv) * b_uni.evaluate(z) \\\n    == F(int(2))*v + z*s_uni.evaluate(z) + z_inv*s_uni.evaluate(z_inv)","key":"Q0sVWtYo9r"},{"type":"output","id":"-WjLHT4033zvCpShUBkE7","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"True","content_type":"text/plain"}}}],"key":"YpZ92lX1Bm"}],"key":"ha3sVZE9EZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q_coeffs = []\nfor i in range(len(q0_uni.coeffs)):\n    q_coeffs.append(q0_uni.coeffs[i])\n    q_coeffs.append(q1_uni.coeffs[i])\n    q_coeffs.append(q2_uni.coeffs[i])\n    q_coeffs.append(q3_uni.coeffs[i])\nq_coeffs","key":"ZD537oMkCw"},{"type":"output","id":"F3Mrhm8oJirUTKAD5ojck","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"[26, 13, -8, 30, 8, 5, -3, 10, 3, 1, -2, 3]","content_type":"text/plain"}}}],"key":"HScUH6Z4w1"}],"key":"ohZeQlhBdr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"q, r = UniPolynomial.polynomial_division_with_remainder(f_uni.coeffs, \n                        [-alpha, F(int(0)), F(int(0)), F(int(0)), F(int(1))])\nq, r","key":"FLhRHuJUe3"},{"type":"output","id":"GrSWyPAKDl6NJ2lbXTzpi","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"([26, 13, -8, 30, 8, 5, -3, 10, 3, 1, -2, 3], [79, 42, -22, 91])","content_type":"text/plain"}}}],"key":"skSm4TtIKC"}],"key":"Wrp4gRj3YE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"r_uni = UniPolynomial(r)","key":"uk8atwOOYm"},{"type":"output","id":"D5kafgUZ3llpn6BQsd8cd","data":[],"key":"kQIXd6HC5E"}],"key":"fJcVo2q6KF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"r_uni.evaluate(F(int(3)))","key":"wFRIY88Y9f"},{"type":"output","id":"AWJ1zqoH2Jr-U5zklQd19","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"2464","content_type":"text/plain"}}}],"key":"LnjTA7GBA9"}],"key":"CEZd1VdxqT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_uni + f1_uni, Scalar(F(int(3))) * f0_uni\n","key":"v6Btq5HSjV"},{"type":"output","id":"R9TQJJtg4oK9OX3gju3G8","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"(4 + x^2 + 4x^3, 3 + 6x + -3x^2 + 9x^3)","content_type":"text/plain"}}}],"key":"LMIRr6JyrR"}],"key":"yJxGPcU3Ne"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"h = Scalar(vec_eq_l[0]) * f0_uni + Scalar(vec_eq_l[1]) * f1_uni  \\\n    + Scalar(vec_eq_l[2]) * f2_uni + Scalar(vec_eq_l[3]) * f3_uni\nh","key":"pDceLvgB7G"},{"type":"output","id":"1-iX7Glef98pLBuIZnIuM","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"10 + -11x + 11x^2 + -10x^3","content_type":"text/plain"}}}],"key":"wkrfmh6xRD"}],"key":"RKXIIOWzAM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_mle, -f0_mle","key":"gm9xJUaKTV"},{"type":"output","id":"cKSsP0-U7GyJF1y0V8_u-","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"(MLEPolynomial([1, 2, -1, 3], 2), MLEPolynomial([-1, -2, 1, -3], 2))","content_type":"text/plain"}}}],"key":"dGyXswr4D4"}],"key":"oHxl0YlbyM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"f0_mle - f1_mle, f0_mle, f1_mle","key":"BRw75TQTzS"},{"type":"output","id":"h74GNGq12lXkon4d7FqEf","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"(MLEPolynomial([-2, 4, -3, 2], 2),\n MLEPolynomial([1, 2, -1, 3], 2),\n MLEPolynomial([3, -2, 2, 1], 2))","content_type":"text/plain"}}}],"key":"gUCJiXLlko"}],"key":"ZZTKLhEBDF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"v = f_mle.evaluate(us)\nv","key":"wZChqKposG"},{"type":"output","id":"-nLdG-HEl7WvG7spDV9bZ","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"-13","content_type":"text/plain"}}}],"key":"MR62BoxXoL"}],"key":"HizAodsNoo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Prove evaluation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JK81RqsX3y"}],"identifier":"id-2-prove-evaluation","label":"2. Prove evaluation","html_id":"id-2-prove-evaluation","implicit":true,"key":"p6VDj2ugEZ"}],"key":"Vdmjt9u2M7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"debug = 1\ntranscript = MerlinTranscript(b\"test-mercury-pcs\")\ntranscript.absorb(b\"commitment\", f_cm.cm)\ntranscript.absorb(b\"point\", us)\ntranscript.absorb(b\"value\", v)\n","key":"sSGbSTW4U9"},{"type":"output","id":"5bLcw4SrbOee_zpN5Amsb","data":[],"key":"qNnTFWBz0g"}],"key":"fBzaQXHc9y"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nCvObSCff5"}],"identifier":"step-1","label":"Step 1","html_id":"step-1","implicit":true,"key":"jSKamniUVp"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"compute ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"noKel4aPZY"},{"type":"inlineMath","value":"h(X)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"gBJAySOBeP"}],"key":"rH7rGw11tF"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"commit ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ghVX1HYkJY"},{"type":"inlineMath","value":"h(X)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"RefEnVPOHz"}],"key":"F8HGLpTA4D"}],"key":"YvLpw0YSUX"}],"key":"B14gbHBTEt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"\nk = f_mle.num_var\nus_l = us[:k//2]\nus_r = us[k//2:]\nvec_eq_l = MLEPolynomial.eqs_over_hypercube(us_l)\nvec_eq_r = MLEPolynomial.eqs_over_hypercube(us_r)\nn_l = len(vec_eq_l) # column\nn_r = len(vec_eq_r) # row\nvec_eq_l, vec_eq_r","key":"DD9RD7lDkI"},{"type":"output","id":"q7yB99hwDF_72e3Lc85J3","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"([-2, 4, 1, -2], [0, 3, 0, -2])","content_type":"text/plain"}}}],"key":"HJy8QvQiSX"}],"key":"C2gPrdQzuf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Compute h(X)\nh_coeffs = []\nfor i in range(n_r):\n    h_coeffs.append(sum([f_mle.evals[i*n_l+j] * vec_eq_l[j] for j in range(n_r)], F(int(0))))\nh_uni = UniPolynomial(h_coeffs)\nh_cm = kzg_pcs.commit(h_uni)\ntranscript.absorb(b\"h_cm\", h_cm.cm)\nh_cm","key":"InQCN4sS3x"},{"type":"output","id":"RXACoebxP4ON3Wp9jc6wE","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"Commitment((341203988594841721703751627390561602518991312853592249390238506514023511558, 4570164882443154697207366432674390476737733102807743213900207502309583215167))","content_type":"text/plain"}}}],"key":"JSU27gFpsN"}],"key":"jg4yDzmyxS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: folded polynomial h(X)\")\n    coeffs = f_mle.evals\n    eqs = MLEPolynomial.eqs_over_hypercube(us)\n    lhs = inner_product(h_coeffs, vec_eq_r, F(int(0))) \n    rhs = inner_product(coeffs, eqs, F(int(0)))\n    assert lhs == rhs, f\"lhs: {lhs}, rhs: {rhs}\"\n    print(f\"P> check: folded polynomial h(X) passed\")\n","key":"fqaqz3ZXmh"},{"type":"output","id":"PnkuNY2QpqJryIRM2z7MC","data":[{"name":"stdout","output_type":"stream","text":"P> check: folded polynomial h(X)\nP> check: folded polynomial h(X) passed\n"}],"key":"jURF88cPT0"}],"key":"kd2PTr9Iha"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XjBKbVLsgJ"}],"identifier":"step-2","label":"Step 2","html_id":"step-2","implicit":true,"key":"Wku0DXMEpY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(a). get ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BwEIba0yyQ"},{"type":"inlineMath","value":"\\alpha\\in\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>∈</mo><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\alpha\\in\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gVjK5W1W8C"},{"type":"text","value":" from the verifier","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AycdkZMFMU"}],"key":"WJjrpqpTIN"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"(b). compute ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XfXbMarI9Y"},{"type":"inlineMath","value":"q(X)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"EvDhievqGS"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"oyVftusGUF"},{"type":"inlineMath","value":"g(X)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"yXWcRrdQEl"},{"type":"text","value":", s.t.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"V8zrDoJZuA"}],"key":"BdlooIyhUd"}],"key":"UZGk0DPSKR"},{"type":"math","value":"f(X) = (X^b - \\alpha) * q(X) + g(X)","position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>X</mi><mi>b</mi></msup><mo>−</mo><mi>α</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>q</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(X) = (X^b - \\alpha) * q(X) + g(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"ONlqHvT4JU"}],"key":"ojLSen1lMA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Step 2\n\nalpha = transcript.squeeze(Field, b\"alpha\", 4)\nalpha","key":"I7fX8NY3K6"},{"type":"output","id":"jEAFJZ7SmNTnR0kkvD2gz","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"66954866","content_type":"text/plain"}}}],"key":"Pm56J3ZVAz"}],"key":"kH9YAmyLLB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def div_by_quadratic_binomial(coeffs, alpha, k):\n    num_col = 2**k\n    num_row = len(coeffs) // num_col\n    print(f\"num_col: {num_col}, num_row: {num_row}\")\n\n    q_coeffs = [F.zero()] * (num_col * (num_row-1))\n    r_coeffs = [F.zero()] * num_col\n    for j in range(num_col):\n        fi = coeffs[j::num_row]\n        qi, ri = UniPolynomial(fi).div_by_linear_divisor(alpha)\n        for i in range(num_row-1):\n            q_coeffs[j+i*num_row] = qi.coeffs[i]\n        r_coeffs[j] = ri\n    return q_coeffs, r_coeffs","key":"nCd1sChAHS"},{"type":"output","id":"onUz8E-9KVtI1aMCgh2-W","data":[],"key":"rEPeFfd34q"}],"key":"wQyw3msq6A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Compute q(X) and g(X)\n\nq_coeffs, g_coeffs = div_by_quadratic_binomial(f_mle.evals, alpha, 2)\nq_uni = UniPolynomial(q_coeffs)\ng_uni = UniPolynomial(g_coeffs)\nq_cm = kzg_pcs.commit(q_uni)\ng_cm = kzg_pcs.commit(g_uni)\nq_cm, g_cm","key":"vLQFjOJb6Q"},{"type":"output","id":"T_XWwZAm809avi6lw7nMm","data":[{"name":"stdout","output_type":"stream","text":"num_col: 4, num_row: 4\n"},{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/plain":{"content":"(Commitment((6873374277395425445538081471403900421153044372429899318315463318322988015074, 16690292592350444777928793433203390570537489251096203454692664097972278279727)),\n Commitment((12744849022295298739892606625958984031642490183242839912364573373366770170425, 10807392124513062104048213661706791445849571919278941606978474073386634973494)))","content_type":"text/plain"}}}],"key":"MzabSZxjgR"}],"key":"ozCWAjAtmb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: quotient polynomial q(X) and remainder polynomial g(X)\")\n    q, r = UniPolynomial.polynomial_division_with_remainder(f_mle.evals, \n                            [-alpha, F(int(0)),  F(int(0)), F(int(0)), F(int(1))])\n    assert q == q_coeffs, f\"q: {q}, q_coeffs: {q_coeffs}\"\n    print(f\"P> check: quotient polynomial q(X) passed\")\n    assert r == g_coeffs, f\"r: {r}, r_coeffs: {g_coeffs}\"\n    print(f\"P> check: remainder polynomial g(X) passed\")","key":"KntnIGCcq6"},{"type":"output","id":"AlQdzwP3bekR5uuF_QxVd","data":[{"name":"stdout","output_type":"stream","text":"P> check: quotient polynomial q(X) and remainder polynomial g(X)\nP> check: quotient polynomial q(X) passed\nP> check: remainder polynomial g(X) passed\n"}],"key":"Y8W3JSmSmu"}],"key":"thvoEOEr65"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Commit and send q(X) and g(X)\n\ntranscript.absorb(b\"q_cm\", q_cm.cm)\ntranscript.absorb(b\"g_cm\", g_cm.cm)","key":"XKU2175YLb"},{"type":"output","id":"24c3SIzY5Jm44UCL608PR","data":[],"key":"VAqaczVhRD"}],"key":"BwDwlqnGsZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F9XK6aODoh"}],"identifier":"step-3","label":"Step 3","html_id":"step-3","implicit":true,"key":"J9bCuMrGUR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(a). Get ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bNALVhBEOn"},{"type":"inlineMath","value":"\\gamma\\in\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi><mo>∈</mo><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\gamma\\in\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jfU2Z5g3oD"},{"type":"text","value":" from the verifier","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i1M9QGDaU6"}],"key":"VCdqIfUbJ3"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"(b). Compute ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"eYqPSTARfy"},{"type":"inlineMath","value":"s(X)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">s(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"x11elm4KJD"},{"type":"text","value":" and send its commitment ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Lx56L6eTI0"},{"type":"inlineMath","value":"C_s","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"eVjUZ8kkEw"}],"key":"z80qKByI8Y"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"(c). Compute ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yzJbqs5aMz"},{"type":"inlineMath","value":"d(X)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"GnU03RKnga"},{"type":"text","value":" and send its commitment ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"juHKCqQy8h"},{"type":"inlineMath","value":"C_d","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JVwbyNHXvo"}],"key":"UI16Bfq8bm"}],"key":"kUNahXScmV"}],"key":"jXsVHFNlyR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"gamma = transcript.squeeze(Field, b\"gamma\", 4)\ngamma, type(gamma)","key":"q96nHyV2a1"},{"type":"output","id":"9wgYr-NJw2q0XiWbLUDgq","data":[{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"text/plain":{"content":"(89040678, <class 'curve.Fr'>)","content_type":"text/plain"}}}],"key":"egJBRCkkeQ"}],"key":"rBVlVZLqbI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"def compute_product_poly(a: list[Field], b: list[Field]):\n    assert len(a) == len(b), \"Length of a and b must be the same\"\n    l = len(a)\n    s = [F.zero()] * (l-1)\n    dot_product = F.zero()\n    for i in range(l):\n        for j in range(l):\n            if abs(i-j) == 0:\n                dot_product += a[i] * b[j]\n            else:\n                s[abs(i-j)-1] += a[i] * b[j]\n    return s, dot_product","key":"WeOKXppurb"},{"type":"output","id":"wA64x679ng8GQc-JItgHF","data":[],"key":"x3OzfdeBnI"}],"key":"iTmEsN7f4V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Compute s1(X) and s2(X), and send [s(X)]\n#\n#  where s(X) = s1(X) + gamma * s2(X)\n\ns1_coeffs, v1 = compute_product_poly(g_coeffs, vec_eq_l)\ns2_coeffs, v2 = compute_product_poly(h_coeffs, vec_eq_r)\ns1_uni = UniPolynomial(s1_coeffs)\ns2_uni = UniPolynomial(s2_coeffs)\ns_uni = s1_uni + Scalar(gamma) * s2_uni\ns_cm = kzg_pcs.commit(s_uni)\ns_cm","key":"EaPNb0BfCJ"},{"type":"output","id":"QDHdTHyvcYZ5JaLlbk9s1","data":[{"output_type":"execute_result","execution_count":76,"metadata":{},"data":{"text/plain":{"content":"Commitment((196218153828482921355178233114718791152912307737878072738063461265417166874, 394014398374792061255415805359155323151193649000371028071552966415569233135))","content_type":"text/plain"}}}],"key":"iQ89MHJYLg"}],"key":"bZGtsCpyXg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: s1(X) and s2(X)\")\n    assert v2 == v, f\"v2: {v2}, v: {v}\"\n    assert v1 == h_uni.evaluate(alpha), f\"v1: {v1}, h_uni.evaluate(alpha): {h_uni.evaluate(alpha)}\"\n    z = F.rand()\n    z_inv = int(1)/z\n    g_uni = UniPolynomial(g_coeffs)\n    p1_uni = UniPolynomial(vec_eq_l)\n    h_uni = UniPolynomial(h_coeffs)\n    p2_uni = UniPolynomial(vec_eq_r)\n    s1_uni = UniPolynomial(s1_coeffs)\n    s2_uni = UniPolynomial(s2_coeffs)\n    assert g_uni.evaluate(z) * p1_uni.evaluate(z_inv) + g_uni.evaluate(z_inv) * p1_uni.evaluate(z) \\\n        == F(int(2))*v1 + z*s1_uni.evaluate(z) + z_inv*s1_uni.evaluate(z_inv)\n    print(f\"P> check: s1(X) passed\")\n    assert h_uni.evaluate(z) * p2_uni.evaluate(z_inv) + h_uni.evaluate(z_inv) * p2_uni.evaluate(z) \\\n        == F(int(2))*v2 + z*s2_uni.evaluate(z) + z_inv*s2_uni.evaluate(z_inv)\n    print(f\"P> check: s2(X) passed\")\n\n","key":"HwpciYrgsf"},{"type":"output","id":"6xQLfsacVlFTylkUDbOwv","data":[{"name":"stdout","output_type":"stream","text":"P> check: s1(X) and s2(X)\nP> check: s1(X) passed\nP> check: s2(X) passed\n"}],"key":"KGgKVvqjbG"}],"key":"VD9qbgmeJd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Compute d(X) where d(X) = X^{l-1} * g(1/X)\n\nd_coeffs = g_coeffs[::-1]\nd_uni = UniPolynomial(d_coeffs)\nd_cm = kzg_pcs.commit(d_uni)\nd_cm","key":"lbibRSBxtq"},{"type":"output","id":"7NXx9cxKtYQg9AMnhfcuW","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"Commitment((411548608121372520815472318385633818999017454145389265932878881921792672285, 11683702693697689722457230903516371286641048263922663281742983635724242819079))","content_type":"text/plain"}}}],"key":"X82NsXPwZ5"}],"key":"XCWjTznCc0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: d(X)\")\n    z = F.rand()\n    z_inv = int(1)/z\n    d_uni = UniPolynomial(d_coeffs)\n    g_uni = UniPolynomial(g_coeffs)\n    lhs = d_uni.evaluate(z)\n    assert lhs == z^(int(n_l)-int(1)) * g_uni.evaluate(z_inv)\n    print(f\"P> check: d(X) passed\")","key":"ToeKJzgjJx"},{"type":"output","id":"LaZQI3Oa3UbDyED7bThSZ","data":[{"name":"stdout","output_type":"stream","text":"P> check: d(X)\nP> check: d(X) passed\n"}],"key":"PwsYdmaMAJ"}],"key":"SU8SXWrX3e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"transcript.absorb(b\"s_cm\", s_cm.cm)\ntranscript.absorb(b\"d_cm\", d_cm.cm)","key":"ecDMnUVQeO"},{"type":"output","id":"Z423P95LCa29yBdd2GHuL","data":[],"key":"ECCAmVDzkT"}],"key":"sG4Khy3s2o"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NIwfd1RL4m"}],"identifier":"step-4","label":"Step 4","html_id":"step-4","implicit":true,"key":"TnpKVrzqJt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(a). Get ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VDkm7btLn3"},{"type":"inlineMath","value":"\\zeta\\in\\mathbb{F}_p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ζ</mi><mo>∈</mo><msub><mi mathvariant=\"double-struck\">F</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\zeta\\in\\mathbb{F}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.975em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"N3LsolA5qF"},{"type":"text","value":" from the verifier","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gHDpxI4U38"}],"key":"TMkGmZZmoY"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"(b). Compute and send ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HVvp0Z5ihM"},{"type":"inlineMath","value":"g(\\zeta), g(1/\\zeta), h(\\zeta), h(1/\\zeta), s(\\zeta), s(1/\\zeta)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>s</mi><mo stretchy=\"false\">(</mo><mi>ζ</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>s</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>ζ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(\\zeta), g(1/\\zeta), h(\\zeta), h(1/\\zeta), s(\\zeta), s(1/\\zeta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span></span></span></span>","key":"ThzC5QxZ0R"},{"type":"text","value":" and send them to the verifier","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lke65Oechk"}],"key":"IOIEsw2qd4"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"(c). Compute the quotient polynomial ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aGSK00IhIY"},{"type":"inlineMath","value":"t(X)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">t(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span>","key":"MhSNvj11jN"},{"type":"text","value":" and send its commitment ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I7iHPQGb2q"},{"type":"inlineMath","value":"C_t","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FOIhka71Fn"}],"key":"OY3DfpFk39"}],"key":"IjcgzcykxE"},{"type":"math","value":"t(X) = \\frac{f(X) - q(X)(z^b - \\alpha) - g(\\zeta)}{X - \\zeta}","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>t</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>q</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>z</mi><mi>b</mi></msup><mo>−</mo><mi>α</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>ζ</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>X</mi><mo>−</mo><mi>ζ</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">t(X) = \\frac{f(X) - q(X)(z^b - \\alpha) - g(\\zeta)}{X - \\zeta}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4065em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","key":"Rphn0MrRsL"}],"key":"fjftKvUcF2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"zeta = transcript.squeeze(Field, b\"zeta\", 4)\nzeta_inv = zeta.inv()","key":"LfTHFd0NBW"},{"type":"output","id":"hhitr0t8KtlDp1JhBUlWq","data":[],"key":"flgM1xi1Fe"}],"key":"sCxN95KVoH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"g_at_zeta = g_uni.evaluate(zeta)\ng_at_zeta_inv = g_uni.evaluate(zeta_inv)\nh_at_zeta = h_uni.evaluate(zeta)\nh_at_zeta_inv = h_uni.evaluate(zeta_inv)\ns_at_zeta = s_uni.evaluate(zeta)\ns_at_zeta_inv = s_uni.evaluate(zeta_inv)","key":"xmaR4UpNne"},{"type":"output","id":"SIWyGcue8vKscxJXNvniD","data":[],"key":"fHfHL8iOr4"}],"key":"YpriYzztOP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"u = f_uni - q_uni * Scalar(zeta^n_l - alpha) - Scalar(g_at_zeta)\nu","key":"Y7bIfic1tA"},{"type":"output","id":"tIvaGxVvToy7gZSgIlxaD","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"-320010484181115610812123662559302472706056545349919408 + -103508575654681906348588614540275275117858512989098647x + 207017140487745510874267438536765553073217321966678577x^2 + -310525719234318449659817744109557372277347152542366849x^3 + -4637836421663923373260987705813334791825921673x^4 + -1545945527763164405815148009344596766480018702x^5 + 3091890893900758967445839696468738025345902976x^6 + -4637836467842657614456546655019179222572817225x^7 + -69268101361793338423808766646120343326x^8 + -23089367120597779474602922215373447773x^9 + 46178734241195558949205844430746895553x^10 + -69268101361793338423808766646120343324x^11 + 3x^12 + x^13 + -2x^14 + 3x^15","content_type":"text/plain"}}}],"key":"POVmAQxv9u"}],"key":"VzEwLCHNep"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"t_uni, t_eval = u.div_by_linear_divisor(zeta)\nt_cm = kzg_pcs.commit(t_uni)\nt_cm, t_eval\n","key":"FwYJU0uXmh"},{"type":"output","id":"elUgJ9MztS47Q6HGYEAQN","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"(Commitment((7564077621549655343295293161727763898648355577163371329825382307061906824629, 20961728419572618406325587578344293151556639381818099483799713097095237121275)),\n 0)","content_type":"text/plain"}}}],"key":"Zb5ZVMJMhv"}],"key":"w1aIvOih0Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: quotient polynomial t(X)\")\n    assert t_eval == Field.zero(), f\"t_eval: {t_eval}\"\n    z = F.rand()\n    t_z = t_uni.evaluate(z)\n    f_z = f_uni.evaluate(z)\n    q_z = q_uni.evaluate(z)\n    assert t_z * (z - zeta) == f_z - q_z * (zeta^n_l - alpha) - g_at_zeta\n    print(f\"P> check: quotient polynomial t(X) passed\")\n","key":"ESNvPQbYqP"},{"type":"output","id":"idTyl_3HTNV4xx0qzky4-","data":[{"name":"stdout","output_type":"stream","text":"P> check: quotient polynomial t(X)\nP> check: quotient polynomial t(X) passed\n"}],"key":"rcobmD17dx"}],"key":"iyOlhAd2l6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: C_t\")\n    g_G1 = kzg_pcs.params['g']\n    h_G2 = kzg_pcs.params['h']\n    h_tau_G2 = kzg_pcs.params['tau_h']\n    lhs1 = f_cm.cm + t_cm.cm.ec_mul(zeta) - q_cm.cm.ec_mul(zeta^n_l - alpha) - g_G1.ec_mul(g_at_zeta)\n    lhs2 = h_G2\n    rhs1 = t_cm.cm\n    rhs2 = h_tau_G2\n    print(f\"type(lhs1)= {type(lhs1)}, type(lhs2)= {type(lhs2)}, type(rhs1)= {type(rhs1)}, type(rhs2)= {type(rhs2)}\")\n    checked = ec_pairing_check([lhs1, rhs1], [-lhs2, rhs2])\n    assert checked, \"C_t is not valid\"\n    print(f\"P> check: C_t passed\")\n","key":"DKqWVuZzPL"},{"type":"output","id":"GE7u04pkdHuLQei65IJw8","data":[{"name":"stdout","output_type":"stream","text":"P> check: C_t\ntype(lhs1)= <class 'curve.G1Point'>, type(lhs2)= <class 'curve.G2Point'>, type(rhs1)= <class 'curve.G1Point'>, type(rhs2)= <class 'curve.G2Point'>\nP> check: C_t passed\n"}],"key":"WM5yu8vjTh"}],"key":"YjHIxysijK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"transcript.absorb(b\"t_cm\", t_cm.cm)\ntranscript.absorb(b\"g_at_zeta\", g_at_zeta)\ntranscript.absorb(b\"g_at_zeta_inv\", g_at_zeta_inv)\ntranscript.absorb(b\"h_at_zeta\", h_at_zeta)\ntranscript.absorb(b\"h_at_zeta_inv\", h_at_zeta_inv)\ntranscript.absorb(b\"s_at_zeta\", s_at_zeta)\ntranscript.absorb(b\"s_at_zeta_inv\", s_at_zeta_inv)","key":"YSHSyQ989O"},{"type":"output","id":"e1adwEBT2msGRbImYkGl_","data":[],"key":"aAOoefyq5N"}],"key":"DAxNSGj5in"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c6PK8jPqru"}],"identifier":"step-5","label":"Step 5","html_id":"step-5","implicit":true,"key":"WJEzq7hbDF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Aggregate the evaluation proofs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HFDd9owRTc"}],"key":"cxSgasa994"}],"key":"yp3wdTEQjE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"# Aggregate the evaluation proofs\n\neta = transcript.squeeze(Field, b\"eta\", 4)\n\na_uni = g_uni + Scalar(eta) * h_uni + Scalar(eta*eta) * s_uni\na_at_zeta_inv, a_at_zeta_inv_arg = kzg_pcs.prove_evaluation(a_uni, zeta_inv)\n\na_uni += Scalar(eta*eta*eta) * d_uni\na_at_zeta, a_at_zeta_arg = kzg_pcs.prove_evaluation(a_uni, zeta)\n\nh_uni_at_alpha, h_at_alpha_arg = kzg_pcs.prove_evaluation(h_uni, alpha)\na_at_zeta_arg, a_at_zeta_inv_arg, h_at_alpha_arg\n\n","key":"PmBLDY89tY"},{"type":"output","id":"xdO65Z34YNwRqE9P3Hjau","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"({'w_cm': Commitment((15522446906494288407282696648261850622287101021721313436696028069912532784720, 603214464022950610669451026422499576356824841616091783390441425826994905145))},\n {'w_cm': Commitment((21807297083416410354924359503853066118819031366858090987581267815333402259120, 3665392969967324964834023121604975099446719084408716190589686241189390173360))},\n {'w_cm': Commitment((19277402036953961621331476720166919837657448960632489771751307109877544454558, 14785722924673158890380759949870394812979469962011416906141661546783155852289))})","content_type":"text/plain"}}}],"key":"pOZQkpbGIp"}],"key":"X4EJdjxRYt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: h(alpha)\")\n    p1_uni = UniPolynomial(vec_eq_l)\n    p2_uni = UniPolynomial(vec_eq_r)\n    p1_at_zeta = p1_uni.evaluate(zeta)\n    p2_at_zeta = p2_uni.evaluate(zeta)\n    p1_at_zeta_inv = p1_uni.evaluate(zeta_inv)\n    p2_at_zeta_inv = p2_uni.evaluate(zeta_inv)\n    h_alpha = (h_at_zeta * p2_at_zeta_inv) + (h_at_zeta_inv * p2_at_zeta) - v - v\n    h_alpha *= gamma \n    h_alpha += (g_at_zeta * p1_at_zeta_inv) + (g_at_zeta_inv * p1_at_zeta)\n    h_alpha -= zeta * s_at_zeta + zeta_inv * s_at_zeta_inv\n\n    d_at_zeta = zeta^(int(n_l-1)) * g_at_zeta_inv\n    assert d_at_zeta == d_uni.evaluate(zeta), f\"d_at_zeta: {d_at_zeta}, d_uni.evaluate(zeta): {d_uni.evaluate(zeta)}\"\n    assert h_uni_at_alpha * Field(int(2)) == h_alpha, f\"h_uni_at_alpha: {h_uni_at_alpha}, h_alpha: {h_alpha}\"\n    print(f\"P> check: h(alpha) passed\")\n","key":"r2Zc1kjJps"},{"type":"output","id":"JZfv0JYqJZYtZwV6-k9N1","data":[{"name":"stdout","output_type":"stream","text":"P> check: h(alpha)\nP> check: h(alpha) passed\n"}],"key":"rloy9YMfTw"}],"key":"frsrexSmnP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"if debug > 0:\n    print(f\"P> check: aggregate evaluation proofs\")\n    C_a = g_cm.cm + h_cm.cm.ec_mul(eta) + s_cm.cm.ec_mul(eta*eta) \n    checked1 = kzg_pcs.verify_evaluation(Commitment(C_a), zeta_inv, a_at_zeta_inv, a_at_zeta_inv_arg)\n    C_a += d_cm.cm.ec_mul(eta*eta*eta)\n    checked2 = kzg_pcs.verify_evaluation(Commitment(C_a), zeta, a_at_zeta, a_at_zeta_arg)\n    assert checked1 and checked2, f\"checked1: {checked1}, checked2: {checked2}\"\n    checked3 = kzg_pcs.verify_evaluation(h_cm, alpha, h_uni_at_alpha, h_at_alpha_arg)\n    assert checked3, f\"checked3: {checked3}\"\n    print(f\"P> check: aggregate evaluation proofs passed\")","key":"KllfsyfNDI"},{"type":"output","id":"M1c1089jaMZoRWQuno_9y","data":[{"name":"stdout","output_type":"stream","text":"P> check: aggregate evaluation proofs\nP> check: aggregate evaluation proofs passed\n"}],"key":"CuYmI2Ic9D"}],"key":"PE4ZbVIOAL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"sage","executable":true,"value":"ff = UniPolynomial([F(int(2)), F(int(6)), F(int(10)), F(int(14))])\nff.evaluate(F(int(3194597718)))\n","key":"WYWJJr1Sod"},{"type":"output","id":"dk22nJaesRzq5IBRCOL9z","data":[{"output_type":"execute_result","execution_count":101,"metadata":{},"data":{"text/plain":{"content":"456432506869271084770462484798","content_type":"text/plain"}}}],"key":"k8YiaXqoGY"}],"key":"jgBaxO7ILI"}],"key":"WwChycSFif"},"references":{"cite":{"order":[],"data":{}}}}