
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Notes on Hyrax-PCS &#8212; Polynomial Commitment Schemes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'hyrax-pcs/hyrax-01.zh';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ZeroMorph 笔记" href="../zeromorph/zeromorph.zh.html" />
    <link rel="prev" title="KZG Extractability based on ROM" href="../kzg10/kzg%20notes/kzg-extractability-based-on-rom.zh.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Polynomial Commitment Schemes - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Polynomial Commitment Schemes - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the land of PCS!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Basefold</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basefold/basefold-01.zh.html">Basefold 笔记：可折叠线性编码</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basefold/basefold-02.zh.html">Basefold 笔记：IOPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basefold/basefold-03.zh.html">Basefold 笔记： MLE 求值证明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basefold/basefold-04.zh.html">Basefold 笔记：Random Foldable Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basefold/basefold-05.zh.html">Basefold 笔记：IOPP 可靠性分析</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fri/BBHR18-FRI.zh.html">[BBHR18] FRI 论文 soundness 解析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fri/BCIKS20-proximity-gaps.zh.html">[BCIKS20] Proximity Gaps 论文 soundness 解析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fri/fri-proximity-gap.zh.html">Proximity Gaps 与 Correlated Agreement：FRI 安全性证明的核心</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fri/stir.zh.html">STIR: 提升码率来降低查询复杂度</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fri/whir.zh.html">WHIR: Reed-Solomon Proximity Testing with Super-Fast Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fri/deepfold.zh.html">DeepFold 笔记：协议概览</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FRI Binius</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fri-binius/binius-01.zh.html">Notes on FRI-Binius (Part I): Binary Towers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fri-binius/binius-02.zh.html">Notes on Binius (Part II): Subspace Polynomial</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Gemini</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../gemini/Gemini-PCS-1.zh.html">Gemini-PCS (Part I)</a></li>



<li class="toctree-l1"><a class="reference internal" href="../gemini/Gemini-PCS-2.zh.html">Gemini-PCS (Part II)</a></li>




<li class="toctree-l1"><a class="reference internal" href="../gemini/hyperkzg-pcs-01.zh.html">HyperKZG</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">KZG</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../kzg10/kzg_hiding.zh.html">理解 Hiding KZG10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kzg10/kzg%20notes/kzg-extractability-based-on-rom.zh.html">KZG Extractability based on ROM</a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hyrax</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Notes on Hyrax-PCS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Zeromorph</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../zeromorph/zeromorph.zh.html">ZeroMorph 笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zeromorph/zeromorph-fri.zh.html">Zeromorph-PCS : 对接 FRI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zeromorph/zeromorph_mapping_tutorial.html">Select SageMath Kernel First</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fhyrax-pcs/hyrax-01.zh.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/hyrax-pcs/hyrax-01.zh.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Notes on Hyrax-PCS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mle">1. MLE 多项式的求值证明</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#witness">Witness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">内积协议</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-ipa">2. Mini-IPA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">证明目标</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">公开参数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#witnesses">Witnesses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">协议基本思路</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">协议</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-1">Round 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-2">Round 2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">验证</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#square-root-inner-product-argument">3. Square-root inner product argument</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Witness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">承诺</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">Evaluation证明协议</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Round 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Round 2.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-3">Round 3.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#verification">Verification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bulletproofs">4. Bulletproofs 的优化</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">公开参数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">验证</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">5. 完整协议</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">公开参数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">计算承诺</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Evaluation证明协议</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Witness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">证明协议</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Round 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Round 2.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-3-repeated-i-0-1-n-1">Round 3 (Repeated <span class="math notranslate nohighlight">\(i=0, 1, ..., n-1\)</span>).</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-4">Round 4.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-5">Round  5.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Verification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="notes-on-hyrax-pcs">
<h1>Notes on Hyrax-PCS<a class="headerlink" href="#notes-on-hyrax-pcs" title="Link to this heading">#</a></h1>
<p>这篇文章简要介绍 Hyrax-PCS 的原理，其安全假设为 Discrete Log。它的主要思想是证明一个 Inner Product，并且采用了递归折叠的思路逐步把长度为 <span class="math notranslate nohighlight">\(n\)</span> 的两个向量折叠成两个长度为 <span class="math notranslate nohighlight">\(n/2\)</span> 的两个向量，并且把内积计算归约到长度只有一半的向量的内积计算。递归折叠的思路主要来自于 [BCC+16] 与 [BBB+18]，其主要问题是 Verifier 的计算复杂度为 <span class="math notranslate nohighlight">\(O(n)\)</span>。为了使 Hyrax 能达到 zkSNARK 的要求，Hyrax 将向量重新整理成 <span class="math notranslate nohighlight">\(\sqrt{n}\times\sqrt{n}\)</span> 的矩阵，然后把内积计算归约到向量长度为 <span class="math notranslate nohighlight">\(\sqrt{n}\)</span> 的向量的内积计算。这样导致 Verifier 的计算复杂度可以优化到 <span class="math notranslate nohighlight">\(O(\sqrt{n})\)</span>。同时，经过 [BCC+16] 的优化，Hyrax 的 Proof 尺寸（通讯复杂度）也优化到 <span class="math notranslate nohighlight">\(O(\log{n})\)</span>。</p>
<section id="mle">
<h2>1. MLE 多项式的求值证明<a class="headerlink" href="#mle" title="Link to this heading">#</a></h2>
<p>不管 MLE 多项式是 Coefficients 形式还是 Evaluation 形式，我们都可以通过「内积证明」 Inner Product Argument 来证明多项式在某些点上的求值。</p>
<div class="math notranslate nohighlight">
\[
f(X_0, X_1, ..., X_{n-1}) = \sum_{i=0}^{2^n-1} a_i \cdot \tilde{eq}(\mathsf{bits}(i), X_0, X_1, ..., X_{n-1})
\]</div>
<div class="math notranslate nohighlight">
\[
f(X_0, X_1, ..., X_{n-1}) = \sum_{i=0}^{2^n-1} c_i \cdot X_0^{i_0} \cdot X_1^{i_1} \cdot ... \cdot X_{n-1}^{i_{n-1}},  \quad \text{where } \mathsf{bits}(i) = (i_0, i_1, ..., i_{n-1})
\]</div>
<p>如果我们有一个内积证明协议，那么我们可以轻松构造一个 MLE 多项式的求值证明</p>
<section id="id1">
<h3>公共输入<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{a}\)</span> 的承诺： <span class="math notranslate nohighlight">\(C_a=\mathsf{cm}(a_0, a_1, ..., a_{2^n-1})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{u}=(u_0, u_1, ..., u_{n-1})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(v=\tilde{f}(u_0, u_1, ..., u_{n-1})\)</span></p></li>
</ol>
</section>
<section id="witness">
<h3>Witness<a class="headerlink" href="#witness" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{a}\)</span></p></li>
</ol>
</section>
<section id="id2">
<h3>内积协议<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Prover 计算向量 <span class="math notranslate nohighlight">\(\vec{e}\)</span>，长度为 <span class="math notranslate nohighlight">\(2^n\)</span>，</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
e_0 &amp;= \tilde{eq}(\mathsf{bits}(0), u_0, u_1, ..., u_{n-1}) \\
e_1 &amp;= \tilde{eq}(\mathsf{bits}(1), u_0, u_1, ..., u_{n-1}) \\
\cdots \\
e_{2^n-1} &amp;= \tilde{eq}(\mathsf{bits}(2^n-1), u_0, u_1, ..., u_{n-1}) \\
\end{aligned}
\end{split}\]</div>
<p>Prover 与 Verifier 通过一个 Inner Product Argument 协议来证明 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{e}\)</span> 的内积等于 <span class="math notranslate nohighlight">\(v\)</span>。下面我们介绍一个简单的内积证明，它证明两个隐藏向量的内积值等于一个公开值。</p>
</section>
</section>
<section id="mini-ipa">
<h2>2. Mini-IPA<a class="headerlink" href="#mini-ipa" title="Link to this heading">#</a></h2>
<p>我们先从最简单的情况入手，假如 Prover 拥有两个向量 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{b}\)</span>，满足 <span class="math notranslate nohighlight">\(\langle \vec{a}, \vec{b} \rangle = c\)</span>（注意：这里的 <span class="math notranslate nohighlight">\(c\)</span> 是一个 <em>公开值</em> ）。</p>
<section id="id3">
<h3>证明目标<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Prover 拥有知识 <span class="math notranslate nohighlight">\((\vec{a},\vec{b})\)</span>（ 两个向量长度相等，记为 <span class="math notranslate nohighlight">\(m\)</span>，则总共有 <span class="math notranslate nohighlight">\(2m\)</span> 个 witness），并且 <span class="math notranslate nohighlight">\(\langle \vec{a}, \vec{b} \rangle = c\)</span></p>
</section>
<section id="id4">
<h3>公开参数<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>我们计算向量的 Pedersen Commitment，需要选取一组随机的群元素 <span class="math notranslate nohighlight">\(g_1, g_2, g_3, \ldots, g_m, h \in \mathbb{G}\)</span> 。</p>
</section>
<section id="id5">
<h3>公共输入<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>内积计算结果 <span class="math notranslate nohighlight">\(c\)</span></p></li>
<li><p>向量 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 的承诺 <span class="math notranslate nohighlight">\(C_a=\mathsf{cm}(\vec{a};\rho_a)\)</span>，</p></li>
<li><p>向量 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 的承诺 <span class="math notranslate nohighlight">\(C_b=\mathsf{cm}(\vec{b};\rho_b)\)</span></p></li>
</ol>
</section>
<section id="witnesses">
<h3>Witnesses<a class="headerlink" href="#witnesses" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((\vec{a}, \rho_a)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((\vec{b}, \rho_b)\)</span></p></li>
</ol>
</section>
<section id="id6">
<h3>协议基本思路<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Prover 引入两个「致盲向量」Blinder factors， <span class="math notranslate nohighlight">\(\vec{r}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{s}\)</span>，这两个向量通过一个挑战数 <span class="math notranslate nohighlight">\(\mu\)</span> （来自 Verifier）来拍扁成一个向量，然
$<span class="math notranslate nohighlight">\(
\vec{a}' = \vec{r}+ \mu\cdot \vec{a}  \qquad \vec{b}' = \vec{s}+ \mu\cdot \vec{b}
\)</span>$</p>
<p>然后计算<span class="math notranslate nohighlight">\(\vec{a}'\cdot \vec{b}'\)</span> 内积（或点乘）。</p>
<div class="math notranslate nohighlight">
\[
\langle \vec{a}', \vec{b}' \rangle = (\vec{r}+ \mu\cdot \vec{a})(\vec{s}+ \mu\cdot \vec{b}) =\mu^2(\langle \vec{a}, \vec{b} \rangle) + \mu(\langle \vec{a}, \vec{s} \rangle + \langle \vec{b}, \vec{r} \rangle) + \langle \vec{r}, \vec{s} \rangle
\]</div>
<p>观察下 <span class="math notranslate nohighlight">\(\vec{a}'\)</span>  与 <span class="math notranslate nohighlight">\(\vec{b}'\)</span>，我们会发现这两个向量中都有 <span class="math notranslate nohighlight">\(\mu\)</span> 项，拍扁向量的内积运算后得到一个关于 <span class="math notranslate nohighlight">\(\mu\)</span> 的<strong>二次多项式</strong>，其中 <span class="math notranslate nohighlight">\(\mu^2\)</span> 项的「系数」恰好是向量<span class="math notranslate nohighlight">\(\vec{a}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 的内积（应该等于 <span class="math notranslate nohighlight">\(c\)</span>），常数项 <span class="math notranslate nohighlight">\(\vec{r}\cdot\vec{s}\)</span> 恰好是两个「致盲向量」的内积。不过 <span class="math notranslate nohighlight">\(\mu\)</span> 的系数看起来似乎有些 <em>混乱</em>。 我们可以先不管混乱的 <span class="math notranslate nohighlight">\(\mu\)</span> 项的系数，只关注 <span class="math notranslate nohighlight">\(\mu^2\)</span> 项的系数。根据 Schwartz-Zippel 定理，只要 Prover 能成功答复 Verifier 的挑战，那么多项式所有项的系数都必须（极大概率地）正确无误。</p>
<p>我们让 Prover 在协议第一步中不仅需要对「致盲向量」承诺，同时还要对内积展开后的（关于 <span class="math notranslate nohighlight">\(\mu\)</span> 的）多项式系数进行承诺。然后在第三步中，Prover 只要发送两个拍扁向量 <span class="math notranslate nohighlight">\(\vec{a}'\)</span> 与 <span class="math notranslate nohighlight">\(\vec{b}'\)</span> 就刚刚好，Verifier 先验证 <span class="math notranslate nohighlight">\(a'\)</span> 是否能打开 <span class="math notranslate nohighlight">\(A'\)</span>，再验证 <span class="math notranslate nohighlight">\(b'\)</span> 是否能打开 <span class="math notranslate nohighlight">\(B'\)</span>， 最后 Verifier 验证 <span class="math notranslate nohighlight">\(\vec{a}'\cdot\vec{b}'\)</span> 能否打开承诺 <span class="math notranslate nohighlight">\(C'\)</span> 。我们看看协议具体怎么定义：</p>
</section>
<section id="id7">
<h3>协议<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<section id="round-1">
<h4>Round 1<a class="headerlink" href="#round-1" title="Link to this heading">#</a></h4>
<p>Prover 发送两个「致盲向量」 <span class="math notranslate nohighlight">\(\vec{r}\)</span>，<span class="math notranslate nohighlight">\(\vec{s}\)</span> 的承诺 <span class="math notranslate nohighlight">\(C_r\)</span> 与 <span class="math notranslate nohighlight">\(C_s\)</span>；还要发送多项式系数承诺 <span class="math notranslate nohighlight">\(C_0\)</span> 与 <span class="math notranslate nohighlight">\(C_1\)</span>：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
C_r&amp;=\mathsf{cm}(\vec{r};\rho_{r}) \\
C_s&amp;=\mathsf{cm}(\vec{s} ;\rho_{s}) \\
C_0&amp;=\mathsf{cm}(\langle \vec{r}, \vec{s} \rangle; \rho_0) \\
C_1&amp;=\mathsf{cm}(\langle \vec{a}, \vec{s} \rangle + \langle \vec{b}, \vec{r} \rangle; \rho_1) \\
\end{aligned}
\end{split}\]</div>
</section>
<section id="round-2">
<h4>Round 2<a class="headerlink" href="#round-2" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Verifier 回复一个挑战数 <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>Prover 发送两个拍扁向量 <span class="math notranslate nohighlight">\(\vec{a}'\)</span> ，<span class="math notranslate nohighlight">\(\vec{b}'\)</span>，三个混入 <span class="math notranslate nohighlight">\(\mu\)</span> 的随机数 <span class="math notranslate nohighlight">\(\rho'_a\)</span>， <span class="math notranslate nohighlight">\(\rho'_b\)</span>， <span class="math notranslate nohighlight">\(\rho'_{ab}\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\vec{a}'&amp;=\vec{r} + \mu \cdot \vec{a}\\
\vec{b}'&amp;=\vec{s} + \mu \cdot \vec{b}\\
\end{aligned}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\rho'_a&amp;=\rho_{r} + \mu \cdot \rho_a \\
\rho'_b&amp;=\rho_{s} + \mu \cdot \rho_b \\
\rho'_{ab}&amp;=\rho_0 + \mu \cdot \rho_1 \\
\end{aligned}
\end{split}\]</div>
</section>
<section id="id8">
<h4>验证<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<p>Verifier 在群 <span class="math notranslate nohighlight">\(\mathbb{G}\)</span> 上同态验证： <span class="math notranslate nohighlight">\(\vec{a}'\)</span> 与 <span class="math notranslate nohighlight">\(\vec{b}'\)</span>，以及他们的内积</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\mathsf{cm}(\vec{a}'; \rho'_a)&amp;\overset{?}{=} C_r + \mu\cdot C_a \\
\mathsf{cm}(\vec{b}'; \rho'_b)&amp;\overset{?}{=} C_s + \mu \cdot C_b \\
\end{aligned}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
\mathsf{cm}(\langle \vec{a}', \vec{b}' \rangle; \rho'_{ab})\overset{?}{=} \mu^2\cdot\mathsf{cm}(c;0) + \mu\cdot C_1 + C_0
\]</div>
<p>这个协议的最大问题是 Verifier 的计算复杂度为 <span class="math notranslate nohighlight">\(O(n)\)</span>，因为 Verifier 要计算 <span class="math notranslate nohighlight">\(\langle \vec{a}', \vec{b}' \rangle\)</span>。另外其中 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 为隐藏的信息，但是对于 MLE 的 Evaluation 证明协议来说，<span class="math notranslate nohighlight">\(\vec{e}\)</span> （由 <span class="math notranslate nohighlight">\(\vec{u}\)</span> 计算得来）是一个公开值，所以我们需要调整下协议。</p>
</section>
</section>
</section>
<section id="square-root-inner-product-argument">
<h2>3. Square-root inner product argument<a class="headerlink" href="#square-root-inner-product-argument" title="Link to this heading">#</a></h2>
<p>Hyrax 论文提出了一个简单直接的思路，将 Verifier 的计算复杂度降到 <span class="math notranslate nohighlight">\(O(\sqrt{n})\)</span>，Sublinear Verifier 是 zkSNARK 的一个基本要求。我们仍然只考虑 <span class="math notranslate nohighlight">\(\tilde{f}\)</span> 的 Coefficients 形式，即 <span class="math notranslate nohighlight">\(\vec{c}\)</span> 是 <span class="math notranslate nohighlight">\(\tilde{f}\)</span> 的系数。</p>
<p>我们假设 <span class="math notranslate nohighlight">\(n=4\)</span>，那么 <span class="math notranslate nohighlight">\(\vec{c}\)</span> 长度为 <span class="math notranslate nohighlight">\(16\)</span>，然后我们可以把这个向量排成一个矩阵：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
c_0 &amp; c_1 &amp; c_2 &amp; c_3 \\
c_4 &amp; c_5 &amp; c_6 &amp; c_7 \\
c_8 &amp; c_9 &amp; c_{10} &amp; c_{11} \\
c_{12} &amp; c_{13} &amp; c_{14} &amp; c_{15}
\end{bmatrix}
\end{split}\]</div>
<p>以 <span class="math notranslate nohighlight">\(\vec{c}\)</span> 为表示的 MLE 多项式可以表示为下面的形式：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\tilde{f}(X_0, X_1, X_2, X_3) = 
\begin{bmatrix}
1 &amp; X_2 &amp; X_3 &amp; X_2X_3 \\
\end{bmatrix}
\begin{bmatrix}
c_0 &amp; c_1 &amp; c_2 &amp; c_3 \\
c_4 &amp; c_5 &amp; c_6 &amp; c_7 \\
c_8 &amp; c_9 &amp; c_{10} &amp; c_{11} \\
c_{12} &amp; c_{13} &amp; c_{14} &amp; c_{15}
\end{bmatrix}
\begin{bmatrix}
1 \\
X_0 \\
X_1 \\
X_0X_1 \\
\end{bmatrix}
\end{split}\]</div>
<p>这个矩阵的计算结果如下：</p>
<div class="math notranslate nohighlight">
\[
\tilde{f}(X_0, X_1, X_2, X_3) = c_0 + c_1X_0 + c_2X_1 + c_3X_0X_1 + c_4X_2 + \cdots + c_{14}X_1X_2X_3 + c_{15}X_0X_1X_2X_3
\]</div>
<p>我们先把 <span class="math notranslate nohighlight">\(\vec{u}\)</span> 拆成两个短向量：</p>
<div class="math notranslate nohighlight">
\[
\vec{u} = (u_0, u_1, u_2, u_3) = (u_0, u_1) \parallel (u_2, u_3)
\]</div>
<p>那么 <span class="math notranslate nohighlight">\(\tilde{f}(u_0, u_1, u_2, u_3)\)</span> 可以表示为：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\tilde{f}(u_0, u_1, u_2, u_3) = \begin{bmatrix}
1 &amp; u_2 &amp; u_3 &amp; u_2u_3 \\
\end{bmatrix}
\begin{bmatrix}
c_0 &amp; c_1 &amp; c_2 &amp; c_3 \\
c_4 &amp; c_5 &amp; c_6 &amp; c_7 \\
c_8 &amp; c_9 &amp; c_{10} &amp; c_{11} \\
c_{12} &amp; c_{13} &amp; c_{14} &amp; c_{15}
\end{bmatrix}
\begin{bmatrix}
1 \\
u_0 \\
u_1 \\
u_0u_1 \\
\end{bmatrix}
\end{split}\]</div>
<p>然后，我们把 <span class="math notranslate nohighlight">\(\vec{c}\)</span> 组成的矩阵按行进行承诺的计算，得到 <span class="math notranslate nohighlight">\(C_0, C_1, C_2, C_3\)</span>，</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
C_0 &amp;= \mathsf{cm}(c_0, c_1, c_2, c_3; \rho_0) \\
C_1 &amp;= \mathsf{cm}(c_4, c_5, c_6, c_7; \rho_1) \\
C_2 &amp;= \mathsf{cm}(c_8, c_9, c_{10}, c_{11}; \rho_2) \\
C_3 &amp;= \mathsf{cm}(c_{12}, c_{13}, c_{14}, c_{15}; \rho_3)
\end{aligned}
\end{split}\]</div>
<p>然后我们可以使用 <span class="math notranslate nohighlight">\((1, u_2, u_3, u_2u_3)\)</span> 与 <span class="math notranslate nohighlight">\((C_0, C_1, C_2, C_3)\)</span> 进行内积运算，得到 <span class="math notranslate nohighlight">\(C^*\)</span>:</p>
<div class="math notranslate nohighlight">
\[
C^* = C_0 + u_2C_1 + u_3C_2 + u_2u_3C_3
\]</div>
<p>那么 <span class="math notranslate nohighlight">\(C^*\)</span> 可以看成是 <span class="math notranslate nohighlight">\(M_c\)</span> 矩阵的列向量与 <span class="math notranslate nohighlight">\((1, u_2, u_3, u_2u_3)\)</span> 的内积，记为 <span class="math notranslate nohighlight">\(\vec{d}=(d_0, d_1, d_2, d_3)\)</span>，</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
d_0 &amp;= c_0 + c_4\cdot u_2 + c_8\cdot u_3 + c_{12}\cdot u_2u_3 \\
d_1 &amp;= c_1 + c_5\cdot u_2 + c_9\cdot u_3 + c_{13}\cdot u_2u_3 \\
d_2 &amp;= c_2 + c_6\cdot u_2 + c_{10}\cdot u_3 + c_{14}\cdot u_2u_3 \\
d_3 &amp;= c_3 + c_7\cdot u_2 + c_{11}\cdot u_3 + c_{15}\cdot u_2u_3 \\
\end{split}
\end{split}\]</div>
<p>可以轻易验证：</p>
<div class="math notranslate nohighlight">
\[
C^* = \mathsf{cm}(d_0, d_1, d_2, d_3; \rho^*)
\]</div>
<p>这里 <span class="math notranslate nohighlight">\(\rho^*=\rho_0 + \rho_1u_2 + \rho_2u_3 + \rho_3u_2u_3\)</span> 。</p>
<p>采用这个思路，我们构造一个简单的 MLE 多项式承诺方案。</p>
<section id="id9">
<h3>公共输入<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{a}\)</span> 的承诺： <span class="math notranslate nohighlight">\(C_a=\mathsf{cm}(a_0, a_1, ..., a_{2^n-1})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{u}=(u_0, u_1, ..., u_{n-1})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(v=\tilde{f}(u_0, u_1, ..., u_{n-1})\)</span></p></li>
</ol>
</section>
<section id="id10">
<h3>Witness<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{a}\)</span></p></li>
</ol>
</section>
<section id="id11">
<h3>承诺<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Prover 把 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 重排成一个矩阵 <span class="math notranslate nohighlight">\(M_a\in\mathbb{F}_p^{h\times l}\)</span>：</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
M_a =
\begin{bmatrix}
a_0 &amp; a_1 &amp; a_2 &amp; \cdots &amp; a_{l-1} \\
a_l &amp; a_{l+1} &amp; a_{l+2} &amp; \cdots &amp; a_{2l-1} \\
a_{2l} &amp; a_{2l+1} &amp; a_{2l+2} &amp; \cdots &amp; a_{3l-1} \\
a_{(h-1)l} &amp; a_{(h-1)l+1} &amp; a_{(h-1)l+2} &amp; \cdots &amp; a_{hl-1} \\
\end{bmatrix}
\end{split}\]</div>
<ol class="arabic simple" start="2">
<li><p>Prover 按行计算承诺 <span class="math notranslate nohighlight">\(C_0, C_1, ..., C_{h-1}\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
C_0 &amp;= \mathsf{cm}(a_0, a_1, ..., a_{l-1}; \rho_0) \\
C_1 &amp;= \mathsf{cm}(a_l, a_{l+1}, ..., a_{2l-1}; \rho_1) \\
C_2 &amp;= \mathsf{cm}(a_{2l}, a_{2l+1}, ..., a_{3l-1}; \rho_2) \\
\cdots\ &amp;=\quad \cdots \\
C_{h-1} &amp;= \mathsf{cm}(a_{(h-1)l}, a_{(h-1)l+1}, ..., a_{hl-1}; \rho_{h-1}) \\
\end{aligned}
\end{split}\]</div>
</section>
<section id="evaluation">
<h3>Evaluation证明协议<a class="headerlink" href="#evaluation" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Prover 与 Verifier 把 <span class="math notranslate nohighlight">\(\vec{u}\)</span> 拆成两个短向量，分别用 <span class="math notranslate nohighlight">\(\vec{u}_L\)</span> 与 <span class="math notranslate nohighlight">\(\vec{u}_R\)</span> 表示：</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\vec{u}_L &amp;= (u_0, u_1, ..., u_{\log(l)-1}) \\
\vec{u}_R &amp;= (u_{\log(l)}, u_{\log(l)+1}, ..., u_{n-1}) \\
\end{aligned}
\end{split}\]</div>
<p>显然</p>
<div class="math notranslate nohighlight">
\[
\vec{u} = \vec{u}_L \parallel \vec{u}_R
\]</div>
<section id="id12">
<h4>Round 1<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Prover 计算 <span class="math notranslate nohighlight">\(\vec{e}=(e_0, e_1, ..., e_{h-1})\)</span>，长度为 <span class="math notranslate nohighlight">\(h\)</span> ：</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
e_0 &amp;= \tilde{eq}(\mathsf{bits}(0), \vec{u}_R) \\
e_1 &amp;= \tilde{eq}(\mathsf{bits}(1), \vec{u}_R) \\
\cdots\ &amp;=\quad \cdots \\
e_{h-1} &amp;= \tilde{eq}(\mathsf{bits}(h-1), \vec{u}_R) \\
\end{split}
\end{split}\]</div>
<ol class="arabic simple" start="2">
<li><p>Prover 计算 <span class="math notranslate nohighlight">\(\vec{e}\)</span> 与 <span class="math notranslate nohighlight">\(M_a\)</span> 的矩阵乘法，得到一个新的向量 <span class="math notranslate nohighlight">\(\vec{b}\)</span>，长度为 <span class="math notranslate nohighlight">\(l\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
b_0 &amp;= \langle \vec{e}, (a_0, a_l, ..., a_{(h-1)l}) \rangle \\
b_1 &amp;= \langle \vec{e}, (a_1, a_{l+1}, ..., a_{(h-1)l+1}) \rangle \\
\cdots\ &amp;=\quad \cdots \\
b_{l-1} &amp;= \langle \vec{e}, (a_{l-1}, a_{l+l-1}, ..., a_{(h-1)l+l-1}) \rangle \\
\end{split}
\end{split}\]</div>
<ol class="arabic simple" start="3">
<li><p>Prover 计算 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 的承诺 <span class="math notranslate nohighlight">\(C^*\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
C^* = \mathsf{cm}(\vec{b}; \rho^*)
\]</div>
<p>这里 <span class="math notranslate nohighlight">\(\rho^* = \langle \vec{e}, (\rho_0, \rho_1, ..., \rho_{h-1}) \rangle\)</span></p>
</section>
<section id="id13">
<h4>Round 2.<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<p>Prover 和 Verifier 进行一个 Inner Product Argument 协议，完成 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{d}\)</span> 的内积证明。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
d_0 &amp;= \tilde{eq}(\mathsf{bits}(0), \vec{u}_L) \\
d_1 &amp;= \tilde{eq}(\mathsf{bits}(1), \vec{u}_L) \\
\cdots\ &amp;=\quad \cdots \\
d_{h-1} &amp;= \tilde{eq}(\mathsf{bits}(h-1), \vec{u}_L) \\
\end{split}
\end{split}\]</div>
<ol class="arabic simple">
<li><p>Prover 先抽样一个随机数向量 <span class="math notranslate nohighlight">\(\vec{r}\)</span>，用来保护 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 的信息，然后计算它的承诺：</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
C_{r} = \mathsf{cm}(\vec{r}; \rho_{r})
\]</div>
<ol class="arabic simple" start="2">
<li><p>Prover 计算 <span class="math notranslate nohighlight">\(\vec{r}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 的内积，得到 <span class="math notranslate nohighlight">\(v\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
s = \vec{r}\cdot\vec{d}
\]</div>
<div class="math notranslate nohighlight">
\[
C_0 = \mathsf{cm}(s; \rho_s)
\]</div>
<div class="math notranslate nohighlight">
\[
C_1 = \mathsf{cm}(0; \rho_t)
\]</div>
</section>
<section id="round-3">
<h4>Round 3.<a class="headerlink" href="#round-3" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Verifier 发送一个随机数 <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>Prover 计算并发送下面的值：</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\vec{z_b} = \vec{r} + \mu\cdot\vec{b}
\]</div>
<div class="math notranslate nohighlight">
\[
z_\rho = \rho_r + \mu\cdot\rho^*
\]</div>
<div class="math notranslate nohighlight">
\[
z_t = \rho_s + \mu^{-1}\cdot\rho_t
\]</div>
</section>
<section id="verification">
<h4>Verification<a class="headerlink" href="#verification" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Verifier 计算 <span class="math notranslate nohighlight">\(C^*\)</span> 。</p></li>
<li><p>Verifier 验证：</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
C_r + \mu\cdot{}C^*\overset{?}{=} \mathsf{cm}(\vec{z_b}; z_\rho)
\]</div>
<div class="math notranslate nohighlight">
\[
C_0 + \mu^{-1}\cdot{}C_1 + \mu\cdot\mathsf{cm}(v; 0)\overset{?}{=} \mathsf{cm}(\langle\vec{z}_b, \vec{d}\rangle; z_t)
\]</div>
</section>
</section>
</section>
<section id="bulletproofs">
<h2>4. Bulletproofs 的优化<a class="headerlink" href="#bulletproofs" title="Link to this heading">#</a></h2>
<p>在上文中的「内积证明」协议（Mini-IPA）的 Round-2，由于 Prover 要发送长度为 <span class="math notranslate nohighlight">\(l\)</span> 的向量（<span class="math notranslate nohighlight">\(\vec{z}_b\)</span>），因此整体协议的通讯量为 <span class="math notranslate nohighlight">\(O(l)\)</span>。如果向量比较长，那么最后的证明尺寸就会比较大。J. Bootle 等人 在[BCC+16] 论文中提出来了一个非常有趣的思路，用递归的方式来逐步地折叠证明，实现<strong>证明尺寸的压缩</strong>。</p>
<p>假设有一个长度为 <span class="math notranslate nohighlight">\(4\)</span> 的向量 <span class="math notranslate nohighlight">\(\vec{a} = (a_1, a_2, a_3, a_4)\)</span>，我们可以对半把它切分成两个向量 <span class="math notranslate nohighlight">\(\vec{a}_1 = (a_1, a_2)\)</span> 与<span class="math notranslate nohighlight">\(\vec{a}_2 = (a_3, a_4)\)</span>，然后把它们纵向迭在一起，形成一个矩阵：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
a_1 &amp; a_2\\
a_3 &amp; a_4 \\
\end{bmatrix}
\end{split}\]</div>
<p>然后我们对这个 <span class="math notranslate nohighlight">\(2\times 2\)</span> 的矩阵（用一个随机数向量来辅助）进行「拍扁」操作：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
(x, x^{-1})
\left[
\begin{array}{ll}
a_1 &amp;a_2\\
a_3 &amp;a_4
\end{array}
\right]
= (a_1x + a_3x^{-1},\quad a_2x + a_4x^{-1})
= \vec{a}'
\end{split}\]</div>
<p>方法如上式，我们把矩阵左乘上一个随机数向量 <span class="math notranslate nohighlight">\((x, x^{-1})\)</span>，然后得到一个长度为 2 的向量 <span class="math notranslate nohighlight">\(\vec{a}'\)</span>。我们可以把这个动作看成是一种特殊的纵向拍扁。这个技巧和前文中的纵向拍扁略有不同，没有采用朴素的拍扁向量 <span class="math notranslate nohighlight">\((x^0, x^1)\)</span> 。我们把这个动作叫做「折叠」。</p>
<p>我们能注意到，折叠后的向量  <span class="math notranslate nohighlight">\(\vec{a}'\)</span> 的长度仅为 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 的一半。这样递归地做下去，就通过 Verifier 不断地发送挑战数，Prover 不停地递归折叠，最终把向量折叠成一个素数长度的向量。但是，如果允许我们为向量附加一些冗余值，使得向量的长度按 <span class="math notranslate nohighlight">\(2^k\)</span> 对齐， 那么经过 <span class="math notranslate nohighlight">\(k\)</span> 次折叠后，我们可以把向量折叠到一个长度仅为  1 的数。这就相当于对一个矩阵进行<strong>横向拍扁</strong>。</p>
<p>这个初步思路面临<strong>第一个问题</strong>，就是当向量切成两半之后，原始向量 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 的承诺 <span class="math notranslate nohighlight">\(A\)</span> 好像就没办法用了。这样当 Prover 进行一次折叠动作之后，如何让 Verifier 得到折叠之后的向量承诺呢？换个思路，Pedersen 承诺从某种意义上看，也是一种内积，即「待承诺的向量」与「基向量」的「内积」：</p>
<div class="math notranslate nohighlight">
\[
\mathsf{cm}_{\vec{G}}(\vec{a}) = a_1G_1 + a_2G_2 + \cdots + a_mG_m
\]</div>
<p>接下来的技巧很关键，我们把基向量 <span class="math notranslate nohighlight">\(\vec{G}\)</span> 做同样的切分，然后同样折叠，但是用一个<strong>不同的</strong>「挑战向量」：
$<span class="math notranslate nohighlight">\(
(x^{-1}, x)
\left[
\begin{array}{ll}
G_1 &amp;G_2\\
G_3 &amp;G_4
\end{array}
\right]
= (G_1x^{-1} + G_3x, \quad G_2x^{-1} + G_4x) = \vec{G}'
\)</span>$</p>
<p>请注意上面两个挑战向量 <span class="math notranslate nohighlight">\((x, x^{-1})\)</span> 与 <span class="math notranslate nohighlight">\((x^{-1}, x)\)</span> 看起来是<em>对称的</em>。这么做的目的，是为了凑一个特殊的常数项。当把新的向量 <span class="math notranslate nohighlight">\(\vec{a}'\)</span> 与 <span class="math notranslate nohighlight">\(\vec{G}'\)</span> 在一起计算内积时，其常数项正好就是原始向量 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{G}\)</span> 的内积。但是对于非常数项（ <span class="math notranslate nohighlight">\(x^2\)</span> 与 <span class="math notranslate nohighlight">\(x^{-2}\)</span> 项）的系数，是一些看着<em>比较混乱的值</em>。</p>
<p>我们展开计算下，首先把 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 切成两个子向量 <span class="math notranslate nohighlight">\(\vec{a}=(\vec{a}_1, \vec{a}_2)\)</span>，<span class="math notranslate nohighlight">\(\vec{G}=(\vec{G}_1, \vec{G}_2)\)</span>，然后分别进行折叠，得到 <span class="math notranslate nohighlight">\(\vec{a}'=\vec{a}_1x + \vec{a}_2x^{-1}\)</span>， <span class="math notranslate nohighlight">\(\vec{G}'=\vec{G}_1x^{-1} + \vec{G}_2x\)</span>，</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{a}'\cdot\vec{G}'= 
(1,1)\left(\left[
\begin{array}{cc}
\vec{a}_1\cdot\vec{G}_1 &amp;  \vec{a}_1\cdot\vec{G}_2 \\
\vec{a}_2\cdot\vec{G}_1 &amp;  \vec{a}_2\cdot\vec{G}_2
\end{array}
\right]
\circ
\left[
\begin{array}{cc}
1 &amp; x^2 \\
x^{-2} &amp;  1
\end{array}
\right]\right)
\left(
\begin{array}{c}
1\\
1
\end{array}
\right)
\end{split}\]</div>
<p>上面式子右边是一个关于 <span class="math notranslate nohighlight">\(x\)</span> 的多项式，于是我们可以清晰地看到 <span class="math notranslate nohighlight">\(x^2\)</span> 与 <span class="math notranslate nohighlight">\(x^{-2}\)</span> 的系数。</p>
<p>接下来我们来解决上面提出的问题：如何让 Verifier 能算出折叠后向量 <span class="math notranslate nohighlight">\(\vec{a}'\)</span> 的承诺：
$<span class="math notranslate nohighlight">\(
A'=A + (\vec{a}_1\cdot\vec{G}_2)~x^2 + (\vec{a}_2\cdot\vec{G}_1)~x^{-2}
\)</span><span class="math notranslate nohighlight">\(
我们让 Verifier 计算 \)</span>A’=\vec{a}’\cdot \vec{G}’<span class="math notranslate nohighlight">\( ，很显然 Verifier 可以自行计算出 \)</span>\vec{G}’<span class="math notranslate nohighlight">\(，然后 Verifier 就可以根据 Prover 发送的 \)</span>\vec{a}’<span class="math notranslate nohighlight">\( 来计算 \)</span>A’$。</p>
<p>承诺 <span class="math notranslate nohighlight">\(A'\)</span> 是一个关于 <span class="math notranslate nohighlight">\(x\)</span> 的多项式，常数项是原始向量的承诺 <span class="math notranslate nohighlight">\(A\)</span>，而 <span class="math notranslate nohighlight">\(x^2\)</span> 项与 <span class="math notranslate nohighlight">\(x^{-2}\)</span> 的系数可以让 Prover 计算并发送。那么 <span class="math notranslate nohighlight">\(x^1\)</span> 与 <span class="math notranslate nohighlight">\(x^{-1}\)</span> 项的系数呢？他们恰好为<em>零</em>。因为我们巧妙采用了两个对称的挑战向量分别对 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{G}\)</span> 进行折叠操作，于是正好消去 <span class="math notranslate nohighlight">\(x\)</span> 与 <span class="math notranslate nohighlight">\(x^{-1}\)</span> 两个项的系数，同时让常数项等于原始向量的内积。</p>
<p>新的承诺 <span class="math notranslate nohighlight">\(A'\)</span> 很容易计算 <span class="math notranslate nohighlight">\(A'=A + Lx^2 + Rx^{-2}\)</span>，其中 <span class="math notranslate nohighlight">\(L=(\vec{a}_1\cdot \vec{G}_2)\)</span>， <span class="math notranslate nohighlight">\(R=(\vec{a}_2\cdot \vec{G}_1)\)</span>。承诺 <span class="math notranslate nohighlight">\(L\)</span> 与 <span class="math notranslate nohighlight">\(R\)</span> 看上去是将两个子向量交叉内积的结果。这样一来，问题得到了解决，当 Prover 需要发送一个长度为 <span class="math notranslate nohighlight">\(m\)</span> 的向量 <span class="math notranslate nohighlight">\(\vec{v}\)</span> 时，Prover 可以选择发送将其<strong>对折并拍扁后的向量</strong> <span class="math notranslate nohighlight">\(\vec{v}'\)</span>，它的长度只有 <span class="math notranslate nohighlight">\(m/2\)</span>。然后 Verifier 同样可以通过验证打开（Open） 对折拍扁后的向量，从而保证原始向量的正确性。</p>
<p>递归折叠也有相应的代价，除了Verifier 要额外计算 <span class="math notranslate nohighlight">\(\vec{G}'\)</span>，Prover 也要额外计算 <span class="math notranslate nohighlight">\(L\)</span> 与 <span class="math notranslate nohighlight">\(R\)</span>，两者也要增加一轮的交互。我们可以通过下面一个递归折叠的内积证明协议来看下递归折叠的完整过程。</p>
<section id="id14">
<h3>公开参数<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(\vec{G}, \vec{H}\in\mathbb{G}^n\)</span>；<span class="math notranslate nohighlight">\(U, T\in\mathbb{G}\)</span></p>
</section>
<section id="id15">
<h3>公共输入<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(P = \vec{a}\vec{G} + \vec{b}\vec{H} + cU + \rho T\)</span></p>
<p><strong>Witnesses</strong>：<span class="math notranslate nohighlight">\(\vec{a}, \vec{b}\in\mathbb{Z}^n_p\)</span>；<span class="math notranslate nohighlight">\(c\in \mathbb{Z}_p\)</span></p>
<p><strong>第一步（承诺步）</strong>：Prover 发送两个遮罩向量的承诺 <span class="math notranslate nohighlight">\(P_0\)</span> 与 <span class="math notranslate nohighlight">\(C_1\)</span>，<span class="math notranslate nohighlight">\(C_2\)</span>：</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(P_0=\vec{a}_0\vec{G} + \vec{b}_0\vec{H} + \rho_{0}T\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(C_1=\vec{a}_0\cdot\vec{b}_0\cdot{}U + \rho_{1}T\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(C_2 = (\vec{a}\cdot\vec{b}_0 + \vec{a}_0\cdot\vec{b})\cdot U + \rho_{2}T\)</span></p></li>
</ol>
<p><strong>第二步（挑战）</strong>：Verifier 回复一个挑战数 <span class="math notranslate nohighlight">\(z\)</span></p>
<p><strong>第三步</strong>：Prover  计算 <span class="math notranslate nohighlight">\(z\)</span> 拍扁后的向量 <span class="math notranslate nohighlight">\(\vec{a}'\)</span>，<span class="math notranslate nohighlight">\(\vec{b}'\)</span>，<span class="math notranslate nohighlight">\(\rho'\)</span>，并发送 <span class="math notranslate nohighlight">\(\rho_c\)</span></p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{a}' = \vec{a} + z\vec{a}_0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{b}' = \vec{b} + z\vec{b}_0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho' = \rho + z\rho_0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_c = z^2\rho_1 + z\rho_2\)</span></p></li>
</ol>
</section>
<section id="id16">
<h3>验证<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<p>Verifier 可以计算得到 <span class="math notranslate nohighlight">\(P'\)</span></p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(P' = P + zP_0 + zC_2 + z^2C_1 - \rho_cT\)</span></p></li>
</ol>
<p>于是，Prover 和 Verifier 可以接着运行 rIPA 协议，证明 <span class="math notranslate nohighlight">\(\vec{a}'\cdot\vec{b}'\overset{?}{=}c'\)</span>，这三个值的承诺合并为 <span class="math notranslate nohighlight">\(P' = \vec{a}'\vec{G} + \vec{b}'\vec{H} + (\vec{a}'\cdot\vec{b}')U + \rho'T\)</span>。</p>
</section>
</section>
<section id="id17">
<h2>5. 完整协议<a class="headerlink" href="#id17" title="Link to this heading">#</a></h2>
<p>下面是结合了递归折叠与 Square-root IPA 的完整协议，这个协议支持 Zero-Knowledge 性质。如果不需要的 ZK 性质，直接去除 <span class="math notranslate nohighlight">\(H\)</span> 部分关于 <span class="math notranslate nohighlight">\(\rho\)</span> 相关的值即可。</p>
<section id="id18">
<h3>公开参数<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(G_0, G_1, G_2, \ldots, G_{2^n-1}, H, U \in \mathbb{G}\)</span> 。</p></li>
</ul>
</section>
<section id="id19">
<h3>计算承诺<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Prover 把 <span class="math notranslate nohighlight">\(\vec{a}\)</span> 重排成一个矩阵 <span class="math notranslate nohighlight">\(M_a\in\mathbb{F}_p^{h\times l}\)</span>：</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
M_a =
\begin{bmatrix}
a_0 &amp; a_1 &amp; a_2 &amp; \cdots &amp; a_{l-1} \\
a_l &amp; a_{l+1} &amp; a_{l+2} &amp; \cdots &amp; a_{2l-1} \\
a_{2l} &amp; a_{2l+1} &amp; a_{2l+2} &amp; \cdots &amp; a_{3l-1} \\
a_{(h-1)l} &amp; a_{(h-1)l+1} &amp; a_{(h-1)l+2} &amp; \cdots &amp; a_{hl-1} \\
\end{bmatrix}
\end{split}\]</div>
<ol class="arabic simple" start="2">
<li><p>Prover 按行计算承诺 <span class="math notranslate nohighlight">\(C_0, C_1, ..., C_{h-1}\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
C_0 &amp;= \mathsf{cm}(a_0, a_1, ..., a_{l-1}; \rho_0) \\
C_1 &amp;= \mathsf{cm}(a_l, a_{l+1}, ..., a_{2l-1}; \rho_1) \\
C_2 &amp;= \mathsf{cm}(a_{2l}, a_{2l+1}, ..., a_{3l-1}; \rho_2) \\
\cdots\ &amp;=\quad \cdots \\
C_{h-1} &amp;= \mathsf{cm}(a_{(h-1)l}, a_{(h-1)l+1}, ..., a_{hl-1}; \rho_{h-1}) \\
\end{aligned}
\end{split}\]</div>
<p>这里的 <span class="math notranslate nohighlight">\(\mathsf{cm}(\vec{a};\rho)\)</span> 的定义如下：</p>
<div class="math notranslate nohighlight">
\[
\mathsf{cm}(\vec{a};\rho) = \sum_{i=0}^{l-1} a_iG_i + \rho H
\]</div>
</section>
<section id="id20">
<h3>Evaluation证明协议<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
</section>
<section id="id21">
<h3>公共输入<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{a}\)</span> 的承诺： <span class="math notranslate nohighlight">\((C_0, C_1, ..., C_{h-1})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{u}=(u_0, u_1, ..., u_{n-1})=\vec{u}_L \parallel \vec{u}_R\)</span> ，其中 <span class="math notranslate nohighlight">\(|\vec{u}_L|=\log(l)\)</span> ，<span class="math notranslate nohighlight">\(|\vec{u}_R|=\log(h)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(v=\tilde{f}(u_0, u_1, ..., u_{n-1})\)</span></p></li>
</ol>
</section>
<section id="id22">
<h3>Witness<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{a}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((\rho_0, \rho_1, ..., \rho_{h-1})\)</span></p></li>
</ol>
</section>
<section id="id23">
<h3>证明协议<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<section id="id24">
<h4>Round 1<a class="headerlink" href="#id24" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Prover 计算 <span class="math notranslate nohighlight">\(\vec{e}\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
e_0 &amp;= \tilde{eq}(\mathsf{bits}(0), \vec{u}_R) \\
e_1 &amp;= \tilde{eq}(\mathsf{bits}(1), \vec{u}_R) \\
\cdots\ &amp;=\quad \cdots \\
e_{h-1} &amp;= \tilde{eq}(\mathsf{bits}(h-1), \vec{u}_R) \\
\end{split}
\end{split}\]</div>
<ol class="arabic simple" start="2">
<li><p>Prover 计算 <span class="math notranslate nohighlight">\(\vec{e}\)</span> 与 <span class="math notranslate nohighlight">\(M_a\)</span> 的矩阵乘法，得到 <span class="math notranslate nohighlight">\(\vec{b}\)</span>，长度为 <span class="math notranslate nohighlight">\(l\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
b_0 &amp;= \langle \vec{e}, (a_0, a_l, ..., a_{(h-1)l}) \rangle \\
b_1 &amp;= \langle \vec{e}, (a_1, a_{l+1}, ..., a_{(h-1)l+1}) \rangle \\
\cdots\ &amp;=\quad \cdots \\
b_{l-1} &amp;= \langle \vec{e}, (a_{l-1}, a_{l+l-1}, ..., a_{(h-1)l+l-1}) \rangle \\
\end{split}
\end{split}\]</div>
<ol class="arabic simple" start="3">
<li><p>Prover 计算 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 的承诺 <span class="math notranslate nohighlight">\(C^*\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
C^* = \mathsf{cm}(\vec{b}; \rho^*)
\]</div>
</section>
<section id="id25">
<h4>Round 2.<a class="headerlink" href="#id25" title="Link to this heading">#</a></h4>
<p>Prover 和 Verifier 进行一个 IPA 协议，完成 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 与 <span class="math notranslate nohighlight">\(\vec{d}\)</span> 的内积证明，<span class="math notranslate nohighlight">\(\vec{d}\)</span> 计算如下：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
d_0 &amp;= \tilde{eq}(\mathsf{bits}(0), \vec{u}_L) \\
d_1 &amp;= \tilde{eq}(\mathsf{bits}(1), \vec{u}_L) \\
\cdots\ &amp;=\quad \cdots \\
d_{h-1} &amp;= \tilde{eq}(\mathsf{bits}(h-1), \vec{u}_L) \\
\end{split}
\end{split}\]</div>
<ol class="arabic simple">
<li><p>Verifier 发送一个随机数 <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
<li><p>Prover 和 Verifier 计算 <span class="math notranslate nohighlight">\(U'\in\mathbb{G}\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
U' = \gamma\cdot U
\]</div>
</section>
<section id="round-3-repeated-i-0-1-n-1">
<h4>Round 3 (Repeated <span class="math notranslate nohighlight">\(i=0, 1, ..., n-1\)</span>).<a class="headerlink" href="#round-3-repeated-i-0-1-n-1" title="Link to this heading">#</a></h4>
<p>先引入下面的符号，比如 <span class="math notranslate nohighlight">\(\vec{b}_L\)</span> 表示 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 的前半部分，<span class="math notranslate nohighlight">\(\vec{b}_R\)</span> 表示 <span class="math notranslate nohighlight">\(\vec{b}\)</span> 的后半部分。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned} 
\vec{b}^{(i)}_L &amp;= (b^{(i)}_0, b^{(i)}_1, ..., b^{(i)}_{2^{n-1}-1}) \\
\vec{b}^{(i)}_R &amp;= (b^{(i)}_{2^{n-1}}, b^{(i)}_{2^{n-1}+1}, ..., b^{(i)}_{2^n-1}) \\
\vec{d}^{(i)}_L &amp;= (d^{(i)}_0, d^{(i)}_1, ..., d^{(i)}_{2^{n-1}-1}) \\
\vec{d}^{(i)}_R &amp;= (d^{(i)}_{2^{n-1}}, d^{(i)}_{2^{n-1}+1}, ..., d^{(i)}_{2^n-1}) \\
\vec{G}^{(i)}_L &amp;= (G^{(i)}_0, G^{(i)}_1, ..., G^{(i)}_{2^{n-1}-1}) \\
\vec{G}^{(i)}_R &amp;= (G^{(i)}_{2^{n-1}}, G^{(i)}_{2^{n-1}+1}, ..., G^{(i)}_{2^n-1}) \\
\end{aligned}
\end{split}\]</div>
<p>注意这里的初始值， <span class="math notranslate nohighlight">\(\vec{b}^{(0)} = \vec{b}\)</span>，<span class="math notranslate nohighlight">\(\vec{d}^{(0)} = \vec{d}\)</span>，<span class="math notranslate nohighlight">\(\vec{G}^{(0)}_L=\vec{G}_L\)</span>，<span class="math notranslate nohighlight">\(\vec{G}^{(0)}_R=\vec{G}_R\)</span>。</p>
<ol class="arabic simple">
<li><p>Prover 发送 <span class="math notranslate nohighlight">\(L^{(i)}\)</span> 与 <span class="math notranslate nohighlight">\(R^{(i)}\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
L^{(i)} &amp;= \mathsf{cm}_{\vec{G}^{(i)}_L}(\vec{b}_R^{(i)}; \rho^{(i)}_L) + \langle\vec{b}^{(i)}_R, \vec{d}^{(i)}_L\rangle\cdot{}U' \\
R^{(i)} &amp;= \mathsf{cm}_{\vec{G}^{(i)}_R}(\vec{b}_L^{(i)}; \rho^{(i)}_R) + \langle\vec{b}^{(i)}_L, \vec{d}^{(i)}_R\rangle\cdot{}U' \\
\end{aligned}
\end{split}\]</div>
<ol class="arabic simple" start="2">
<li><p>Verifier 发送一个随机数 <span class="math notranslate nohighlight">\(\mu^{(i)}\)</span>,</p></li>
<li><p>Prover 计算并发送下面的值：</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\vec{b}^{(i+1)} &amp;= \vec{b}^{(i)}_L + \mu^{(i)}\cdot\vec{b}^{(i)}_R \\
\vec{d}^{(i+1)} &amp;= \vec{d}^{(i)}_L + {\mu^{(i)}}^{-1}\cdot\vec{d}^{(i)}_R \\
\end{aligned}
\end{split}\]</div>
<ol class="arabic simple" start="4">
<li><p>Prover 和 Verifier 计算 <span class="math notranslate nohighlight">\(\vec{G}^{(i+1)}\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\vec{G}^{(i+1)} &amp;= \vec{G}^{(i)}_L + {\mu^{(i)}}^{-1}\cdot\vec{G}^{(i)}_R \\
\end{aligned}
\end{split}\]</div>
<ol class="arabic simple" start="5">
<li><p>Prover 和 Verifier 递归地进行 Round 3，直到 <span class="math notranslate nohighlight">\(i=n-1\)</span></p></li>
<li><p>Prover 计算</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\hat{\rho} = \rho^* + \sum_{i=0}^{n-1}\mu^{(i)}\cdot\rho^{(i)}_L + {\mu^{(i)}}^{-1}\cdot\rho^{(i)}_R
\]</div>
</section>
<section id="round-4">
<h4>Round 4.<a class="headerlink" href="#round-4" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Prover 计算并发送 <span class="math notranslate nohighlight">\(R\)</span>，其中 <span class="math notranslate nohighlight">\(r, \rho_r\in\mathbb{F}_p\)</span> 为 Prover 随机抽样的随机数</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
R = r\cdot(G^{(n-1)} + b^{(n-1)}\cdot{U'}) + \rho_r\cdot{}H
\]</div>
</section>
<section id="round-5">
<h4>Round  5.<a class="headerlink" href="#round-5" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Verifier 发送一个随机数 <span class="math notranslate nohighlight">\(\zeta\in\mathbb{F}_p\)</span></p></li>
<li><p>Prover 计算 <span class="math notranslate nohighlight">\(z\)</span> 与 <span class="math notranslate nohighlight">\(z_r\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
z = r + \zeta\cdot b^{(n-1)}
\]</div>
<div class="math notranslate nohighlight">
\[
z_r = \rho_r + \zeta\cdot\hat{\rho}
\]</div>
</section>
<section id="id26">
<h4>Verification<a class="headerlink" href="#id26" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Verifier 计算 <span class="math notranslate nohighlight">\(C^*\)</span> 与 <span class="math notranslate nohighlight">\(P\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
C^* = d_0C_0 + d_1C_1 + ... + d_{h-1}C_{h-1}
\]</div>
<div class="math notranslate nohighlight">
\[
P = C^* + \sum_{i=0}^{n-1}\mu^{(i)}L^{(i)} + {\mu^{(i)}}^{-1}R^{(i)}
\]</div>
<ol class="arabic simple" start="2">
<li><p>Verifier 验证下面的等式是否成立</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
R + \zeta\cdot P \overset{?}{=} z\cdot (G^{(n-1)} + b^{(n-1)}\cdot{U'}) + z_r\cdot{}H
\]</div>
</section>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>[WTSTW16] Riad S. Wahby, Ioanna Tzialla, abhi shelat, Justin Thaler, and Michael Walfish. “Doubly-efficient zkSNARKs without trusted setup.”  In 2018 IEEE Symposium on Security and Privacy (SP), pp. 926-943. IEEE, 2018.  <a class="reference external" href="https://eprint.iacr.org/2016/263">https://eprint.iacr.org/2016/263</a></p></li>
<li><p>[BBB+18] Bünz, Benedikt, Jonathan Bootle, Dan Boneh, Andrew Poelstra, Pieter Wuille, and Greg Maxwell. “Bulletproofs: Short proofs for confidential transactions and more.” In 2018 IEEE symposium on security and privacy (SP), pp. 315-334. IEEE, 2018. <a class="reference external" href="https://eprint.iacr.org/2017/1066">https://eprint.iacr.org/2017/1066</a></p></li>
<li><p>[BCC+16] Jonathan Bootle, Andrea Cerulli, Pyrros Chaidos, Jens Groth, and Christophe Petit. “Efficient Zero-Knowledge Arguments for Arithmetic Circuits in the Discrete Log Setting.”  In Advances in Cryptology–EUROCRYPT 2016: 35th Annual International Conference on the Theory and Applications of Cryptographic Techniques, Vienna, Austria, May 8-12, 2016, Proceedings, Part II 35, pp. 327-357. Springer Berlin Heidelberg, 2016.  <a class="reference external" href="https://eprint.iacr.org/2016/263">https://eprint.iacr.org/2016/263</a></p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./hyrax-pcs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../kzg10/kzg%20notes/kzg-extractability-based-on-rom.zh.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">KZG Extractability based on ROM</p>
      </div>
    </a>
    <a class="right-next"
       href="../zeromorph/zeromorph.zh.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ZeroMorph 笔记</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mle">1. MLE 多项式的求值证明</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#witness">Witness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">内积协议</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-ipa">2. Mini-IPA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">证明目标</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">公开参数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#witnesses">Witnesses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">协议基本思路</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">协议</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-1">Round 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-2">Round 2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">验证</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#square-root-inner-product-argument">3. Square-root inner product argument</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Witness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">承诺</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">Evaluation证明协议</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Round 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Round 2.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-3">Round 3.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#verification">Verification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bulletproofs">4. Bulletproofs 的优化</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">公开参数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">验证</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">5. 完整协议</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">公开参数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">计算承诺</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Evaluation证明协议</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">公共输入</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Witness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">证明协议</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Round 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Round 2.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-3-repeated-i-0-1-n-1">Round 3 (Repeated <span class="math notranslate nohighlight">\(i=0, 1, ..., n-1\)</span>).</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-4">Round 4.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#round-5">Round  5.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Verification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>